<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeriDEM: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="doxy_logo.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">PeriDEM<span id="projectnumber">&#160;0.2.0</span>
   </div>
   <div id="projectbrief">PeriDEM -- Peridynamics-based high-fidelity model for granular media</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__2home_2user_2project_2examples_2README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>PeriDEM</code> folder contains examples for multi-particle simulation and <code>Peridynamics</code> provides examples for single particle deformation.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
PeriDEM: Examples</h1>
<p>We next highlight some key examples. For more details, look at the <code>create_input_file()</code> within <code>problem_setup.py</code> or <code>input_0.yaml</code> in example folders.</p>
<p>To create input files, the python script is included. Python script allows easy parameterization of various modeling and geometrical parameters and creating <code>.geo</code> files for <code>gmsh</code> and particle locations file. Typically, the input files consists of:</p><ul>
<li><code>input.yaml</code> - the main instruction file for <code>PeriDEM</code> with details about material models, particle geometries, time step, etc</li>
<li><code>particle_locations.csv</code> - this file provides location and other details of the individual particles. Each row in the file consists of<ul>
<li><code>i</code> - zone id that particle belongs to</li>
<li><code>x</code> - x-coordinate of the center of the particle. Next two columns are similarly for <code>y</code> and <code>z</code> coordinates</li>
<li><code>r</code> - radius of the particle</li>
<li><code>o</code> - orientation in radians. This is used to give particle (particle mesh) a rotation</li>
</ul>
</li>
<li><code>mesh.msh</code> - mesh file for the reference particle or wall. For example, in <a href="./PeriDEM/compressive_test/compression_small_set
    /inp">compressive test</a> example, running <code>python3 -B problem_setup.py</code> will generate following <code>.msh</code> files: <code>mesh_cir_large_0.msh</code>, <code>mesh_cir_small_0.msh</code>, <code>mesh_drum2d_large_0. msh</code>, <code>mesh_drum2d_small_0.msh</code>, <code>mesh_fixed_container_0.msh</code>, <code>mesh_hex_large_0.msh</code>, <code>mesh_hex_small_0.msh</code>, <code>mesh_moving_container_0. msh</code>, <code>mesh_tri_large_0.msh</code>, <code>mesh_tri_small_0.msh</code>.</li>
</ul>
<h3><a class="anchor" id="autotoc_md16"></a>
Two-particle tests</h3>
<p>The examples below are for demonstration. Similar results can be obtained by modifying and running examples in <code>PeriDEM/examples/PeriDEM/two_particles/</code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/two_particle_circ_no_damp.gif" alt="" width="200" class="inline"/>   </th><th class="markdownTableHeadCenter"><img src="../assets/two_particle_circ_damp.gif" alt="" width="200" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Circular without damping   </td><td class="markdownTableBodyCenter">Circular with damping   </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/two_particle_circ_diff_material.gif" alt="" width="200" class="inline"/>   </th><th class="markdownTableHeadCenter"><img src="../assets/two_particle_circ_damp_diff_radius.gif" alt="" width="200" class="inline"/>   </th><th class="markdownTableHeadCenter"><img src="../assets/two_particle_circ_diff_radius_diff_material.gif" alt="" width="200" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Different materials   </td><td class="markdownTableBodyCenter">Different radius   </td><td class="markdownTableBodyCenter">Different radius different material   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md17"></a>
Two-particle with wall test</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/two_particle_wall_concave_diff_material_diff_size.gif" alt="" width="400" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Concave particles   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md18"></a>
Compressive tests</h3>
<p>Setup for this test consists of 502 circular and hexagonal-shaped particles of varying radius and orientation inside a rectangle container. The container's top wall is moving downward at a prescribed speed, resulting in the compression of the particle system. The quantity of interest is the compressive strength of the media. The reaction force (downward) on the moving wall should increase with the increasing penetration of this wall; however, after a certain amount of compression of the media, the damage will initiate in individual particles, especially those connected by force chains, resulting in the yielding of the system. For more details, we refer to <a href="https://prashjha.github.io/publication/jha-2020-peridem/">Jha et al. 2021</a></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/compressive_test_cir_hex_n500.jpg" alt="" width="600" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Compressive test setup   </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/compressive_test_reaction_force_n500.jpg" alt="" width="600" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><b>Top</b>: Plot of reaction force per unit area on the top wall. <b>Bottom</b>: Particle state at four times. Color shows the damage at nodes. Damage 1 or above indicates the presence of broken bonds in the neighborhood of a node.   </td></tr>
</table>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/compressive_test.gif" alt="" width="600" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Compressive test simulation   </td></tr>
</table>
<p>Examples similar to above can be found in <code>PeriDEM/examples/PeriDEM/compressive_test/</code>.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
Attrition tests - Particles in a rotating container</h3>
<p>We consider mix of different particles in a rotating container. Particles considered include circular, triangular, hexagonal, and drum shaped. Particles come in large and small shapes (their sizes are purturbed randomly). In order to to introduce diversity of material properties, we considered large particles to be tougher compared to the smaller ones. Setup files are in <a href="./PeriDEM/attrition_tests">PeriDEM/attrition_tests</a></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="../assets/attrition_test_sim1.gif" alt="" width="250" class="inline"/>   </th><th class="markdownTableHeadCenter"><img src="../assets/attrition_test_sim2.gif" alt="" width="250" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Rotating cylinder (<a href="./PeriDEM/attrition_tests/sim1_multi_particle_circ_tri_drum_with_rotating_cylinder_with_protrusion">setup</a>)   </td><td class="markdownTableBodyCenter">Rotating cylinder with center of rotation offset (<a href="./PeriDEM/attrition_tests/sim2_multi_particle_circ_tri_drum_hex_with_rotating_cylinder_with_protrusion_thin_container_and_change_rotation_rate">setup</a>)   </td></tr>
</table>
<p>Complex container geometries can be considered as well. For example, the image below is from <a href="./PeriDEM/attrition_tests/sim4_multi_particle_circ_tri_drum_hex_with_rotating_rectangle_container_with_protrusion_and_opening_within_bigger_rectangle_container">attrition_tests</a> and includes rotating rectangle with opening and internal groves of different shapes. The rotating container with particles inside is contained within another rectangle which is fixed in its place.</p>
<p><img src="./PeriDEM/attrition_tests/sim4_multi_particle_circ_tri_drum_hex_with_rotating_rectangle_container_with_protrusion_and_opening_within_bigger_rectangle_container/init_view.png" alt="" width="600" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md20"></a>
Running simulations</h2>
<p>Assuming that the input file is <code>input.yaml</code> and all other files such as <code>.msh</code> file for particle/wall and particle locations file are created and their filenames with paths are correctly provided in <code>input.yaml</code>, we will run the problem (using 4 threads) </p><div class="fragment"><div class="line">&lt;path of PeriDEM&gt;/bin/PeriDEM -i input.yaml -nThreads 4</div>
</div><!-- fragment --><p>Some examples are listed below.</p>
<h3><a class="anchor" id="autotoc_md21"></a>
Two-particle with wall</h3>
<p>Navigate to the example directory <a href="./PeriDEM/two_particles/twop_wall_concave_diff_material_diff_size/inp">PeriDEM/two_particles/twop_wall_concave_diff_material_diff_size/inp</a> and run the example as follows </p><div class="fragment"><div class="line"># manually</div>
<div class="line">cd PeriDEM/two_particles/twop_wall_concave_diff_material_diff_size/inp</div>
<div class="line">mkdir ../out # &lt;-- make directory for simulation output. In .yaml, we specify output path as &#39;./out&#39;</div>
<div class="line">&lt;peridem build path&gt;bin/PeriDEM -i input_0.yaml -nThreads 2</div>
<div class="line"> </div>
<div class="line"># or call run.sh script</div>
<div class="line">cd PeriDEM/two_particles/twop_wall_concave_diff_material_diff_size</div>
<div class="line">./run.sh 4 # with 4 threads</div>
</div><!-- fragment --><p>You may also use the included <a href="./PeriDEM/two_particles/twop_wall_concave_diff_material_diff_size/inp/problem_setup.py">problem_setup.py</a> to modify simulation parameters and run the simulation using <a href="./PeriDEM/two_particles/twop_wall_concave_diff_material_diff_size/run.sh">run.sh</a>.</p>
<blockquote class="doxtable">
<p>&zwj;:exclamation: You may need to modify the path of <code>PeriDEM</code> executable in <code>run.sh</code> file. </p>
</blockquote>
<blockquote class="doxtable">
<p>&zwj;In all <code>problem_setup.py</code> files in the example and test directory, the main function is <code>create_input_file()</code>. Here we set all model parameters, create <code>.yaml</code> input file, and <code>.geo</code> files for meshing. </p>
</blockquote>
<h4><a class="anchor" id="autotoc_md22"></a>
Important remark on modifying input.yaml file</h4>
<p>To test the examples quickly, you can directly modify the <code>input.yaml</code> and re-run the simulation as shown above. For example, you can alter <code>Final_Time</code>, <code>Time_Steps</code>, <code>Contact_Radius_Factor</code>, <code>Kn</code>, and other fields in the yaml file.</p>
<p>However, some care is required when changing the geometrical details of particles and walls in the <code>input.yaml</code> file. If you change these details in the <code>.yaml</code> file, you will have to ensure that the <code>.msh</code> file correspond to the new geometry.</p>
<p>Except geometrical parameters of walls and particles, rest of the parameters in <code>input.yaml</code> can be modified.</p>
<blockquote class="doxtable">
<p>&zwj;In due time, we will provide more information on setting up input files and covering all aspects of the simulation. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md23"></a>
Compressive test</h3>
<p>Navigate to the example directory <a href="./PeriDEM/compressive_test/compression_large_set/inp">PeriDEM/compressive_test/compression_large_set/inp</a> and run the example as follows (note that this is a computationally expensive example) </p><div class="fragment"><div class="line">cd PeriDEM/compressive_test/compression_large_set/inp</div>
<div class="line">mkdir ../out </div>
<div class="line">&lt;peridem build path&gt;bin/PeriDEM -i input_0.yaml -nThreads 12</div>
<div class="line"> </div>
<div class="line"># or you can use the run.sh script in the path PeriDEM/compressive_test/compression_large_set/</div>
</div><!-- fragment --><p>As before:</p><ul>
<li>you can modify <a href="./PeriDEM/compressive_test/compression_large_set/inp/problem_setup.py">problem_setup.py</a>, see <code>create_input_file()</code> method, to change the simulation settings</li>
<li>run the simulation using <a href="./PeriDEM/compressive_test/compression_large_set//run.sh">run.sh</a>.</li>
</ul>
<h3><a class="anchor" id="autotoc_md24"></a>
Compute times for various examples (From old version of the code!)</h3>
<p>For reference, we list the compute times for various examples.</p><ul>
<li><code>T</code> is the total compute time in units of <code>second</code></li>
<li><code>T(n)</code> means compute time when running the example with <code>n</code> threads.</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Test   </th><th class="markdownTableHeadCenter">T(1)   </th><th class="markdownTableHeadCenter">T(2)   </th><th class="markdownTableHeadCenter">T(4)   </th><th class="markdownTableHeadCenter">T(8)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">two_particles/circ_damp   </td><td class="markdownTableBodyCenter">143.7   </td><td class="markdownTableBodyCenter">95.1   </td><td class="markdownTableBodyCenter">76.4   </td><td class="markdownTableBodyCenter">78.6    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">two_particles/circ_damp_diff_radius   </td><td class="markdownTableBodyCenter">164   </td><td class="markdownTableBodyCenter">114.6   </td><td class="markdownTableBodyCenter">96.7   </td><td class="markdownTableBodyCenter">99.4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">two_particles/circ_diff_material   </td><td class="markdownTableBodyCenter">287.7   </td><td class="markdownTableBodyCenter">190.1   </td><td class="markdownTableBodyCenter">152.7   </td><td class="markdownTableBodyCenter">160    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">two_particles/circ_diff_radius_diff_material   </td><td class="markdownTableBodyCenter">329.1   </td><td class="markdownTableBodyCenter">229.4   </td><td class="markdownTableBodyCenter">195.3   </td><td class="markdownTableBodyCenter">200    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">two_particles/circ_no_damp   </td><td class="markdownTableBodyCenter">143.8   </td><td class="markdownTableBodyCenter">94.5   </td><td class="markdownTableBodyCenter">76.7   </td><td class="markdownTableBodyCenter">78.5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">two_particles_wall/concave_diff_material_diff_size   </td><td class="markdownTableBodyCenter">2749.9   </td><td class="markdownTableBodyCenter">1534.6   </td><td class="markdownTableBodyCenter">980.8   </td><td class="markdownTableBodyCenter">691.1   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md25"></a>
Visualizing results</h2>
<p>Simulation files <code>output_*.vtu</code> can be loaded in either <a href="https://www.paraview.org/">ParaView</a> or <a href="https://wci.llnl.gov/simulation/computer-codes/visit">VisIt</a>.</p>
<p>By default, in all tests and examples, we only output the particle mesh, i.e., pair of nodal coordinate and nodal volume, and not the finite element mesh (it can be enabled by setting <code>Perform_FE_Out: true</code> within <code>Output</code> block in the input <code>yaml</code> file). After loading the file in ParaView, the first thing to do is to change the plot type from **<code>Surface</code>** to **<code>Point Gaussian</code>**. Next, a couple of things to do are:</p><ul>
<li>Adjust the radius of circle/sphere at the nodes by going to the <code>Properties</code> tab on the left side and change the value of **<code>Gaussian Radius</code>**</li>
<li>You may also want to choose the field to display. For starter, you could select the <code>Damage_Z</code> variable, a ratio of <b>maximum bond strain in the neighborhood of a node and critical bond strain</b>. When the <code>Damage_Z</code> value is below one at a given node, the deformation in the vicinity of that node is elastic, whereas when the value is above 1, it indicates there is at least one node in the neighborhood which has bond strain above critical strain (meaning the bond between these two nodes is broken)</li>
<li>You may also need to rescale the plot by clicking on the **<code>Zoom to Data</code>** button in ParaView</li>
<li>Lastly, when the <code>Damage_Z</code> is very high at few nodes, you may want to rescale the data to the range, say <code>[0,2]</code> or <code>[0,10]</code>, so that it is easier to identify regions with elastic deformation and region with fracture.</li>
</ul>
<h1><a class="anchor" id="autotoc_md26"></a>
Single particle deformation</h1>
<p>In <a href="./Peridynamics/circle/">Peridynamics/circle</a>, circular-shaped particle is deformed by clamping one part of the circle and specifying displacement in the other part. To run the example, you can either run using <code>PeriDEM</code> executible or the <code>Peridynamics</code> app which only handle single particle deformation: </p><div class="fragment"><div class="line"># assuming you are in Peridynamics/circle directory</div>
<div class="line">mkdir -p out</div>
<div class="line"># use PeriDEM</div>
<div class="line">&lt;path to PeriDEM&gt;/PeriDEM -i input_0.yaml -nThreads 4</div>
<div class="line"># or use Peridynamics in apps</div>
<div class="line">&lt;path to Peridynamics app&gt;/Peridynamics -i input_0.yaml -nThreads 4</div>
</div><!-- fragment --><p>The example in <a href="./Peridynamics/rectangle/">Peridynamics/rectangle</a> is similar to the above example. It uses the in-built mesh for rectangle.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"><img src="./Peridynamics/circle/out/view.png" alt="" width="200" class="inline"/>   </th><th class="markdownTableHeadCenter"><img src="./Peridynamics/rectangle/out/view.png" alt="" width="200" class="inline"/>    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><a href="./Peridynamics/circle/">Circle deformation</a>   </td><td class="markdownTableBodyCenter"><a href="./Peridynamics/rectangle/">Rectangle deformation</a>   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

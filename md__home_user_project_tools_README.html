<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeriDEM: PeriDEM: Installation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="doxy_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PeriDEM
   &#160;<span id="projectnumber">0.2.0</span>
   </div>
   <div id="projectbrief">PeriDEM--PeridynamicallyenhancedDEMmodelforgranularmedia</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__home_user_project_tools_README.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">PeriDEM: Installation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md18"></a>
Dependencies</h1>
<p>Core dependencies are:</p><ul>
<li><a href="https://cmake.org/">cmake</a> (&gt;= 3.10.2)<ul>
<li>recommend to install using <code>apt-get</code> or <code>brew</code></li>
</ul>
</li>
<li><a href="https://vtk.org/">vtk</a> (&gt;= 7.1.1)<ul>
<li>recommend to build using script <a href="./compile_scripts/ubuntu/install_vtk_alone.sh">install_vtk_alone.sh</a> or <a href="./compile_scripts/ubuntu/install_cmake_and_vtk.sh">install_cmake_and_vtk.sh</a></li>
<li>required to output simulation results in <code>.vtu</code> format</li>
</ul>
</li>
<li><a href="https://github.com/jbeder/yaml-cpp">yaml-cpp</a> (&gt;= 0.5.2)<ul>
<li>recommend to install using <code>apt-get</code> or <code>brew</code></li>
<li>required to parse input file</li>
</ul>
</li>
<li><a href="https://github.com/KarypisLab/METIS">metis</a> (&gt;= 5.1.0)<ul>
<li>recommend to install using <code>apt-get</code> or <code>brew</code>. If using <code>apt-get</code>, recommend to create symlink to <code>libmetis.so</code> file in <code>/usr/lib/</code> directory; see towards end in script <a href="./compile_scripts/ubuntu/install_apt-get_libs.sh">install_apt-get_libs.sh</a>. This helps <code>cmake</code> locate metis library.</li>
<li>required to partition the mesh</li>
</ul>
</li>
<li>MPI<ul>
<li>for parallel simulations</li>
</ul>
</li>
<li><a href="https://www.cs.ubc.ca/research/flann/">libflann-dev</a> (1.9)<ul>
<li>recommend to install using <code>apt-get</code> or <code>brew</code></li>
<li>needed by <code>nanoflann</code> library</li>
</ul>
</li>
</ul>
<p>Following dependencies are included in the <code>PeriDEM</code> library in <code>external</code> folder (see ../external/README.md "PeriDEM/external/README.md" for more details):</p><ul>
<li><a href="https://github.com/ben-strasser/fast-cpp-csv-parser/tree/master">fast-cpp-csv-parser</a> (version included - master)<ul>
<li>required to read <code>.csv</code> files</li>
</ul>
</li>
<li><a href="https://github.com/fmtlib/fmt">fmt</a> (&gt;= 7.1.3, version included - 10.2.1)<ul>
<li>included as external library in the code</li>
<li>required to output formatted strings</li>
</ul>
</li>
<li><a href="https://github.com/jlblancoc/nanoflann">nanoflann</a> (&gt;= 1.3.2, version included - v1.5.5)<ul>
<li>included as external library in the code</li>
<li>required for neighbor search</li>
</ul>
</li>
<li><a href="https://github.com/taskflow/taskflow">taskflow</a> (&gt;= 3.7.0)<ul>
<li>included as external library in the code</li>
<li>required for asynchronous/parallel for loop</li>
</ul>
</li>
<li><a href="https://github.com/jothepro/doxygen-awesome-css">doxygen-awesome-css</a> (&gt;= v2.3.3)<ul>
<li>included as external library in the code</li>
<li>useful in building better doxygen documentation (see <a href="./docs/input-conf.doxy.in">docs/input-conf.doxy.in</a> file)</li>
</ul>
</li>
</ul>
<p>Additional dependencies for running the examples:</p><ul>
<li><a href="https://gmsh.info/">gmsh</a> (&gt;= 3.0.6)<ul>
<li>recommend to install using <code>apt-get</code> or <code>brew</code></li>
<li>required to build the mesh of various objects in the test</li>
</ul>
</li>
<li><a href="https://www.python.org/">python3</a><ul>
<li>required to run the test python scripts</li>
</ul>
</li>
<li><a href="https://numpy.org/">numpy</a><ul>
<li>required to run the test python scripts</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Building the code</h2>
<p>If all the dependencies are installed on the global path (e.g., <code>/usr/local/</code>), commands for building the PeriDEM code is as simple as </p><div class="fragment"><div class="line">cmake   -DEnable_Documentation=OFF # or ON \</div>
<div class="line">        -DEnable_Tests=ON \</div>
<div class="line">        -DEnable_High_Load_Tests=OFF # ON if you want ctest to include high-load tests \</div>
<div class="line">        -DDisable_Docker_MPI_Tests=ON # only for docker; OFF if you can run MPI in docker\</div>
<div class="line">        -DVTK_DIR=&quot;${VTK_DIR}&quot; # e.g., /usr/local/lib/cmake/vtk-9.3 \</div>
<div class="line">        -DMETIS_DIR=&quot;${METIS_DIR}&quot; # e.g., /usr/lib \</div>
<div class="line">        -DCMAKE_BUILD_TYPE=Release \</div>
<div class="line">        &lt;PeriDEM source directory&gt;</div>
<div class="line">        </div>
<div class="line">make -j 4</div>
<div class="line"> </div>
<div class="line">ctest --verbose</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20"></a>
Installing dependencies</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
Mac</h2>
<p>Brew can be used to install all dependencies in mac as follows </p><div class="fragment"><div class="line">brew install cmake libomp open-mpi tbb \</div>
<div class="line">  yaml-cpp flann gmsh metis vtk </div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md22"></a>
Ubuntu</h2>
<ol type="1">
<li>Essential libraries can be installed using <code>apt-get</code> as follows ```shell sudo apt-get update sudo apt-get install -y \ libopenmpi-dev openmpi-bin \ libblas-dev liblapack-dev libmpfr-dev libgmp-dev \ libtbb-dev libasio-dev libglvnd-dev \ libgmsh-dev gmsh \ libflann-dev \ libmetis-dev \ libyaml-cpp-dev \ python3-pip</li>
</ol>
<h1><a class="anchor" id="autotoc_md23"></a>
for metis, create symlink</h1>
<p>sudo ln -sf /usr/lib/x86_64-linux-gnu/libmetis.so /usr/lib/libmetis.so</p>
<h1><a class="anchor" id="autotoc_md24"></a>
python libs</h1>
<h1><a class="anchor" id="autotoc_md25"></a>
NOTE: add 'â€“break-system-packages' at the end if installing in Ubuntu 24.04 (noble)</h1>
<p>pip3 install numpy pyvista pandas ``<code></p><ol type="1">
<li>Forcmake<code>, if you are in ubuntu &gt;= 20.04, install using</code>apt-get<code> </code>``shell sudo apt-get update \ sudo apt-get install -y cmake ``` If you are in ubuntu &lt; 20.04 (e.g., 18.04 bionic), install by adding new ppa to apt-get as follows ```shell </li>
</ol>
<p></code></p>
<h1><a class="anchor" id="autotoc_md26"></a>
get codename of ubuntu</h1>
<p><code> UBUNTU_CODENAME="$(cat /etc/os-release | grep UBUNTU_CODENAME | cut -d = -f 2)" </code></p>
<h1><a class="anchor" id="autotoc_md27"></a>
add repo</h1>
<p><code> wget -O - <a href="https://apt.kitware.com/keys/kitware-archive-latest.asc">https://apt.kitware.com/keys/kitware-archive-latest.asc</a> 2&gt;/dev/null | gpg &ndash;dearmor - | tee /etc/apt/trusted.gpg.d/kitware.gpg &gt;/dev/null sudo apt-add-repository "deb https://apt.kitware.com/ubuntu/ ${UBUNTU_CODENAME} main" echo "fixing public key issue with kitware repo" if [ "${UBUNTU_CODENAME}" = "bionic" ]; then gpg &ndash;keyserver keyserver.ubuntu.com &ndash;recv-keys 6AF7F09730B3F0A4 gpg &ndash;export &ndash;armor 6AF7F09730B3F0A4 | sudo apt-key add - elif [ "${UBUNTU_CODENAME}" = "focal" ]; then gpg &ndash;keyserver keyserver.ubuntu.com &ndash;recv-keys 1A127079A92F09ED gpg &ndash;export &ndash;armor 1A127079A92F09ED | sudo apt-key add - else echo "no fix for UBUNTU_CODENAME = ${UBUNTU_CODENAME} if there is a key error. try building cmake from repository" fi</code></p>
<p><code></code></p>
<h1><a class="anchor" id="autotoc_md28"></a>
now you can install recent cmake from apt-get</h1>
<p><code> sudo apt-get update sudo apt-get install -y cmake ``<code></p><ol type="1">
<li>For vtk, if you are in ubuntu &gt;= 22.04, install usingapt-get<code>as follows: </code>``shell sudo apt-get install -y libvtk9-dev ``` If you are in ubuntu &lt; 22.04 (e.g., 18.04 bionic, 20.04 focal), build vtk and install as follows <div class="fragment"><div class="line"># get codename of ubuntu</div>
<div class="line">UBUNTU_CODENAME=&quot;$(cat /etc/os-release | grep UBUNTU_CODENAME | cut -d = -f 2)&quot;</div>
<div class="line"> </div>
<div class="line"># instal dependency first</div>
<div class="line">if [ &quot;${UBUNTU_CODENAME}&quot; = &quot;focal&quot; ] || [ &quot;${UBUNTU_CODENAME}&quot; = &quot;bionic&quot; ]; then</div>
<div class="line">  sudo apt-get install -y libgl1-mesa-dev</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line"># set some paths where we will download vtk and build</div>
<div class="line">SCRIPTPATH=$( cd $(dirname $0) ; pwd -P )</div>
<div class="line">BUILDTHREADS=&quot;$(cat /proc/cpuinfo | grep processor | wc -l)&quot; # or 12</div>
<div class="line"> </div>
<div class="line">install_at_global=&quot;0&quot; # 0 - install in script path, 1 in /usr/local</div>
<div class="line">VTK_INSTALL_PATH=&quot;/usr/local&quot;</div>
<div class="line">if [ $install_at_global = &quot;0&quot; ]; then</div>
<div class="line">    VTK_INSTALL_PATH=$SCRIPTPATH/install/vtk/$VTK_VERSION/Release</div>
<div class="line">fi</div>
<div class="line">echo &quot;VTK_INSTALL_PATH = ${VTK_INSTALL_PATH}&quot;</div>
<div class="line"> </div>
<div class="line"># clone vtk</div>
<div class="line">VTK_MAJOR_VERSION=9</div>
<div class="line">VTK_MINOR_VERSION=3</div>
<div class="line">VTK_PATCH_VERSION=0</div>
<div class="line">VTK_VERSION=$VTK_MAJOR_VERSION.$VTK_MINOR_VERSION.$VTK_PATCH_VERSION</div>
<div class="line">echo &quot;VTK_VERSION = ${VTK_VERSION}&quot;</div>
<div class="line"> </div>
<div class="line">git clone --recursive https://gitlab.kitware.com/vtk/vtk.git vtk-source-${VTK_VERSION}</div>
<div class="line">cd vtk-${VTK_VERSION}</div>
<div class="line">git checkout v${VTK_VERSION}</div>
<div class="line"> </div>
<div class="line">cd .. &amp;&amp; mkdir -p vtk-build-${VTK_VERSION} &amp;&amp; cd vtk-build-${VTK_VERSION}</div>
<div class="line">cmake -D CMAKE_BUILD_TYPE:STRING=Release \</div>
<div class="line">  -D CMAKE_INSTALL_PREFIX:STRING=${VTK_INSTALL_PATH} \</div>
<div class="line">  -D BUILD_SHARED_LIBS=ON \</div>
<div class="line">  -D BUILD_TESTING=OFF \</div>
<div class="line">  -D VTK_REQUIRED_OBJCXX_FLAGS=&#39;&#39; \</div>
<div class="line">  -D HDF5_BUILD_FRAMEWORKS=OFF \</div>
<div class="line">  -D VTK_BUILD_DOCUMENTATION=OFF \</div>
<div class="line">  -D VTK_BUILD_EXAMPLES=OFF \</div>
<div class="line">  -D VTK_BUILD_SCALED_SOA_ARRAYS=OFF \</div>
<div class="line">  -D VTK_BUILD_SPHINX_DOCUMENTATION=OFF \</div>
<div class="line">  -D VTK_GROUP_ENABLE_MPI=NO \</div>
<div class="line">  -D VTK_GROUP_ENABLE_Qt=DONT_WANT \</div>
<div class="line">  -D VTK_GROUP_ENABLE_Rendering=NO \</div>
<div class="line">  -D VTK_GROUP_ENABLE_Views=NO \</div>
<div class="line">  -D VTK_GROUP_ENABLE_Web=NO \</div>
<div class="line">  -D VTK_Group_MPI=ON \</div>
<div class="line">  -D VTK_USE_MPI=OFF \</div>
<div class="line">  -D VTK_WRAP_PYTHON=OFF \</div>
<div class="line">  ../vtk-source-${VTK_VERSION}</div>
<div class="line">make -j -l$BUILDTHREADS</div>
<div class="line"># installation</div>
<div class="line">if [[ &quot;$install_at_global&quot; = &quot;1&quot; ]]; then</div>
<div class="line">  sudo make install</div>
<div class="line">else </div>
<div class="line">  make install</div>
<div class="line">fi</div>
<div class="line">echo VTK_LIB_CMAKE_DIR=&quot;${VTK_INSTALL_PATH}/lib/cmake/vtk-${VTK_MAJOR_VERSION}.${VTK_MINOR_VERSION}&quot;</div>
<div class="line">echo VTK_LIB_DIR=&quot;${VTK_INSTALL_PATH}/lib&quot;</div>
<div class="line">echo VTK_INCLUDE_DIR=&quot;${VTK_INSTALL_PATH}/include/vtk-${VTK_MAJOR_VERSION}.${VTK_MINOR_VERSION}&quot;</div>
</div><!-- fragment --></li>
</ol>
<p></code></code></p>
<p><code><code></code></code></p>
<h3><a class="anchor" id="autotoc_md29"></a>
Compile scripts</h3>
<p><code><code>In directory <a href="./compile_scripts">PeriDEM/tools/compile_scripts</a> various scripts are included to help install dependencies and compile PeriDEM code. If you follow this documentation, you probably would not need to look at those scripts as the dependencies in this library is kept quite small and can be easily installed using either <code>apt-get</code> or <code>brew</code>.</code></code></p>
<p><code><code></code></code></p>
<h3><a class="anchor" id="autotoc_md30"></a>
Docker</h3>
<p><code><code>For <code>circle-ci</code> testing, we use docker images <code>prashjha/peridem-base-jammy:latest</code> (<code>ubuntu 22.04</code>) and <code>prashjha/peridem-base-noble:latest</code> (<code>ubuntu 24.04</code>). The associated dockerfiles and scripts to use pre-built docker images in compiling code and using for clion remote development can be found in <a class="el" href="tools_2docker_2README_8md.html">PeriDEM/tools/docker/README.md</a>. </code></code></p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>

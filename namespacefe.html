<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeriDEM: fe Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="doxy_logo.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">PeriDEM<span id="projectnumber">&#160;0.2.0</span>
   </div>
   <div id="projectbrief">PeriDEM -- Peridynamics-based high-fidelity model for granular media</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacefe.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">fe Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Collection of methods and data related to finite element and mesh.  
<a href="namespacefe.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfe_1_1BaseElem.html">BaseElem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A base class which provides methods to map points to/from reference element and to compute quadrature data.  <a href="classfe_1_1BaseElem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfe_1_1LineElem.html">LineElem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for mapping and quadrature related operations for linear 2-node line element.  <a href="classfe_1_1LineElem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfe_1_1Mesh.html">Mesh</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for mesh data.  <a href="classfe_1_1Mesh.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfe_1_1QuadData.html">QuadData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A struct to store the quadrature data. List of data are.  <a href="structfe_1_1QuadData.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfe_1_1QuadElem.html">QuadElem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for mapping and quadrature related operations for bi-linear quadrangle element.  <a href="classfe_1_1QuadElem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfe_1_1TetElem.html">TetElem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for mapping and quadrature related operations for linear tetrahedron element.  <a href="classfe_1_1TetElem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfe_1_1TriElem.html">TriElem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for mapping and quadrature related operations for linear triangle element.  <a href="classfe_1_1TriElem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abf9d43e85d09aafbc240f14cd9508ab4" id="r_abf9d43e85d09aafbc240f14cd9508ab4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">metisGraphPartition</a> (std::string partitionMethod, const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;nodeNeighs, std::vector&lt; size_t &gt; &amp;nodePartition, size_t nPartitions)</td></tr>
<tr class="memdesc:abf9d43e85d09aafbc240f14cd9508ab4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes as vertices and edges given by node neighbors. Then the metis function is called to partition the graph into specified number of parts.  <br /></td></tr>
<tr class="separator:abf9d43e85d09aafbc240f14cd9508ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5abc576787f51dd3d0322b4d435ccac9" id="r_a5abc576787f51dd3d0322b4d435ccac9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefe.html#a5abc576787f51dd3d0322b4d435ccac9">metisGraphPartition</a> (std::string partitionMethod, <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *mesh_p, const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;nodeNeighs, size_t nPartitions)</td></tr>
<tr class="memdesc:a5abc576787f51dd3d0322b4d435ccac9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes as vertices and edges given by node neighbors. Then the metis function is called to partition the graph into specified number of parts.  <br /></td></tr>
<tr class="separator:a5abc576787f51dd3d0322b4d435ccac9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe6bbc09314c74619abaa8c13f489335" id="r_abe6bbc09314c74619abaa8c13f489335"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefe.html#abe6bbc09314c74619abaa8c13f489335">createUniformMesh</a> (<a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *mesh_p, size_t dim, std::pair&lt; std::vector&lt; double &gt;, std::vector&lt; double &gt; &gt; box, std::vector&lt; size_t &gt; nGrid)</td></tr>
<tr class="memdesc:abe6bbc09314c74619abaa8c13f489335"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates uniform mesh for rectangle/cuboid domain.  <br /></td></tr>
<tr class="separator:abe6bbc09314c74619abaa8c13f489335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeecd141ec0e6723bdddd740903cb95f8" id="r_aeecd141ec0e6723bdddd740903cb95f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefe.html#aeecd141ec0e6723bdddd740903cb95f8">getCurrentQuadPoints</a> (const <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *mesh_p, const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;xRef, const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;u, std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;xQuadCur, size_t iNodeStart=0, size_t iQuadStart=0, size_t quadOrder=1)</td></tr>
<tr class="memdesc:aeecd141ec0e6723bdddd740903cb95f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current location of quadrature points of elements in the mesh. This function expects mesh has element-node connectivity data.  <br /></td></tr>
<tr class="separator:aeecd141ec0e6723bdddd740903cb95f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7beb694686b61d7cda5b67aa4bc01104" id="r_a7beb694686b61d7cda5b67aa4bc01104"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefe.html#a7beb694686b61d7cda5b67aa4bc01104">getStrainStress</a> (const <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *mesh_p, const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;xRef, const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;u, bool isPlaneStrain, std::vector&lt; <a class="el" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a> &gt; &amp;strain, std::vector&lt; <a class="el" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a> &gt; &amp;stress, size_t iNodeStart=0, size_t iStrainStart=0, double nu=0., double lambda=0., double mu=0., bool computeStress=false, size_t quadOrder=1)</td></tr>
<tr class="memdesc:a7beb694686b61d7cda5b67aa4bc01104"><td class="mdescLeft">&#160;</td><td class="mdescRight">Strain and stress at quadrature points in the mesh.  <br /></td></tr>
<tr class="separator:a7beb694686b61d7cda5b67aa4bc01104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09527ce4f52ec0da5f9cf970ac08f542" id="r_a09527ce4f52ec0da5f9cf970ac08f542"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacefe.html#a09527ce4f52ec0da5f9cf970ac08f542">getMaxShearStressAndLoc</a> (const <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *mesh_p, const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;xRef, const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;u, const std::vector&lt; <a class="el" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a> &gt; &amp;stress, double &amp;maxShearStress, <a class="el" href="structutil_1_1Point.html">util::Point</a> &amp;maxShearStressLocRef, <a class="el" href="structutil_1_1Point.html">util::Point</a> &amp;maxShearStressLocCur, size_t iNodeStart=0, size_t iStrainStart=0, size_t quadOrder=1)</td></tr>
<tr class="memdesc:a09527ce4f52ec0da5f9cf970ac08f542"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get location where maximum of specified component of stress occurs in this particle.  <br /></td></tr>
<tr class="separator:a09527ce4f52ec0da5f9cf970ac08f542"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Collection of methods and data related to finite element and mesh. </p>
<p>This namespace groups the data and methods related to finite element methods such as quadrature points, finite elements, and also data and methods related to mesh such as nodal coordinates, element-node connectivity, etc. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abe6bbc09314c74619abaa8c13f489335" name="abe6bbc09314c74619abaa8c13f489335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe6bbc09314c74619abaa8c13f489335">&#9670;&#160;</a></span>createUniformMesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fe::createUniformMesh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::pair&lt; std::vector&lt; double &gt;, std::vector&lt; double &gt; &gt;&#160;</td>
          <td class="paramname"><em>box</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt;&#160;</td>
          <td class="paramname"><em>nGrid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates uniform mesh for rectangle/cuboid domain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh_p</td><td>Pointer to already created possibly empty mesh object </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension of the domain </td></tr>
    <tr><td class="paramname">box</td><td>Specifies domain (e.g., rectangle/cuboid) </td></tr>
    <tr><td class="paramname">nGrid</td><td>Grid sizes in dim directions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="meshUtil_8cpp_source.html#l00023">23</a> of file <a class="el" href="meshUtil_8cpp_source.html">meshUtil.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                                                                                                                                 {</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a34ffe327272d99ace79c46cb97f11cae">d_dim</a> = dim;</div>
<div class="line"><span class="lineno">   26</span>  <span class="keywordflow">if</span> (nGrid.size() &lt; dim or box.first.size() &lt; dim or box.second.size() &lt; dim) {</div>
<div class="line"><span class="lineno">   27</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;createUniformMesh(): check nGrid or box arguments.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   28</span>    exit(1);</div>
<div class="line"><span class="lineno">   29</span>  }</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>  <span class="keywordflow">if</span> (dim == 1) {</div>
<div class="line"><span class="lineno">   32</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">d_bbox</a>.first = std::vector&lt;double&gt;{box.first[0], 0., 0.};</div>
<div class="line"><span class="lineno">   33</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">d_bbox</a>.second = std::vector&lt;double&gt;{box.second[0], 0., 0.};</div>
<div class="line"><span class="lineno">   34</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">d_numNodes</a> = (nGrid[0] + 1);</div>
<div class="line"><span class="lineno">   35</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a4ea35d9a5be30637c26117d6c2c80a26">d_numElems</a> = nGrid[0];</div>
<div class="line"><span class="lineno">   36</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a6a077b5520d8a1b356b96437e67ec0fe">d_eType</a> = <a class="code hl_variable" href="group__GlobalVars.html#gaae6892e182cba70ae7985d94f12bd3d9">util::vtk_type_line</a>;</div>
<div class="line"><span class="lineno">   37</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) {</div>
<div class="line"><span class="lineno">   38</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">d_bbox</a>.first = std::vector&lt;double&gt;{box.first[0], box.first[1], 0.};</div>
<div class="line"><span class="lineno">   39</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">d_bbox</a>.second = std::vector&lt;double&gt;{box.second[0], box.second[1], 0.};</div>
<div class="line"><span class="lineno">   40</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">d_numNodes</a> = (nGrid[0] + 1) * (nGrid[1] + 1);</div>
<div class="line"><span class="lineno">   41</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a4ea35d9a5be30637c26117d6c2c80a26">d_numElems</a> = nGrid[0] * nGrid[1];</div>
<div class="line"><span class="lineno">   42</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a6a077b5520d8a1b356b96437e67ec0fe">d_eType</a> = <a class="code hl_variable" href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a>;</div>
<div class="line"><span class="lineno">   43</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3) {</div>
<div class="line"><span class="lineno">   44</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">d_bbox</a>.first = std::vector&lt;double&gt;{box.first[0], box.first[1], box.first[2]};</div>
<div class="line"><span class="lineno">   45</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">d_bbox</a>.second = std::vector&lt;double&gt;{box.second[0], box.second[1], box.second[2]};</div>
<div class="line"><span class="lineno">   46</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">d_numNodes</a> = (nGrid[0] + 1) * (nGrid[1] + 1) * (nGrid[2] + 1);</div>
<div class="line"><span class="lineno">   47</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a4ea35d9a5be30637c26117d6c2c80a26">d_numElems</a> = nGrid[0] * nGrid[1] * nGrid[2];</div>
<div class="line"><span class="lineno">   48</span>    mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a6a077b5520d8a1b356b96437e67ec0fe">d_eType</a> = <a class="code hl_variable" href="group__GlobalVars.html#ga6df6bf3a8e7eb725b9619dcf39fc21a1">util::vtk_type_hexahedron</a>;</div>
<div class="line"><span class="lineno">   49</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   50</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;createUniformMesh(): invalid dim = &quot;</span> &lt;&lt; dim &lt;&lt; <span class="stringliteral">&quot; argument.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   51</span>    exit(1);</div>
<div class="line"><span class="lineno">   52</span>  }</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a> = <a class="code hl_variable" href="group__GlobalVars.html#ga128305c3997f5bf379c9a7550ef0b80a">util::vtk_map_element_to_num_nodes</a>[mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a6a077b5520d8a1b356b96437e67ec0fe">d_eType</a>];</div>
<div class="line"><span class="lineno">   55</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#af60af983b91daddf1e37b0583aee14d8">d_numDofs</a> = mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">d_numNodes</a> * mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a34ffe327272d99ace79c46cb97f11cae">d_dim</a>;</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  <span class="comment">// local nodal data</span></div>
<div class="line"><span class="lineno">   58</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a01d54cbc134e13540166d6dd8ffa2eb9">d_nodes</a>.resize(mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">d_numNodes</a>);</div>
<div class="line"><span class="lineno">   59</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>.resize(mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a4ea35d9a5be30637c26117d6c2c80a26">d_numElems</a> * mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a>);</div>
<div class="line"><span class="lineno">   60</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a4403f1fc6060e401a16be0863edddda3">d_fix</a> = std::vector&lt;uint8_t&gt;(mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a01d54cbc134e13540166d6dd8ffa2eb9">d_nodes</a>.size(), uint8_t(0));</div>
<div class="line"><span class="lineno">   61</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>.resize(mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">d_numNodes</a>);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// create mesh data</span></div>
<div class="line"><span class="lineno">   64</span>  std::vector&lt;double&gt; <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>;</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordtype">double</span> h_small = 0.;</div>
<div class="line"><span class="lineno">   66</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;dim; i++) {</div>
<div class="line"><span class="lineno">   67</span>    <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>.push_back((box.second[i] - box.first[i])/nGrid[i]);</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">if</span> (i == 0)</div>
<div class="line"><span class="lineno">   69</span>      h_small = <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[0];</div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   71</span>      <span class="keywordflow">if</span> (std::abs(h[i] - h_small) &gt; 1.0e-14 and h_small &gt; h[1] + 1.0e-14)</div>
<div class="line"><span class="lineno">   72</span>        h_small = <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[i];</div>
<div class="line"><span class="lineno">   73</span>    }</div>
<div class="line"><span class="lineno">   74</span>  }</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// set smallest h as mesh size</span></div>
<div class="line"><span class="lineno">   77</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a1945bb1724680059e0990eba9f1ff59b">d_h</a> = h_small;</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="keywordflow">if</span> (dim == 1) {</div>
<div class="line"><span class="lineno">   80</span>    <span class="comment">// compute node positions</span></div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= nGrid[0]; i++) {</div>
<div class="line"><span class="lineno">   82</span>      mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a01d54cbc134e13540166d6dd8ffa2eb9">d_nodes</a>[i] = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(box.first[0] + <span class="keywordtype">double</span>(i) * h[0], 0., 0.);</div>
<div class="line"><span class="lineno">   83</span>      mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[i] = <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[0];</div>
<div class="line"><span class="lineno">   84</span>      <span class="keywordflow">if</span> (i == 0 || i == nGrid[0]) mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[i] *= 0.5;</div>
<div class="line"><span class="lineno">   85</span>    } <span class="comment">// loop over i</span></div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <span class="comment">// compute element-node connectivity</span></div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nGrid[0]; i++) {</div>
<div class="line"><span class="lineno">   89</span>      <span class="comment">// element node connectivity</span></div>
<div class="line"><span class="lineno">   90</span>      <span class="comment">// TODO Check if ordering is conforming to the standard</span></div>
<div class="line"><span class="lineno">   91</span>      mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[2 * i + 0] = i;</div>
<div class="line"><span class="lineno">   92</span>      mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[2 * i + 1] = i + 1;</div>
<div class="line"><span class="lineno">   93</span>    } <span class="comment">// loop over i</span></div>
<div class="line"><span class="lineno">   94</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 2) {</div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">// compute node positions</span></div>
<div class="line"><span class="lineno">   96</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= nGrid[1]; j++) {</div>
<div class="line"><span class="lineno">   97</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= nGrid[0]; i++) {</div>
<div class="line"><span class="lineno">   98</span>        <span class="comment">// node number</span></div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordtype">size_t</span> n = j * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  100</span>        mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a01d54cbc134e13540166d6dd8ffa2eb9">d_nodes</a>[n] = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(box.first[0] + <span class="keywordtype">double</span>(i) * h[0],</div>
<div class="line"><span class="lineno">  101</span>                                         box.first[1] + <span class="keywordtype">double</span>(j) * h[1], 0.);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] = <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[0] * <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[1];</div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">if</span> (i == 0 || i == nGrid[0]) mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] *= 0.5;</div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">if</span> (j == 0 || j == nGrid[1]) mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] *= 0.5;</div>
<div class="line"><span class="lineno">  106</span>      }  <span class="comment">// loop over i</span></div>
<div class="line"><span class="lineno">  107</span>    } <span class="comment">// loop over j</span></div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="comment">// compute element-node connectivity</span></div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; nGrid[1]; j++) {</div>
<div class="line"><span class="lineno">  111</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nGrid[0]; i++) {</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>        <span class="comment">// element number</span></div>
<div class="line"><span class="lineno">  114</span>        <span class="keyword">auto</span> n = j * nGrid[0] + i;</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>        <span class="comment">// element node connectivity (put it in anti clockwise order)</span></div>
<div class="line"><span class="lineno">  117</span>        mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[4 * n + 0] = j * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  118</span>        mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[4 * n + 1] = j * (nGrid[0] + 1) + i + 1;</div>
<div class="line"><span class="lineno">  119</span>        mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[4 * n + 2] = (j + 1) * (nGrid[0] + 1) + i + 1;</div>
<div class="line"><span class="lineno">  120</span>        mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[4 * n + 3] = (j + 1) * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  121</span>      } <span class="comment">// loop over i</span></div>
<div class="line"><span class="lineno">  122</span>    } <span class="comment">// loop over j</span></div>
<div class="line"><span class="lineno">  123</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3) {</div>
<div class="line"><span class="lineno">  124</span>    <span class="comment">// compute node positions</span></div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt;= nGrid[2]; k++) {</div>
<div class="line"><span class="lineno">  126</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= nGrid[1]; j++) {</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= nGrid[0]; i++) {</div>
<div class="line"><span class="lineno">  128</span>          <span class="comment">// node number</span></div>
<div class="line"><span class="lineno">  129</span>          <span class="keywordtype">size_t</span> n = k * (nGrid[1] + 1) * (nGrid[0] + 1) +  j * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  130</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a01d54cbc134e13540166d6dd8ffa2eb9">d_nodes</a>[n] = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(box.first[0] + <span class="keywordtype">double</span>(i) * h[0],</div>
<div class="line"><span class="lineno">  131</span>                                           box.first[1] + <span class="keywordtype">double</span>(j) * h[1],</div>
<div class="line"><span class="lineno">  132</span>                                           box.first[2] + <span class="keywordtype">double</span>(k) * h[2]);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] = <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[0] * <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[1] * <a class="code hl_variable" href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">h</a>[2];</div>
<div class="line"><span class="lineno">  135</span>          <span class="keywordflow">if</span> (i == 0 || i == nGrid[0]) mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] *= 0.5;</div>
<div class="line"><span class="lineno">  136</span>          <span class="keywordflow">if</span> (j == 0 || j == nGrid[1]) mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] *= 0.5;</div>
<div class="line"><span class="lineno">  137</span>          <span class="keywordflow">if</span> (k == 0 || k == nGrid[2]) mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">d_vol</a>[n] *= 0.5;</div>
<div class="line"><span class="lineno">  138</span>        }  <span class="comment">// loop over i</span></div>
<div class="line"><span class="lineno">  139</span>      } <span class="comment">// loop over j</span></div>
<div class="line"><span class="lineno">  140</span>    } <span class="comment">// loop over k</span></div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    <span class="comment">// compute element-node connectivity</span></div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt;= nGrid[2]; k++) {</div>
<div class="line"><span class="lineno">  144</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; nGrid[1]; j++) {</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; nGrid[0]; i++) {</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>          <span class="comment">// element number</span></div>
<div class="line"><span class="lineno">  148</span>          <span class="keyword">auto</span> n = k * nGrid[1] * nGrid[0] + j * nGrid[0] + i;</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>          <span class="comment">// element node connectivity</span></div>
<div class="line"><span class="lineno">  151</span>          <span class="comment">// TODO Check if ordering is conforming to the standard</span></div>
<div class="line"><span class="lineno">  152</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 0] =   k * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  153</span>                                     + j * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  154</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 1] =   k * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  155</span>                                     + j * (nGrid[0] + 1) + i + 1;</div>
<div class="line"><span class="lineno">  156</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 2] =   k * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  157</span>                                     + (j + 1) * (nGrid[0] + 1) + i + 1;</div>
<div class="line"><span class="lineno">  158</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 3] =   k * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  159</span>                                     + (j + 1) * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 4] =   (k + 1) * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  162</span>                                       + j * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  163</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 5] =   (k + 1) * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  164</span>                                       + j * (nGrid[0] + 1) + i + 1;</div>
<div class="line"><span class="lineno">  165</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 6] =   (k + 1) * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  166</span>                                       + (j + 1) * (nGrid[0] + 1) + i + 1;</div>
<div class="line"><span class="lineno">  167</span>          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">d_enc</a>[8 * n + 7] =   (k + 1) * (nGrid[1] + 1) * (nGrid[0] + 1)</div>
<div class="line"><span class="lineno">  168</span>                                       + (j + 1) * (nGrid[0] + 1) + i;</div>
<div class="line"><span class="lineno">  169</span>        } <span class="comment">// loop over i</span></div>
<div class="line"><span class="lineno">  170</span>      } <span class="comment">// loop over j</span></div>
<div class="line"><span class="lineno">  171</span>    } <span class="comment">// loop over k</span></div>
<div class="line"><span class="lineno">  172</span>  }</div>
<div class="line"><span class="lineno">  173</span>}</div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a01d54cbc134e13540166d6dd8ffa2eb9"><div class="ttname"><a href="classfe_1_1Mesh.html#a01d54cbc134e13540166d6dd8ffa2eb9">fe::Mesh::d_nodes</a></div><div class="ttdeci">std::vector&lt; util::Point &gt; d_nodes</div><div class="ttdoc">Vector of initial (reference) coordinates of nodes.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00407">mesh.h:407</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a09fffecc9f8b882b654117a2dfbf660b"><div class="ttname"><a href="classfe_1_1Mesh.html#a09fffecc9f8b882b654117a2dfbf660b">fe::Mesh::d_vol</a></div><div class="ttdeci">std::vector&lt; double &gt; d_vol</div><div class="ttdoc">Vector of volume of each node.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00439">mesh.h:439</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a1945bb1724680059e0990eba9f1ff59b"><div class="ttname"><a href="classfe_1_1Mesh.html#a1945bb1724680059e0990eba9f1ff59b">fe::Mesh::d_h</a></div><div class="ttdeci">double d_h</div><div class="ttdoc">Mesh size.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00516">mesh.h:516</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a34ffe327272d99ace79c46cb97f11cae"><div class="ttname"><a href="classfe_1_1Mesh.html#a34ffe327272d99ace79c46cb97f11cae">fe::Mesh::d_dim</a></div><div class="ttdeci">size_t d_dim</div><div class="ttdoc">Dimension of the mesh.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00468">mesh.h:468</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a4403f1fc6060e401a16be0863edddda3"><div class="ttname"><a href="classfe_1_1Mesh.html#a4403f1fc6060e401a16be0863edddda3">fe::Mesh::d_fix</a></div><div class="ttdeci">std::vector&lt; uint8_t &gt; d_fix</div><div class="ttdoc">Vector of fixity mask of each node.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00431">mesh.h:431</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a4ea35d9a5be30637c26117d6c2c80a26"><div class="ttname"><a href="classfe_1_1Mesh.html#a4ea35d9a5be30637c26117d6c2c80a26">fe::Mesh::d_numElems</a></div><div class="ttdeci">size_t d_numElems</div><div class="ttdoc">Number of elements.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00378">mesh.h:378</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a5ea864db70a4b7682992d65e66777a6e"><div class="ttname"><a href="classfe_1_1Mesh.html#a5ea864db70a4b7682992d65e66777a6e">fe::Mesh::d_bbox</a></div><div class="ttdeci">std::pair&lt; std::vector&lt; double &gt;, std::vector&lt; double &gt; &gt; d_bbox</div><div class="ttdoc">Bounding box.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00513">mesh.h:513</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a6a077b5520d8a1b356b96437e67ec0fe"><div class="ttname"><a href="classfe_1_1Mesh.html#a6a077b5520d8a1b356b96437e67ec0fe">fe::Mesh::d_eType</a></div><div class="ttdeci">size_t d_eType</div><div class="ttdoc">Element type.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00389">mesh.h:389</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a8052daf34d6b267e4760ed920443083b"><div class="ttname"><a href="classfe_1_1Mesh.html#a8052daf34d6b267e4760ed920443083b">fe::Mesh::d_enc</a></div><div class="ttdeci">std::vector&lt; size_t &gt; d_enc</div><div class="ttdoc">Element-node connectivity data.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00415">mesh.h:415</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_aa40c6de87c639b7bad467d20c9574540"><div class="ttname"><a href="classfe_1_1Mesh.html#aa40c6de87c639b7bad467d20c9574540">fe::Mesh::d_numNodes</a></div><div class="ttdeci">size_t d_numNodes</div><div class="ttdoc">Number of nodes.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00375">mesh.h:375</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_aabc21bd2d84016c386bcd0834f781f61"><div class="ttname"><a href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">fe::Mesh::d_eNumVertex</a></div><div class="ttdeci">size_t d_eNumVertex</div><div class="ttdoc">Number of vertex per element.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00404">mesh.h:404</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_af60af983b91daddf1e37b0583aee14d8"><div class="ttname"><a href="classfe_1_1Mesh.html#af60af983b91daddf1e37b0583aee14d8">fe::Mesh::d_numDofs</a></div><div class="ttdeci">size_t d_numDofs</div><div class="ttdoc">Number of dofs = (dimension) times (number of nodes)</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00490">mesh.h:490</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga128305c3997f5bf379c9a7550ef0b80a"><div class="ttname"><a href="group__GlobalVars.html#ga128305c3997f5bf379c9a7550ef0b80a">util::vtk_map_element_to_num_nodes</a></div><div class="ttdeci">static int vtk_map_element_to_num_nodes[16]</div><div class="ttdoc">Map from element type to number of nodes (for vtk)</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00085">feElementDefs.h:85</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga1ac9d70a30c6e341904dfa5fbb13f15c"><div class="ttname"><a href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a></div><div class="ttdeci">static const int vtk_type_quad</div><div class="ttdoc">Integer flag for quad element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00067">feElementDefs.h:67</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga6df6bf3a8e7eb725b9619dcf39fc21a1"><div class="ttname"><a href="group__GlobalVars.html#ga6df6bf3a8e7eb725b9619dcf39fc21a1">util::vtk_type_hexahedron</a></div><div class="ttdeci">static const int vtk_type_hexahedron</div><div class="ttdoc">Integer flag for hexahedron element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00076">feElementDefs.h:76</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_gaae6892e182cba70ae7985d94f12bd3d9"><div class="ttname"><a href="group__GlobalVars.html#gaae6892e182cba70ae7985d94f12bd3d9">util::vtk_type_line</a></div><div class="ttdeci">static const int vtk_type_line</div><div class="ttdoc">Integer flag for line element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00049">feElementDefs.h:49</a></div></div>
<div class="ttc" id="anamespacegmsh__particles_html_ad9e6465f12f3fa0dd2db6f3579f2c5f2"><div class="ttname"><a href="namespacegmsh__particles.html#ad9e6465f12f3fa0dd2db6f3579f2c5f2">gmsh_particles.h</a></div><div class="ttdeci">h</div><div class="ttdef"><b>Definition</b> <a href="gmsh__particles_8py_source.html#l01363">gmsh_particles.py:1363</a></div></div>
<div class="ttc" id="astructutil_1_1Point_html"><div class="ttname"><a href="structutil_1_1Point.html">util::Point</a></div><div class="ttdoc">A structure to represent 3d vectors.</div><div class="ttdef"><b>Definition</b> <a href="point_8h_source.html#l00030">point.h:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mesh_8h_source.html#l00513">fe::Mesh::d_bbox</a>, <a class="el" href="mesh_8h_source.html#l00468">fe::Mesh::d_dim</a>, <a class="el" href="mesh_8h_source.html#l00415">fe::Mesh::d_enc</a>, <a class="el" href="mesh_8h_source.html#l00404">fe::Mesh::d_eNumVertex</a>, <a class="el" href="mesh_8h_source.html#l00389">fe::Mesh::d_eType</a>, <a class="el" href="mesh_8h_source.html#l00431">fe::Mesh::d_fix</a>, <a class="el" href="mesh_8h_source.html#l00516">fe::Mesh::d_h</a>, <a class="el" href="mesh_8h_source.html#l00407">fe::Mesh::d_nodes</a>, <a class="el" href="mesh_8h_source.html#l00490">fe::Mesh::d_numDofs</a>, <a class="el" href="mesh_8h_source.html#l00378">fe::Mesh::d_numElems</a>, <a class="el" href="mesh_8h_source.html#l00375">fe::Mesh::d_numNodes</a>, <a class="el" href="mesh_8h_source.html#l00439">fe::Mesh::d_vol</a>, <a class="el" href="feElementDefs_8h_source.html#l00085">util::vtk_map_element_to_num_nodes</a>, <a class="el" href="feElementDefs_8h_source.html#l00076">util::vtk_type_hexahedron</a>, <a class="el" href="feElementDefs_8h_source.html#l00049">util::vtk_type_line</a>, and <a class="el" href="feElementDefs_8h_source.html#l00067">util::vtk_type_quad</a>.</p>

<p class="reference">Referenced by <a class="el" href="demModel_8cpp_source.html#l01097">model::DEMModel::createParticles()</a>, <a class="el" href="testMeshPartitioningLib_8cpp_source.html#l00137">test::testGraphPartitioning()</a>, and <a class="el" href="testParallelCompLib_8cpp_source.html#l00285">test::testMPI()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_abe6bbc09314c74619abaa8c13f489335_icgraph.svg" width="538" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aeecd141ec0e6723bdddd740903cb95f8" name="aeecd141ec0e6723bdddd740903cb95f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeecd141ec0e6723bdddd740903cb95f8">&#9670;&#160;</a></span>getCurrentQuadPoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fe::getCurrentQuadPoints </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xQuadCur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iNodeStart</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iQuadStart</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>quadOrder</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get current location of quadrature points of elements in the mesh. This function expects mesh has element-node connectivity data. </p>
<p>In case of multiple particles and meshes, xRef and u data will hold data for all meshes. If this is the case, iNodeStart integer can be used to specify from what index the data for a given mesh should be read. E.g., if we have two particles with their own mesh, and suppose particle 1 and 2 have n1 and n2 number nodes than</p><ol type="1">
<li>xRef and u will be a vector of n1+n2 size</li>
<li>For particle 1, node data in xRef and u starts from iNodeStart = 0</li>
<li>For particle 2, node data in xRef and u starts from iNodeStart = n1</li>
</ol>
<p>For the above example, suppose first particle has total nq1 number of quadrature points from all the elements in the mesh of particle 1 and second particle has total nq2 number of quadrature points. Then,</p><ol type="1">
<li>xQuadCur will be of size nq1 + nq2</li>
<li>For particle 1, quad data in xQuadCur starts from iQuadStart = 0</li>
<li>For particle 2, quad data in xQuadCur starts from iQuadStart = nq2</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh_p</td><td>Pointer to already created possibly empty mesh object </td></tr>
    <tr><td class="paramname">xRef</td><td>Vector of reference coordinates of nodes </td></tr>
    <tr><td class="paramname">u</td><td>Vector of displacement of nodes </td></tr>
    <tr><td class="paramname">xQuadCur</td><td>Vector of current positions of quadrature points (this argument is modified) </td></tr>
    <tr><td class="paramname">iNodeStart</td><td>Assume that nodal data in xRef and u starts from iNodeStart </td></tr>
    <tr><td class="paramname">iQuadStart</td><td>Assume that quadrature data in xQuadCur starts from iNodeStart </td></tr>
    <tr><td class="paramname">quadOrder</td><td>Order of quadrature approximation (default is 1) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="meshUtil_8cpp_source.html#l00176">176</a> of file <a class="el" href="meshUtil_8cpp_source.html">meshUtil.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  182</span>                                           {</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordtype">size_t</span> num_elems = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">getNumElements</a>();</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>  <span class="comment">// check data</span></div>
<div class="line"><span class="lineno">  187</span>  assert((num_elems != 0) &amp;&amp; <span class="stringliteral">&quot;Number of elements in the mesh is zero &quot;</span></div>
<div class="line"><span class="lineno">  188</span>                             <span class="stringliteral">&quot;possibly due to missing element-node &quot;</span></div>
<div class="line"><span class="lineno">  189</span>                             <span class="stringliteral">&quot;connectivity data. Can not proceed with &quot;</span></div>
<div class="line"><span class="lineno">  190</span>                             <span class="stringliteral">&quot;computation.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  assert(( (xRef.size() &gt;= mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">getNumNodes</a>() + iNodeStart) ||</div>
<div class="line"><span class="lineno">  193</span>           (u.size() &gt;= mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">getNumNodes</a>() + iNodeStart)</div>
<div class="line"><span class="lineno">  194</span>          ) &amp;&amp;</div>
<div class="line"><span class="lineno">  195</span>           <span class="stringliteral">&quot;Number of elements i nnodal data can not be smaller than number of &quot;</span></div>
<div class="line"><span class="lineno">  196</span>                                                   <span class="stringliteral">&quot;nodes.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  199</span>  <a class="code hl_class" href="classfe_1_1BaseElem.html">fe::BaseElem</a> *elem;</div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#gaae6892e182cba70ae7985d94f12bd3d9">util::vtk_type_line</a>)</div>
<div class="line"><span class="lineno">  201</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1LineElem.html">fe::LineElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga1a164a7b8ac23ab4ab769db408eea56f">util::vtk_type_triangle</a>)</div>
<div class="line"><span class="lineno">  203</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1TriElem.html">fe::TriElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a>)</div>
<div class="line"><span class="lineno">  205</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1QuadElem.html">fe::QuadElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  206</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga59139fde535d8d4b7b8ff2ed36b4f17b">util::vtk_type_tetra</a>)</div>
<div class="line"><span class="lineno">  207</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1TetElem.html">fe::TetElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  209</span>    std::cerr &lt;&lt; fmt::format(<span class="stringliteral">&quot;Error: Can not compute strain/stress as the element &quot;</span></div>
<div class="line"><span class="lineno">  210</span>                 <span class="stringliteral">&quot;type = {} is not yet supported in this routine.\n&quot;</span>, mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>());</div>
<div class="line"><span class="lineno">  211</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  212</span>  }</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="comment">// get total number of quadrature points by getting the number of quad</span></div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">// points in one element times the number of elements</span></div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordtype">size_t</span> numQuadPointsTotal = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">getNumElements</a>() *</div>
<div class="line"><span class="lineno">  217</span>          elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>();</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  assert((xQuadCur.size() &gt;= numQuadPointsTotal + iQuadStart)</div>
<div class="line"><span class="lineno">  220</span>        &amp;&amp; <span class="stringliteral">&quot;Number of elements in xQuad data can not be less than &quot;</span></div>
<div class="line"><span class="lineno">  221</span>           <span class="stringliteral">&quot;total number of quadrature points.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>  <span class="comment">//  std::cout &lt;&lt; fmt::format(&quot;num_elems = {}, &quot;</span></div>
<div class="line"><span class="lineno">  224</span>  <span class="comment">//                           &quot;iNodeStart = {}, &quot;</span></div>
<div class="line"><span class="lineno">  225</span>  <span class="comment">//                           &quot;numQuadPointsTotal = {}, &quot;</span></div>
<div class="line"><span class="lineno">  226</span>  <span class="comment">//                           &quot;iQuadStart = {}, &quot;</span></div>
<div class="line"><span class="lineno">  227</span>  <span class="comment">//                           &quot;xQuadCur.size() = {}&quot;,</span></div>
<div class="line"><span class="lineno">  228</span>  <span class="comment">//                           num_elems,</span></div>
<div class="line"><span class="lineno">  229</span>  <span class="comment">//                           iNodeStart,</span></div>
<div class="line"><span class="lineno">  230</span>  <span class="comment">//                           numQuadPointsTotal,</span></div>
<div class="line"><span class="lineno">  231</span>  <span class="comment">//                           iQuadStart,</span></div>
<div class="line"><span class="lineno">  232</span>  <span class="comment">//                           xQuadCur.size())</span></div>
<div class="line"><span class="lineno">  233</span>  <span class="comment">//           &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>  <span class="comment">// compute current position of quad points</span></div>
<div class="line"><span class="lineno">  237</span>  tf::Executor executor(<a class="code hl_function" href="namespaceutil_1_1parallel.html#a4ad550a438091fb9cd924783e690764d">util::parallel::getNThreads</a>());</div>
<div class="line"><span class="lineno">  238</span>  tf::Taskflow taskflow;</div>
<div class="line"><span class="lineno">  239</span>  taskflow.for_each_index(</div>
<div class="line"><span class="lineno">  240</span>        (std::size_t) 0, num_elems, (std::size_t) 1,</div>
<div class="line"><span class="lineno">  241</span>        [elem, mesh_p, xRef, u, iNodeStart, iQuadStart, &amp;xQuadCur]</div>
<div class="line"><span class="lineno">  242</span>        (std::size_t e) {</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>          <span class="comment">// get ids of nodes of element and reference coordinate of nodes</span></div>
<div class="line"><span class="lineno">  245</span>          <span class="keyword">auto</span> id_nds = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a8cfebeb2d96199744d0c7de324a0066a">getElementConnectivity</a>(e);</div>
<div class="line"><span class="lineno">  246</span>          <span class="keyword">auto</span> e_nds_start = iNodeStart + mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a> * e;</div>
<div class="line"><span class="lineno">  247</span>          <span class="keyword">auto</span> e_nds_end = e_nds_start + mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a>;</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>          <span class="comment">//assert( (e_nds_end &lt;= xRef.size()) &amp;&amp; &quot;e_nds_end bigger than size of xRef\n&quot; );</span></div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>          <span class="comment">//std::vector&lt;util::Point&gt; nds(xRef.begin() + e_nds_start,</span></div>
<div class="line"><span class="lineno">  252</span>          <span class="comment">//                             xRef.begin() + e_nds_end);</span></div>
<div class="line"><span class="lineno">  253</span>          std::vector&lt;util::Point&gt; nds;</div>
<div class="line"><span class="lineno">  254</span>          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;i : id_nds)</div>
<div class="line"><span class="lineno">  255</span>            nds.push_back(xRef[i + iNodeStart]);</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>          <span class="keyword">auto</span> qds = elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">getQuadDatas</a>(nds);</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>          <span class="keyword">auto</span> qd_point_current = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>();</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> q=0; q&lt;qds.size(); q++) {</div>
<div class="line"><span class="lineno">  262</span>            qd_point_current = qds[q].d_p;</div>
<div class="line"><span class="lineno">  263</span>            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; id_nds.size(); i++) {</div>
<div class="line"><span class="lineno">  264</span>              <span class="keyword">auto</span> i_global_id = iNodeStart + id_nds[i];</div>
<div class="line"><span class="lineno">  265</span>              qd_point_current += u[i_global_id] * qds[q].d_shapes[i];</div>
<div class="line"><span class="lineno">  266</span>            }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>            <span class="comment">// location of this quad points current position in the vector</span></div>
<div class="line"><span class="lineno">  269</span>            <span class="comment">// is e * getNumQuadPoints() + q, where e is the index of</span></div>
<div class="line"><span class="lineno">  270</span>            <span class="comment">// current element we are processing</span></div>
<div class="line"><span class="lineno">  271</span>            <span class="keyword">auto</span> q_global_id = iQuadStart + e * elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>() + q;</div>
<div class="line"><span class="lineno">  272</span>            xQuadCur[q_global_id] = qd_point_current;</div>
<div class="line"><span class="lineno">  273</span>          }</div>
<div class="line"><span class="lineno">  274</span>        } <span class="comment">// loop over elements</span></div>
<div class="line"><span class="lineno">  275</span>  ); <span class="comment">// for_each</span></div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  executor.run(taskflow).get();</div>
<div class="line"><span class="lineno">  278</span>}</div>
<div class="ttc" id="aclassfe_1_1BaseElem_html"><div class="ttname"><a href="classfe_1_1BaseElem.html">fe::BaseElem</a></div><div class="ttdoc">A base class which provides methods to map points to/from reference element and to compute quadrature...</div><div class="ttdef"><b>Definition</b> <a href="baseElem_8h_source.html#l00084">baseElem.h:84</a></div></div>
<div class="ttc" id="aclassfe_1_1BaseElem_html_a845050a671a67d9dc61d294bd11ef16d"><div class="ttname"><a href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">fe::BaseElem::getQuadDatas</a></div><div class="ttdeci">virtual std::vector&lt; fe::QuadData &gt; getQuadDatas(const std::vector&lt; util::Point &gt; &amp;nodes)=0</div><div class="ttdoc">Get vector of quadrature data.</div></div>
<div class="ttc" id="aclassfe_1_1BaseElem_html_a96fb54d9aca45e987c163e95242ceb8f"><div class="ttname"><a href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">fe::BaseElem::getNumQuadPoints</a></div><div class="ttdeci">size_t getNumQuadPoints()</div><div class="ttdoc">Get number of quadrature points in the data.</div><div class="ttdef"><b>Definition</b> <a href="baseElem_8h_source.html#l00111">baseElem.h:111</a></div></div>
<div class="ttc" id="aclassfe_1_1LineElem_html"><div class="ttname"><a href="classfe_1_1LineElem.html">fe::LineElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for linear 2-node line element.</div><div class="ttdef"><b>Definition</b> <a href="lineElem_8h_source.html#l00049">lineElem.h:49</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a55b3e75c83f467a678b3f775a6ac0dec"><div class="ttname"><a href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">fe::Mesh::getElementType</a></div><div class="ttdeci">size_t getElementType() const</div><div class="ttdoc">Get the type of element in mesh.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00106">mesh.h:106</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a8cfebeb2d96199744d0c7de324a0066a"><div class="ttname"><a href="classfe_1_1Mesh.html#a8cfebeb2d96199744d0c7de324a0066a">fe::Mesh::getElementConnectivity</a></div><div class="ttdeci">std::vector&lt; size_t &gt; getElementConnectivity(const size_t &amp;i) const</div><div class="ttdoc">Get the connectivity of element.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00210">mesh.h:210</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_aac3df3472139b865eda7406c1d1c3d77"><div class="ttname"><a href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">fe::Mesh::getNumNodes</a></div><div class="ttdeci">size_t getNumNodes() const</div><div class="ttdoc">Get the number of nodes.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00088">mesh.h:88</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_ab168daf41aec75099948a519d1a252ad"><div class="ttname"><a href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">fe::Mesh::getNumElements</a></div><div class="ttdeci">size_t getNumElements() const</div><div class="ttdoc">Get the number of elements.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00094">mesh.h:94</a></div></div>
<div class="ttc" id="aclassfe_1_1QuadElem_html"><div class="ttname"><a href="classfe_1_1QuadElem.html">fe::QuadElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for bi-linear quadrangle element.</div><div class="ttdef"><b>Definition</b> <a href="quadElem_8h_source.html#l00064">quadElem.h:64</a></div></div>
<div class="ttc" id="aclassfe_1_1TetElem_html"><div class="ttname"><a href="classfe_1_1TetElem.html">fe::TetElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for linear tetrahedron element.</div><div class="ttdef"><b>Definition</b> <a href="tetElem_8h_source.html#l00141">tetElem.h:141</a></div></div>
<div class="ttc" id="aclassfe_1_1TriElem_html"><div class="ttname"><a href="classfe_1_1TriElem.html">fe::TriElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for linear triangle element.</div><div class="ttdef"><b>Definition</b> <a href="triElem_8h_source.html#l00091">triElem.h:91</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga1a164a7b8ac23ab4ab769db408eea56f"><div class="ttname"><a href="group__GlobalVars.html#ga1a164a7b8ac23ab4ab769db408eea56f">util::vtk_type_triangle</a></div><div class="ttdeci">static const int vtk_type_triangle</div><div class="ttdoc">Integer flag for triangle element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00055">feElementDefs.h:55</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga59139fde535d8d4b7b8ff2ed36b4f17b"><div class="ttname"><a href="group__GlobalVars.html#ga59139fde535d8d4b7b8ff2ed36b4f17b">util::vtk_type_tetra</a></div><div class="ttdeci">static const int vtk_type_tetra</div><div class="ttdoc">Integer flag for tetrahedron element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00070">feElementDefs.h:70</a></div></div>
<div class="ttc" id="anamespaceutil_1_1parallel_html_a4ad550a438091fb9cd924783e690764d"><div class="ttname"><a href="namespaceutil_1_1parallel.html#a4ad550a438091fb9cd924783e690764d">util::parallel::getNThreads</a></div><div class="ttdeci">unsigned int getNThreads()</div><div class="ttdoc">Get number of threads to be used by taskflow.</div><div class="ttdef"><b>Definition</b> <a href="parallelUtil_8cpp_source.html#l00116">parallelUtil.cpp:116</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mesh_8h_source.html#l00404">fe::Mesh::d_eNumVertex</a>, <a class="el" href="mesh_8h_source.html#l00210">fe::Mesh::getElementConnectivity()</a>, <a class="el" href="mesh_8h_source.html#l00106">fe::Mesh::getElementType()</a>, <a class="el" href="parallelUtil_8cpp_source.html#l00116">util::parallel::getNThreads()</a>, <a class="el" href="mesh_8h_source.html#l00094">fe::Mesh::getNumElements()</a>, <a class="el" href="mesh_8h_source.html#l00088">fe::Mesh::getNumNodes()</a>, <a class="el" href="baseElem_8h_source.html#l00111">fe::BaseElem::getNumQuadPoints()</a>, <a class="el" href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">fe::BaseElem::getQuadDatas()</a>, <a class="el" href="feElementDefs_8h_source.html#l00049">util::vtk_type_line</a>, <a class="el" href="feElementDefs_8h_source.html#l00067">util::vtk_type_quad</a>, <a class="el" href="feElementDefs_8h_source.html#l00070">util::vtk_type_tetra</a>, and <a class="el" href="feElementDefs_8h_source.html#l00055">util::vtk_type_triangle</a>.</p>

<p class="reference">Referenced by <a class="el" href="demModel_8cpp_source.html#l01962">model::DEMModel::output()</a>, and <a class="el" href="apps_2twoparticle__demo_2main_8cpp_source.html#l00281">twoparticle_demo::Model::twoParticleTestMaxShearStress()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_aeecd141ec0e6723bdddd740903cb95f8_cgraph.svg" width="450" height="348"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_aeecd141ec0e6723bdddd740903cb95f8_icgraph.svg" width="1224" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a09527ce4f52ec0da5f9cf970ac08f542" name="a09527ce4f52ec0da5f9cf970ac08f542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09527ce4f52ec0da5f9cf970ac08f542">&#9670;&#160;</a></span>getMaxShearStressAndLoc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fe::getMaxShearStressAndLoc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>stress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>maxShearStress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutil_1_1Point.html">util::Point</a> &amp;&#160;</td>
          <td class="paramname"><em>maxShearStressLocRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structutil_1_1Point.html">util::Point</a> &amp;&#160;</td>
          <td class="paramname"><em>maxShearStressLocCur</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iNodeStart</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iStrainStart</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>quadOrder</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get location where maximum of specified component of stress occurs in this particle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh_p</td><td>Pointer to already created possibly empty mesh object </td></tr>
    <tr><td class="paramname">xRef</td><td>Vector of reference coordinates of nodes </td></tr>
    <tr><td class="paramname">u</td><td>Vector of displacement of nodes </td></tr>
    <tr><td class="paramname">stress</td><td>Vector of symmetric stress tensor </td></tr>
    <tr><td class="paramname">maxShearStress</td><td>Value of maximum shear stress </td></tr>
    <tr><td class="paramname">maxShearStressLocRef</td><td>Location where this occurs (in reference configuration) </td></tr>
    <tr><td class="paramname">maxShearStressLocCur</td><td>Location where this occurs (in current configuration) </td></tr>
    <tr><td class="paramname">iNodeStart</td><td>Assume that nodal data in xRef and u starts from iNodeStar </td></tr>
    <tr><td class="paramname">iStrainStart</td><td>Assume that quadrature data in strain/stress starts from iNodeStart </td></tr>
    <tr><td class="paramname">quadOrder</td><td>Order of quadrature approximation (default is 1) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="meshUtil_8cpp_source.html#l00429">429</a> of file <a class="el" href="meshUtil_8cpp_source.html">meshUtil.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  438</span>                                                   {</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>  assert((mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">getDimension</a>() == 2) &amp;&amp; <span class="stringliteral">&quot;In getMaxShearStressAndLoc(), only dimension = 2 is supported.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>  <span class="keywordtype">size_t</span> num_elems = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">getNumElements</a>();</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>  <span class="comment">// check data</span></div>
<div class="line"><span class="lineno">  445</span>  assert((num_elems != 0) &amp;&amp; <span class="stringliteral">&quot;Number of elements in the mesh is zero &quot;</span></div>
<div class="line"><span class="lineno">  446</span>                             <span class="stringliteral">&quot;possibly due to missing element-node &quot;</span></div>
<div class="line"><span class="lineno">  447</span>                             <span class="stringliteral">&quot;connectivity data. Can not proceed with &quot;</span></div>
<div class="line"><span class="lineno">  448</span>                             <span class="stringliteral">&quot;computation.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>  assert(( (xRef.size() &gt;= mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">getNumNodes</a>() + iNodeStart) ||</div>
<div class="line"><span class="lineno">  451</span>           (u.size() &gt;= mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">getNumNodes</a>() + iNodeStart)</div>
<div class="line"><span class="lineno">  452</span>         ) &amp;&amp;</div>
<div class="line"><span class="lineno">  453</span>         <span class="stringliteral">&quot;Number of elements i nnodal data can not be smaller than number of &quot;</span></div>
<div class="line"><span class="lineno">  454</span>         <span class="stringliteral">&quot;nodes.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  457</span>  <a class="code hl_class" href="classfe_1_1BaseElem.html">fe::BaseElem</a> *elem;</div>
<div class="line"><span class="lineno">  458</span>  <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#gaae6892e182cba70ae7985d94f12bd3d9">util::vtk_type_line</a>)</div>
<div class="line"><span class="lineno">  459</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1LineElem.html">fe::LineElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  460</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga1a164a7b8ac23ab4ab769db408eea56f">util::vtk_type_triangle</a>)</div>
<div class="line"><span class="lineno">  461</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1TriElem.html">fe::TriElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  462</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a>)</div>
<div class="line"><span class="lineno">  463</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1QuadElem.html">fe::QuadElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  464</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga59139fde535d8d4b7b8ff2ed36b4f17b">util::vtk_type_tetra</a>)</div>
<div class="line"><span class="lineno">  465</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1TetElem.html">fe::TetElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  466</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  467</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: Can not compute strain/stress as the element &quot;</span></div>
<div class="line"><span class="lineno">  468</span>                 <span class="stringliteral">&quot;type is not yet supported in this routine.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  469</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  470</span>  }</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>  <span class="comment">// get total number of quadrature points by getting the number of quad</span></div>
<div class="line"><span class="lineno">  473</span>  <span class="comment">// points in one element times the number of elements</span></div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordtype">size_t</span> numQuadPointsTotal = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">getNumElements</a>() *</div>
<div class="line"><span class="lineno">  475</span>                              elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>();</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>  assert((stress.size() &gt;= numQuadPointsTotal + iStrainStart)</div>
<div class="line"><span class="lineno">  478</span>         &amp;&amp; <span class="stringliteral">&quot;Number of elements in stress data can not be less than &quot;</span></div>
<div class="line"><span class="lineno">  479</span>            <span class="stringliteral">&quot;total number of quadrature points.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>  <span class="comment">// compute principal shear stress</span></div>
<div class="line"><span class="lineno">  482</span>  <span class="keywordtype">double</span> max_stress = 0.;</div>
<div class="line"><span class="lineno">  483</span>  <span class="keywordtype">size_t</span> max_stress_e = 0;</div>
<div class="line"><span class="lineno">  484</span>  <span class="keywordtype">size_t</span> max_stress_q = 0;</div>
<div class="line"><span class="lineno">  485</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; num_elems; e++) {</div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> q=0; q&lt;elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>(); q++) {</div>
<div class="line"><span class="lineno">  487</span>      <span class="keyword">auto</span> q_global_id = iStrainStart + e * elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>() + q;</div>
<div class="line"><span class="lineno">  488</span>      <span class="keyword">const</span> <span class="keyword">auto</span> stress_e = stress[q_global_id];</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>      <span class="keyword">const</span> <span class="keyword">auto</span> principle_shear_stress =</div>
<div class="line"><span class="lineno">  491</span>              std::sqrt(0.25 * std::pow(stress_e.get(0) - stress_e.get(1), 2) +</div>
<div class="line"><span class="lineno">  492</span>                        std::pow(stress_e.get(5), 2));</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceutil.html#a868a26599b6b844d08d30063ac898319">util::isLess</a>(max_stress, principle_shear_stress)) {</div>
<div class="line"><span class="lineno">  495</span>        max_stress = principle_shear_stress;</div>
<div class="line"><span class="lineno">  496</span>        max_stress_e = e;</div>
<div class="line"><span class="lineno">  497</span>        max_stress_q = q;</div>
<div class="line"><span class="lineno">  498</span>      }</div>
<div class="line"><span class="lineno">  499</span>    }</div>
<div class="line"><span class="lineno">  500</span>  }</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>  <span class="comment">// set data</span></div>
<div class="line"><span class="lineno">  503</span>  maxShearStress = max_stress;</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>  <span class="comment">// now compute current and reference location of the quadrature point at which</span></div>
<div class="line"><span class="lineno">  506</span>  <span class="comment">// stress is maximum</span></div>
<div class="line"><span class="lineno">  507</span>  {</div>
<div class="line"><span class="lineno">  508</span>    <span class="comment">// get ids of nodes of element and reference coordinate of nodes</span></div>
<div class="line"><span class="lineno">  509</span>    <span class="keyword">auto</span> id_nds = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a8cfebeb2d96199744d0c7de324a0066a">getElementConnectivity</a>(max_stress_e);</div>
<div class="line"><span class="lineno">  510</span>    <span class="keyword">auto</span> e_nds_start = iNodeStart + mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a> * max_stress_e;</div>
<div class="line"><span class="lineno">  511</span>    <span class="keyword">auto</span> e_nds_end = e_nds_start + mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a>;</div>
<div class="line"><span class="lineno">  512</span>    std::vector&lt;util::Point&gt; nds(xRef.begin() + e_nds_start, xRef.begin() + e_nds_end);</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="keyword">auto</span> qds = elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">getQuadDatas</a>(nds);</div>
<div class="line"><span class="lineno">  515</span>    <span class="keyword">auto</span> qd_point_current = qds[max_stress_q].d_p;</div>
<div class="line"><span class="lineno">  516</span>    maxShearStressLocRef = qd_point_current;</div>
<div class="line"><span class="lineno">  517</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; id_nds.size(); i++) {</div>
<div class="line"><span class="lineno">  518</span>      <span class="keyword">auto</span> i_global_id = iNodeStart + id_nds[i];</div>
<div class="line"><span class="lineno">  519</span>      qd_point_current += u[i_global_id] * qds[max_stress_q].d_shapes[i];</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    maxShearStressLocCur = qd_point_current;</div>
<div class="line"><span class="lineno">  523</span>  }</div>
<div class="line"><span class="lineno">  524</span>}</div>
<div class="ttc" id="aclassfe_1_1Mesh_html_ace82526bc83fe9fd574dc5daf2a10433"><div class="ttname"><a href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">fe::Mesh::getDimension</a></div><div class="ttdeci">size_t getDimension() const</div><div class="ttdoc">Get the dimension of the domain.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00082">mesh.h:82</a></div></div>
<div class="ttc" id="anamespaceutil_html_a868a26599b6b844d08d30063ac898319"><div class="ttname"><a href="namespaceutil.html#a868a26599b6b844d08d30063ac898319">util::isLess</a></div><div class="ttdeci">bool isLess(const double &amp;a, const double &amp;b)</div><div class="ttdoc">Returns true if a &lt; b.</div><div class="ttdef"><b>Definition</b> <a href="function_8cpp_source.html#l00020">function.cpp:20</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mesh_8h_source.html#l00404">fe::Mesh::d_eNumVertex</a>, <a class="el" href="mesh_8h_source.html#l00082">fe::Mesh::getDimension()</a>, <a class="el" href="mesh_8h_source.html#l00210">fe::Mesh::getElementConnectivity()</a>, <a class="el" href="mesh_8h_source.html#l00106">fe::Mesh::getElementType()</a>, <a class="el" href="mesh_8h_source.html#l00094">fe::Mesh::getNumElements()</a>, <a class="el" href="mesh_8h_source.html#l00088">fe::Mesh::getNumNodes()</a>, <a class="el" href="baseElem_8h_source.html#l00111">fe::BaseElem::getNumQuadPoints()</a>, <a class="el" href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">fe::BaseElem::getQuadDatas()</a>, <a class="el" href="function_8cpp_source.html#l00020">util::isLess()</a>, <a class="el" href="feElementDefs_8h_source.html#l00049">util::vtk_type_line</a>, <a class="el" href="feElementDefs_8h_source.html#l00067">util::vtk_type_quad</a>, <a class="el" href="feElementDefs_8h_source.html#l00070">util::vtk_type_tetra</a>, and <a class="el" href="feElementDefs_8h_source.html#l00055">util::vtk_type_triangle</a>.</p>

<p class="reference">Referenced by <a class="el" href="apps_2twoparticle__demo_2main_8cpp_source.html#l00281">twoparticle_demo::Model::twoParticleTestMaxShearStress()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_a09527ce4f52ec0da5f9cf970ac08f542_cgraph.svg" width="479" height="398"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_a09527ce4f52ec0da5f9cf970ac08f542_icgraph.svg" width="1147" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7beb694686b61d7cda5b67aa4bc01104" name="a7beb694686b61d7cda5b67aa4bc01104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7beb694686b61d7cda5b67aa4bc01104">&#9670;&#160;</a></span>getStrainStress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fe::getStrainStress </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>xRef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structutil_1_1Point.html">util::Point</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isPlaneStrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>strain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>stress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iNodeStart</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>iStrainStart</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>nu</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lambda</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mu</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>computeStress</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>quadOrder</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Strain and stress at quadrature points in the mesh. </p>
<p>In case of multiple particles and meshes, xRef and u data will hold data for all meshes. If this is the case, iNodeStart integer can be used to specify from what index the data for a given mesh should be read. Similarly, iStrainStart can be used to specify from what index the data for strain and stress should be substituted in strain/stress vectors. See documentation of @getCurrentQuadPoints().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh_p</td><td>Pointer to already created possibly empty mesh object </td></tr>
    <tr><td class="paramname">xRef</td><td>Vector of reference coordinates of nodes </td></tr>
    <tr><td class="paramname">u</td><td>Vector of displacement of nodes </td></tr>
    <tr><td class="paramname">isPlaneStrain</td><td>Bool that indicates whether to use plane stress/strain assumption (only in 2-d) </td></tr>
    <tr><td class="paramname">strain</td><td>Vector of symmetric matrix to store strain (this argument is modified) </td></tr>
    <tr><td class="paramname">stress</td><td>Vector of symmetric matrix to store stress (this argument is modified) </td></tr>
    <tr><td class="paramname">iNodeStart</td><td>Assume that nodal data in xRef and u starts from iNodeStart </td></tr>
    <tr><td class="paramname">iStrainStart</td><td>Assume that quadrature data in strain/stress starts from iNodeStart </td></tr>
    <tr><td class="paramname">nu</td><td>Poisson ratio (default is zero) </td></tr>
    <tr><td class="paramname">lambda</td><td>Lame's first parameter (default is zero and for this value, stress will not be computed) </td></tr>
    <tr><td class="paramname">mu</td><td>Lame's second parameter, i.e., shear modulus (default is zero and for this value, stress will not be computed) </td></tr>
    <tr><td class="paramname">computeStress</td><td>False will not compute stress </td></tr>
    <tr><td class="paramname">quadOrder</td><td>Order of quadrature approximation (default is 1) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="meshUtil_8cpp_source.html#l00280">280</a> of file <a class="el" href="meshUtil_8cpp_source.html">meshUtil.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  292</span>                                           {</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>  assert((mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">getDimension</a>() &gt; 1) &amp;&amp; <span class="stringliteral">&quot;In getStrainStress(), dimension = 2,3 is supported.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordtype">size_t</span> num_elems = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">getNumElements</a>();</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>  <span class="comment">// check data</span></div>
<div class="line"><span class="lineno">  299</span>  assert((num_elems != 0) &amp;&amp; <span class="stringliteral">&quot;Number of elements in the mesh is zero &quot;</span></div>
<div class="line"><span class="lineno">  300</span>                             <span class="stringliteral">&quot;possibly due to missing element-node &quot;</span></div>
<div class="line"><span class="lineno">  301</span>                             <span class="stringliteral">&quot;connectivity data. Can not proceed with &quot;</span></div>
<div class="line"><span class="lineno">  302</span>                             <span class="stringliteral">&quot;computation.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  assert(( (xRef.size() &gt;= mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">getNumNodes</a>() + iNodeStart) ||</div>
<div class="line"><span class="lineno">  305</span>           (u.size() &gt;= mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#aac3df3472139b865eda7406c1d1c3d77">getNumNodes</a>() + iNodeStart)</div>
<div class="line"><span class="lineno">  306</span>         ) &amp;&amp;</div>
<div class="line"><span class="lineno">  307</span>         <span class="stringliteral">&quot;Number of elements i nodal data can not be smaller than number of &quot;</span></div>
<div class="line"><span class="lineno">  308</span>         <span class="stringliteral">&quot;nodes.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  311</span>  <a class="code hl_class" href="classfe_1_1BaseElem.html">fe::BaseElem</a> *elem;</div>
<div class="line"><span class="lineno">  312</span>  <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#gaae6892e182cba70ae7985d94f12bd3d9">util::vtk_type_line</a>)</div>
<div class="line"><span class="lineno">  313</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1LineElem.html">fe::LineElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  314</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga1a164a7b8ac23ab4ab769db408eea56f">util::vtk_type_triangle</a>)</div>
<div class="line"><span class="lineno">  315</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1TriElem.html">fe::TriElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  316</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a>)</div>
<div class="line"><span class="lineno">  317</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1QuadElem.html">fe::QuadElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  318</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a55b3e75c83f467a678b3f775a6ac0dec">getElementType</a>() == <a class="code hl_variable" href="group__GlobalVars.html#ga59139fde535d8d4b7b8ff2ed36b4f17b">util::vtk_type_tetra</a>)</div>
<div class="line"><span class="lineno">  319</span>    elem = <span class="keyword">new</span> <a class="code hl_class" href="classfe_1_1TetElem.html">fe::TetElem</a>(quadOrder);</div>
<div class="line"><span class="lineno">  320</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  321</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;Error: Can not compute strain/stress as the element &quot;</span></div>
<div class="line"><span class="lineno">  322</span>                 <span class="stringliteral">&quot;type is not yet supported in this routine.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  323</span>    exit(EXIT_FAILURE);</div>
<div class="line"><span class="lineno">  324</span>  }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  <span class="comment">// get total number of quadrature points by getting the number of quad</span></div>
<div class="line"><span class="lineno">  327</span>  <span class="comment">// points in one element times the number of elements</span></div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordtype">size_t</span> numQuadPointsTotal = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ab168daf41aec75099948a519d1a252ad">getNumElements</a>() *</div>
<div class="line"><span class="lineno">  329</span>                              elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>();</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  assert((strain.size() &gt;= numQuadPointsTotal + iStrainStart)</div>
<div class="line"><span class="lineno">  332</span>         &amp;&amp; <span class="stringliteral">&quot;Number of elements in strain data can not be less than &quot;</span></div>
<div class="line"><span class="lineno">  333</span>            <span class="stringliteral">&quot;total number of quadrature points.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>  <span class="comment">// check if we can compute stress from given material data</span></div>
<div class="line"><span class="lineno">  336</span>  computeStress = computeStress || <a class="code hl_function" href="namespaceutil.html#a868a26599b6b844d08d30063ac898319">util::isLess</a>(mu, 1.e-16) || <a class="code hl_function" href="namespaceutil.html#a868a26599b6b844d08d30063ac898319">util::isLess</a>(lambda, 1.e-16);</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>  <span class="keywordflow">if</span> (computeStress)</div>
<div class="line"><span class="lineno">  339</span>    assert((stress.size() &gt;= numQuadPointsTotal + iStrainStart)</div>
<div class="line"><span class="lineno">  340</span>         &amp;&amp; <span class="stringliteral">&quot;Number of elements in stress data can not be less than &quot;</span></div>
<div class="line"><span class="lineno">  341</span>            <span class="stringliteral">&quot;total number of quadrature points.\n&quot;</span>);</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <span class="comment">// compute current position of quad points</span></div>
<div class="line"><span class="lineno">  344</span>  tf::Executor executor(<a class="code hl_function" href="namespaceutil_1_1parallel.html#a4ad550a438091fb9cd924783e690764d">util::parallel::getNThreads</a>());</div>
<div class="line"><span class="lineno">  345</span>  tf::Taskflow taskflow;</div>
<div class="line"><span class="lineno">  346</span>  taskflow.for_each_index(</div>
<div class="line"><span class="lineno">  347</span>          (std::size_t) 0, num_elems, (std::size_t) 1,</div>
<div class="line"><span class="lineno">  348</span>          [elem, mesh_p, xRef, u, iNodeStart, iStrainStart,</div>
<div class="line"><span class="lineno">  349</span>           isPlaneStrain, nu, lambda, mu, computeStress,</div>
<div class="line"><span class="lineno">  350</span>           &amp;strain, &amp;stress]</div>
<div class="line"><span class="lineno">  351</span>                  (std::size_t e) {</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>              <span class="keyword">auto</span> ssn = <a class="code hl_struct" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a>();</div>
<div class="line"><span class="lineno">  354</span>              <span class="keyword">auto</span> sss = <a class="code hl_struct" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a>();</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>              <span class="comment">// get ids of nodes of element and reference coordinate of nodes</span></div>
<div class="line"><span class="lineno">  357</span>              <span class="keyword">auto</span> id_nds = mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#a8cfebeb2d96199744d0c7de324a0066a">getElementConnectivity</a>(e);</div>
<div class="line"><span class="lineno">  358</span>              <span class="keyword">auto</span> e_nds_start = iNodeStart + mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a> * e;</div>
<div class="line"><span class="lineno">  359</span>              <span class="keyword">auto</span> e_nds_end = e_nds_start + mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#aabc21bd2d84016c386bcd0834f781f61">d_eNumVertex</a>;</div>
<div class="line"><span class="lineno">  360</span>              <span class="comment">//std::vector&lt;util::Point&gt; nds(xRef.begin() + e_nds_start,</span></div>
<div class="line"><span class="lineno">  361</span>              <span class="comment">//                             xRef.begin() + e_nds_end);</span></div>
<div class="line"><span class="lineno">  362</span>              std::vector&lt;util::Point&gt; nds;</div>
<div class="line"><span class="lineno">  363</span>              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;i : id_nds)</div>
<div class="line"><span class="lineno">  364</span>                nds.push_back(xRef[i + iNodeStart]);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>              <span class="keyword">auto</span> qds = elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">getQuadDatas</a>(nds);</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> q=0; q&lt;qds.size(); q++) {</div>
<div class="line"><span class="lineno">  369</span>                ssn = <a class="code hl_struct" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a>();</div>
<div class="line"><span class="lineno">  370</span>                sss = <a class="code hl_struct" href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a>();</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>                <span class="comment">// compute strain</span></div>
<div class="line"><span class="lineno">  373</span>                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; id_nds.size(); i++) {</div>
<div class="line"><span class="lineno">  374</span>                  <span class="keyword">auto</span> i_global_id = iNodeStart + id_nds[i];</div>
<div class="line"><span class="lineno">  375</span>                  <span class="keyword">auto</span> ui = u[i_global_id];</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>                  ssn(0, 0) += ui[0] + qds[q].d_derShapes[i][0];</div>
<div class="line"><span class="lineno">  378</span>                  <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">getDimension</a>() &gt; 1) {</div>
<div class="line"><span class="lineno">  379</span>                    ssn(1, 1) += ui[1] + qds[q].d_derShapes[i][1];</div>
<div class="line"><span class="lineno">  380</span>                    <span class="comment">// xy</span></div>
<div class="line"><span class="lineno">  381</span>                    ssn(0, 1) += 0.5 * ui[0] * qds[q].d_derShapes[i][1] +</div>
<div class="line"><span class="lineno">  382</span>                                 0.5 * ui[1] * qds[q].d_derShapes[i][0];</div>
<div class="line"><span class="lineno">  383</span>                  }</div>
<div class="line"><span class="lineno">  384</span>                  <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">getDimension</a>() &gt; 2) {</div>
<div class="line"><span class="lineno">  385</span>                    ssn(2, 2) += ui[2] + qds[q].d_derShapes[i][2];</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>                    <span class="comment">// yz</span></div>
<div class="line"><span class="lineno">  388</span>                    ssn(1, 2) += 0.5 * ui[1] * qds[q].d_derShapes[i][2] +</div>
<div class="line"><span class="lineno">  389</span>                                 0.5 * ui[2] * qds[q].d_derShapes[i][1];</div>
<div class="line"><span class="lineno">  390</span>                    <span class="comment">// xz</span></div>
<div class="line"><span class="lineno">  391</span>                    ssn(0, 2) += 0.5 * ui[0] * qds[q].d_derShapes[i][2] +</div>
<div class="line"><span class="lineno">  392</span>                                 0.5 * ui[2] * qds[q].d_derShapes[i][0];</div>
<div class="line"><span class="lineno">  393</span>                  }</div>
<div class="line"><span class="lineno">  394</span>                }</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>                <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">getDimension</a>() == 2 &amp;&amp; isPlaneStrain)</div>
<div class="line"><span class="lineno">  397</span>                  ssn(2, 2) = -nu * (ssn(0, 0) + ssn(1, 1)) / (1. - nu);</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>                <span class="comment">// compute stress</span></div>
<div class="line"><span class="lineno">  400</span>                <span class="keywordflow">if</span> (computeStress) {</div>
<div class="line"><span class="lineno">  401</span>                  <span class="keyword">auto</span> trace_ssn = ssn(0, 0) + ssn(1, 1) + ssn(2, 2);</div>
<div class="line"><span class="lineno">  402</span>                  sss(0, 0) = lambda * trace_ssn + 2 * mu * ssn(0, 0);</div>
<div class="line"><span class="lineno">  403</span>                  sss(0, 1) = 2 * mu * ssn(0, 1);</div>
<div class="line"><span class="lineno">  404</span>                  sss(0, 2) = 2 * mu * ssn(0, 2);</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>                  sss(1, 1) = lambda * trace_ssn + 2 * mu * ssn(1, 1);</div>
<div class="line"><span class="lineno">  407</span>                  sss(1, 2) = 2 * mu * ssn(1, 2);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>                  sss(2, 2) = lambda * trace_ssn + 2 * mu * ssn(2, 2);</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>                  <span class="keywordflow">if</span> (mesh_p-&gt;<a class="code hl_function" href="classfe_1_1Mesh.html#ace82526bc83fe9fd574dc5daf2a10433">getDimension</a>() == 2 &amp;&amp; !isPlaneStrain)</div>
<div class="line"><span class="lineno">  412</span>                    sss(2, 2) = nu * (sss(0, 0) + sss(1, 1));</div>
<div class="line"><span class="lineno">  413</span>                }</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>                <span class="comment">// location of this quad points in the vector</span></div>
<div class="line"><span class="lineno">  416</span>                <span class="comment">// is e * getNumQuadPoints() + q, where e is the index of</span></div>
<div class="line"><span class="lineno">  417</span>                <span class="comment">// current element we are processing</span></div>
<div class="line"><span class="lineno">  418</span>                <span class="keyword">auto</span> q_global_id = iStrainStart + e * elem-&gt;<a class="code hl_function" href="classfe_1_1BaseElem.html#a96fb54d9aca45e987c163e95242ceb8f">getNumQuadPoints</a>() + q;</div>
<div class="line"><span class="lineno">  419</span>                strain[q_global_id] = ssn;</div>
<div class="line"><span class="lineno">  420</span>                <span class="keywordflow">if</span> (computeStress)</div>
<div class="line"><span class="lineno">  421</span>                  stress[q_global_id] = sss;</div>
<div class="line"><span class="lineno">  422</span>              }</div>
<div class="line"><span class="lineno">  423</span>          } <span class="comment">// loop over elements</span></div>
<div class="line"><span class="lineno">  424</span>  ); <span class="comment">// for_each</span></div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  executor.run(taskflow).get();</div>
<div class="line"><span class="lineno">  427</span>}</div>
<div class="ttc" id="astructutil_1_1SymMatrix3_html"><div class="ttname"><a href="structutil_1_1SymMatrix3.html">util::SymMatrix3</a></div><div class="ttdoc">A structure to represent 3d matrices.</div><div class="ttdef"><b>Definition</b> <a href="matrix_8h_source.html#l00258">matrix.h:258</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mesh_8h_source.html#l00404">fe::Mesh::d_eNumVertex</a>, <a class="el" href="mesh_8h_source.html#l00082">fe::Mesh::getDimension()</a>, <a class="el" href="mesh_8h_source.html#l00210">fe::Mesh::getElementConnectivity()</a>, <a class="el" href="mesh_8h_source.html#l00106">fe::Mesh::getElementType()</a>, <a class="el" href="parallelUtil_8cpp_source.html#l00116">util::parallel::getNThreads()</a>, <a class="el" href="mesh_8h_source.html#l00094">fe::Mesh::getNumElements()</a>, <a class="el" href="mesh_8h_source.html#l00088">fe::Mesh::getNumNodes()</a>, <a class="el" href="baseElem_8h_source.html#l00111">fe::BaseElem::getNumQuadPoints()</a>, <a class="el" href="classfe_1_1BaseElem.html#a845050a671a67d9dc61d294bd11ef16d">fe::BaseElem::getQuadDatas()</a>, <a class="el" href="function_8cpp_source.html#l00020">util::isLess()</a>, <a class="el" href="feElementDefs_8h_source.html#l00049">util::vtk_type_line</a>, <a class="el" href="feElementDefs_8h_source.html#l00067">util::vtk_type_quad</a>, <a class="el" href="feElementDefs_8h_source.html#l00070">util::vtk_type_tetra</a>, and <a class="el" href="feElementDefs_8h_source.html#l00055">util::vtk_type_triangle</a>.</p>

<p class="reference">Referenced by <a class="el" href="demModel_8cpp_source.html#l01962">model::DEMModel::output()</a>, and <a class="el" href="apps_2twoparticle__demo_2main_8cpp_source.html#l00281">twoparticle_demo::Model::twoParticleTestMaxShearStress()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_a7beb694686b61d7cda5b67aa4bc01104_cgraph.svg" width="410" height="447"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_a7beb694686b61d7cda5b67aa4bc01104_icgraph.svg" width="1184" height="102"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abf9d43e85d09aafbc240f14cd9508ab4" name="abf9d43e85d09aafbc240f14cd9508ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf9d43e85d09aafbc240f14cd9508ab4">&#9670;&#160;</a></span>metisGraphPartition() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fe::metisGraphPartition </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>partitionMethod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodeNeighs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodePartition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nPartitions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes as vertices and edges given by node neighbors. Then the metis function is called to partition the graph into specified number of parts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">partitionMethod</td><td>Method to partition ("metis_recursive" or "metis_kway") </td></tr>
    <tr><td class="paramname">nodeNeighs</td><td>Neighborlist of nodes </td></tr>
    <tr><td class="paramname">nodePartition</td><td>Vector that stores partition number of nodes </td></tr>
    <tr><td class="paramname">nPartitions</td><td>Number of partitions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="meshPartitioning_8cpp_source.html#l00018">18</a> of file <a class="el" href="meshPartitioning_8cpp_source.html">meshPartitioning.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   21</span>                                             {</div>
<div class="line"><span class="lineno">   22</span>  <span class="comment">// record time</span></div>
<div class="line"><span class="lineno">   23</span>  <span class="keyword">auto</span> t1 = steady_clock::now();</div>
<div class="line"><span class="lineno">   24</span>  idx_t nvtxs = nodeNeighs.size();</div>
<div class="line"><span class="lineno">   25</span>  idx_t ncon = 1; <span class="comment">// # of balancing constraints (at least 1)</span></div>
<div class="line"><span class="lineno">   26</span>  idx_t objval;</div>
<div class="line"><span class="lineno">   27</span>  <span class="keywordtype">int</span> metis_return;</div>
<div class="line"><span class="lineno">   28</span>  idx_t nWeights  = 1;</div>
<div class="line"><span class="lineno">   29</span>  std::vector&lt;idx_t&gt; part(nvtxs, 0);</div>
<div class="line"><span class="lineno">   30</span>  std::vector&lt;idx_t&gt; vwgt(nvtxs * nWeights, 0);</div>
<div class="line"><span class="lineno">   31</span>  <span class="keyword">auto</span> nParts = idx_t(nPartitions);</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>  <span class="comment">// create adjacency data based on nodeNeighs</span></div>
<div class="line"><span class="lineno">   34</span>  std::vector&lt;idx_t&gt; xadj(nvtxs, 0);</div>
<div class="line"><span class="lineno">   35</span>  std::vector&lt;idx_t&gt; adjncy;</div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;nvtxs; i++) {</div>
<div class="line"><span class="lineno">   37</span>    adjncy.insert(adjncy.end(), nodeNeighs[i].begin(), nodeNeighs[i].end());</div>
<div class="line"><span class="lineno">   38</span>    xadj[i+1] = xadj[i] + idx_t(nodeNeighs[i].size());</div>
<div class="line"><span class="lineno">   39</span>  }</div>
<div class="line"><span class="lineno">   40</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;adjcny size = {}, xadj[end] = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">   41</span>                           adjncy.size(), xadj[nvtxs]);</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\nmetisGraphPartition():\n&quot;</span>;</div>
<div class="line"><span class="lineno">   44</span>  <span class="keywordflow">if</span> (partitionMethod == <span class="stringliteral">&quot;metis_recursive&quot;</span>) {</div>
<div class="line"><span class="lineno">   45</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;  METIS_PartGraphRecursive partitions a graph into K parts\n&quot;</span>;</div>
<div class="line"><span class="lineno">   46</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;  using multilevel recursive bisection.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    metis_return = METIS_PartGraphRecursive(&amp;nvtxs, &amp;ncon, xadj.data(),</div>
<div class="line"><span class="lineno">   49</span>                                       adjncy.data(), NULL, NULL,</div>
<div class="line"><span class="lineno">   50</span>                                       NULL, &amp;nParts, NULL, NULL, NULL, &amp;objval,</div>
<div class="line"><span class="lineno">   51</span>                                       part.data());</div>
<div class="line"><span class="lineno">   52</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (partitionMethod == <span class="stringliteral">&quot;metis_kway&quot;</span>) {</div>
<div class="line"><span class="lineno">   53</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;  METIS_PartGraphKway partitions a graph into K parts\n&quot;</span>;</div>
<div class="line"><span class="lineno">   54</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;  using multilevel K-way partition.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    metis_return = METIS_PartGraphKway(&amp;nvtxs, &amp;ncon, xadj.data(),</div>
<div class="line"><span class="lineno">   57</span>                                       adjncy.data(), NULL, NULL,</div>
<div class="line"><span class="lineno">   58</span>                                       NULL, &amp;nParts, NULL, NULL, NULL, &amp;objval,</div>
<div class="line"><span class="lineno">   59</span>                                       part.data());</div>
<div class="line"><span class="lineno">   60</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   61</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;Argument partitionMethod = &quot;</span></div>
<div class="line"><span class="lineno">   62</span>              &lt;&lt; partitionMethod &lt;&lt; <span class="stringliteral">&quot; is invalid.\n&quot;</span></div>
<div class="line"><span class="lineno">   63</span>              &lt;&lt; <span class="stringliteral">&quot;Valid values are {&#39;metis_recursive&#39;, &#39;metis_kway&#39;}.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   64</span>    exit(1);</div>
<div class="line"><span class="lineno">   65</span>  }</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <span class="comment">// record time</span></div>
<div class="line"><span class="lineno">   68</span>  <span class="keyword">auto</span> t2 = steady_clock::now();</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;\n  Return code = {}\n&quot;</span></div>
<div class="line"><span class="lineno">   71</span>                           <span class="stringliteral">&quot;  Edge cuts for partition = {}\n&quot;</span></div>
<div class="line"><span class="lineno">   72</span>                           <span class="stringliteral">&quot;  Partition calculation time (ms) = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">   73</span>                           metis_return, (<span class="keywordtype">int</span>) objval,</div>
<div class="line"><span class="lineno">   74</span>                           <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t1, t2, <span class="stringliteral">&quot;microseconds&quot;</span>));</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">// cast the part vector into nodePartition vector</span></div>
<div class="line"><span class="lineno">   77</span>  nodePartition.resize(0);</div>
<div class="line"><span class="lineno">   78</span>  nodePartition.insert(nodePartition.end(), part.begin(), part.end());</div>
<div class="line"><span class="lineno">   79</span>}</div>
<div class="ttc" id="anamespaceutil_1_1methods_html_aaf9cfac99073d034d41e10d4d17e59a2"><div class="ttname"><a href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a></div><div class="ttdeci">float timeDiff(std::chrono::steady_clock::time_point begin, std::chrono::steady_clock::time_point end, std::string unit=&quot;microseconds&quot;)</div><div class="ttdoc">Returns difference between two times.</div><div class="ttdef"><b>Definition</b> <a href="methods_8h_source.html#l00304">methods.h:304</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="methods_8h_source.html#l00304">util::methods::timeDiff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="meshPartitioning_8cpp_source.html#l00081">metisGraphPartition()</a>, <a class="el" href="testMeshPartitioningLib_8cpp_source.html#l00137">test::testGraphPartitioning()</a>, and <a class="el" href="testParallelCompLib_8cpp_source.html#l00285">test::testMPI()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_abf9d43e85d09aafbc240f14cd9508ab4_cgraph.svg" width="366" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_abf9d43e85d09aafbc240f14cd9508ab4_icgraph.svg" width="488" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a5abc576787f51dd3d0322b4d435ccac9" name="a5abc576787f51dd3d0322b4d435ccac9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5abc576787f51dd3d0322b4d435ccac9">&#9670;&#160;</a></span>metisGraphPartition() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fe::metisGraphPartition </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>partitionMethod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfe_1_1Mesh.html">fe::Mesh</a> *&#160;</td>
          <td class="paramname"><em>mesh_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodeNeighs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nPartitions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes as vertices and edges given by node neighbors. Then the metis function is called to partition the graph into specified number of parts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">partitionMethod</td><td>Method to partition ("recursive" or "kway") </td></tr>
    <tr><td class="paramname">mesh_p</td><td>Pointer to mesh </td></tr>
    <tr><td class="paramname">nodeNeighs</td><td>Neighborlist of nodes </td></tr>
    <tr><td class="paramname">nPartitions</td><td>Number of partitions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="meshPartitioning_8cpp_source.html#l00081">81</a> of file <a class="el" href="meshPartitioning_8cpp_source.html">meshPartitioning.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   84</span>                                             {</div>
<div class="line"><span class="lineno">   85</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a2c95789598c8290e9eba9331c9348762">d_nPart</a> = nPartitions;</div>
<div class="line"><span class="lineno">   86</span>  mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a6ce8c95ae8ff2d38638b2592f1167549">d_partitionMethod</a> = partitionMethod;</div>
<div class="line"><span class="lineno">   87</span>  <a class="code hl_function" href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">fe::metisGraphPartition</a>(partitionMethod, nodeNeighs,</div>
<div class="line"><span class="lineno">   88</span>                          mesh_p-&gt;<a class="code hl_variable" href="classfe_1_1Mesh.html#a19c32e94cbb5d5f81130609282fcc749">d_nodePartition</a>, nPartitions);</div>
<div class="line"><span class="lineno">   89</span>}</div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a19c32e94cbb5d5f81130609282fcc749"><div class="ttname"><a href="classfe_1_1Mesh.html#a19c32e94cbb5d5f81130609282fcc749">fe::Mesh::d_nodePartition</a></div><div class="ttdeci">std::vector&lt; size_t &gt; d_nodePartition</div><div class="ttdoc">Node partition information. For each node i, d_nodePartition[i] specifies the partition number,...</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00463">mesh.h:463</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a2c95789598c8290e9eba9331c9348762"><div class="ttname"><a href="classfe_1_1Mesh.html#a2c95789598c8290e9eba9331c9348762">fe::Mesh::d_nPart</a></div><div class="ttdeci">size_t d_nPart</div><div class="ttdoc">Number of partitions.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00449">mesh.h:449</a></div></div>
<div class="ttc" id="aclassfe_1_1Mesh_html_a6ce8c95ae8ff2d38638b2592f1167549"><div class="ttname"><a href="classfe_1_1Mesh.html#a6ce8c95ae8ff2d38638b2592f1167549">fe::Mesh::d_partitionMethod</a></div><div class="ttdeci">std::string d_partitionMethod</div><div class="ttdoc">Partitioning method. It could be either empty string or &quot;metis_recursive&quot; or &quot;metis_kway&quot;.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00454">mesh.h:454</a></div></div>
<div class="ttc" id="anamespacefe_html_abf9d43e85d09aafbc240f14cd9508ab4"><div class="ttname"><a href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">fe::metisGraphPartition</a></div><div class="ttdeci">void metisGraphPartition(std::string partitionMethod, const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;nodeNeighs, std::vector&lt; size_t &gt; &amp;nodePartition, size_t nPartitions)</div><div class="ttdoc">Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes a...</div><div class="ttdef"><b>Definition</b> <a href="meshPartitioning_8cpp_source.html#l00018">meshPartitioning.cpp:18</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="mesh_8h_source.html#l00463">fe::Mesh::d_nodePartition</a>, <a class="el" href="mesh_8h_source.html#l00449">fe::Mesh::d_nPart</a>, <a class="el" href="mesh_8h_source.html#l00454">fe::Mesh::d_partitionMethod</a>, and <a class="el" href="meshPartitioning_8cpp_source.html#l00018">metisGraphPartition()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacefe_a5abc576787f51dd3d0322b4d435ccac9_cgraph.svg" width="570" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefe.html">fe</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

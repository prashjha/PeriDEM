<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeriDEM: test Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="doxy_logo.jpg"/></td>
  <td id="projectalign">
   <div id="projectname">PeriDEM<span id="projectnumber">&#160;0.2.0</span>
   </div>
   <div id="projectbrief">PeriDEM -- Peridynamics-based high-fidelity model for granular media</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacetest.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">test Namespace Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Namespace to group the methods used in testing of the library.  
<a href="namespacetest.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtest_1_1testNSearchData.html">testNSearchData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a437c18b50b59ae2f9cd10e1cb51fba64" id="r_a437c18b50b59ae2f9cd10e1cb51fba64"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a437c18b50b59ae2f9cd10e1cb51fba64">getExactIntegrationRefTri</a> (size_t alpha, size_t beta)</td></tr>
<tr class="memdesc:a437c18b50b59ae2f9cd10e1cb51fba64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes integration of polynomial exactly over reference triangle.  <br /></td></tr>
<tr class="separator:a437c18b50b59ae2f9cd10e1cb51fba64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56b3ad312ab9aaa185b9b1507fbb1a43" id="r_a56b3ad312ab9aaa185b9b1507fbb1a43"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a56b3ad312ab9aaa185b9b1507fbb1a43">getExactIntegrationRefQuad</a> (size_t alpha, size_t beta)</td></tr>
<tr class="memdesc:a56b3ad312ab9aaa185b9b1507fbb1a43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes integration of polynomial exactly over reference quadrangle.  <br /></td></tr>
<tr class="separator:a56b3ad312ab9aaa185b9b1507fbb1a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43e065c49520ee624134a11bdfe3643" id="r_af43e065c49520ee624134a11bdfe3643"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#af43e065c49520ee624134a11bdfe3643">getExactIntegrationRefTet</a> (size_t alpha, size_t beta, size_t theta)</td></tr>
<tr class="memdesc:af43e065c49520ee624134a11bdfe3643"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes integration of polynomial exactly over reference tetrahedral.  <br /></td></tr>
<tr class="separator:af43e065c49520ee624134a11bdfe3643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d761477bf0e6293198849c53cb8abc" id="r_a44d761477bf0e6293198849c53cb8abc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a44d761477bf0e6293198849c53cb8abc">getNChooseR</a> (size_t n, size_t r)</td></tr>
<tr class="memdesc:a44d761477bf0e6293198849c53cb8abc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes \( {n\choose r}\) "n choose r".  <br /></td></tr>
<tr class="separator:a44d761477bf0e6293198849c53cb8abc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660d2aaf0e814e7872c35d9f24d45420" id="r_a660d2aaf0e814e7872c35d9f24d45420"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a660d2aaf0e814e7872c35d9f24d45420">testGraphPartitioningSimple</a> ()</td></tr>
<tr class="memdesc:a660d2aaf0e814e7872c35d9f24d45420"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests metis partitioning of graph.  <br /></td></tr>
<tr class="separator:a660d2aaf0e814e7872c35d9f24d45420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6934db7b63923b70a56ab8e9c7159202" id="r_a6934db7b63923b70a56ab8e9c7159202"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a6934db7b63923b70a56ab8e9c7159202">testGraphPartitioning</a> (size_t nPart=4, size_t nGrid=10, size_t mHorizon=3, size_t testOption=0, std::string meshFilename=&quot;&quot;)</td></tr>
<tr class="memdesc:a6934db7b63923b70a56ab8e9c7159202"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests metis partitioning of graph from a 2-D mesh with nonlocal interaction.  <br /></td></tr>
<tr class="separator:a6934db7b63923b70a56ab8e9c7159202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a473c5d8b21be56b653930316d33eb743" id="r_a473c5d8b21be56b653930316d33eb743"><td class="memTemplParams" colspan="2">template&lt;int dim = 3&gt; </td></tr>
<tr class="memitem:a473c5d8b21be56b653930316d33eb743"><td class="memTemplItemLeft" align="right" valign="top">std::string&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a473c5d8b21be56b653930316d33eb743">testNanoflann</a> (size_t N, double L, double dL, int seed)</td></tr>
<tr class="memdesc:a473c5d8b21be56b653930316d33eb743"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on nsearch.  <br /></td></tr>
<tr class="separator:a473c5d8b21be56b653930316d33eb743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a197262de1745b522497c1d1e58066215" id="r_a197262de1745b522497c1d1e58066215"><td class="memTemplParams" colspan="2">template&lt;int dim = 3&gt; </td></tr>
<tr class="memitem:a197262de1745b522497c1d1e58066215"><td class="memTemplItemLeft" align="right" valign="top">std::string&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacetest.html#a197262de1745b522497c1d1e58066215">testNanoflannExcludeInclude</a> (size_t N, double L, double dL, int seed, <a class="el" href="structtest_1_1testNSearchData.html">testNSearchData</a> &amp;data)</td></tr>
<tr class="memdesc:a197262de1745b522497c1d1e58066215"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on nsearch.  <br /></td></tr>
<tr class="separator:a197262de1745b522497c1d1e58066215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2abf679a9141e85f146ee0a27d7d4a76" id="r_a2abf679a9141e85f146ee0a27d7d4a76"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a2abf679a9141e85f146ee0a27d7d4a76">testNanoflannClosestPoint</a> (size_t N, double L, double dL, int seed)</td></tr>
<tr class="memdesc:a2abf679a9141e85f146ee0a27d7d4a76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on nsearch.  <br /></td></tr>
<tr class="separator:a2abf679a9141e85f146ee0a27d7d4a76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42bc7bd3da5dce5ed3624b8fca7585f" id="r_ad42bc7bd3da5dce5ed3624b8fca7585f"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#ad42bc7bd3da5dce5ed3624b8fca7585f">testTaskflow</a> (size_t N, int seed)</td></tr>
<tr class="memdesc:ad42bc7bd3da5dce5ed3624b8fca7585f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on taskflow.  <br /></td></tr>
<tr class="separator:ad42bc7bd3da5dce5ed3624b8fca7585f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0964e1ea010ded3d98df70e7d5326ca" id="r_af0964e1ea010ded3d98df70e7d5326ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#af0964e1ea010ded3d98df70e7d5326ca">testMPI</a> (size_t nGrid=10, size_t mHorizon=3, size_t testOption=0, std::string meshFilename=&quot;&quot;)</td></tr>
<tr class="memdesc:af0964e1ea010ded3d98df70e7d5326ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform parallelization test using MPI on mesh partition based on metis.  <br /></td></tr>
<tr class="separator:af0964e1ea010ded3d98df70e7d5326ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad46ca3f06841d1eebe364386b4bf889d" id="r_ad46ca3f06841d1eebe364386b4bf889d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#ad46ca3f06841d1eebe364386b4bf889d">testTransform</a> ()</td></tr>
<tr class="memdesc:ad46ca3f06841d1eebe364386b4bf889d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on Fracture class and check if bitwise functions are working correctly.  <br /></td></tr>
<tr class="separator:ad46ca3f06841d1eebe364386b4bf889d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae165316fc718590c70e7cdc08a093568" id="r_ae165316fc718590c70e7cdc08a093568"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#ae165316fc718590c70e7cdc08a093568">testPeriDEM</a> (std::string filepath)</td></tr>
<tr class="memdesc:ae165316fc718590c70e7cdc08a093568"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests PeriDEM model class.  <br /></td></tr>
<tr class="separator:ae165316fc718590c70e7cdc08a093568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c8cad23ca76bc12534c5487df9a25f" id="r_ad3c8cad23ca76bc12534c5487df9a25f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#ad3c8cad23ca76bc12534c5487df9a25f">testUtilMethods</a> ()</td></tr>
<tr class="memdesc:ad3c8cad23ca76bc12534c5487df9a25f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test methods <br  />
  <br /></td></tr>
<tr class="separator:ad3c8cad23ca76bc12534c5487df9a25f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr class="memitem:a9c70e062f4058ee8d6403002a8b3b3ea" id="r_a9c70e062f4058ee8d6403002a8b3b3ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a9c70e062f4058ee8d6403002a8b3b3ea">testLineElem</a> (size_t n, std::string filepath)</td></tr>
<tr class="memdesc:a9c70e062f4058ee8d6403002a8b3b3ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on quadrature points on line elements (NOT IMPLEMENTED)  <br /></td></tr>
<tr class="separator:a9c70e062f4058ee8d6403002a8b3b3ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af81978a4250caac290f7d52c1e571f04" id="r_af81978a4250caac290f7d52c1e571f04"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#af81978a4250caac290f7d52c1e571f04">testTriElem</a> (size_t n, std::string filepath)</td></tr>
<tr class="memdesc:af81978a4250caac290f7d52c1e571f04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on quadrature points on triangle elements.  <br /></td></tr>
<tr class="separator:af81978a4250caac290f7d52c1e571f04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82d825f0f2554452df66da03aee4a65" id="r_aa82d825f0f2554452df66da03aee4a65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#aa82d825f0f2554452df66da03aee4a65">testQuadElem</a> (size_t n, std::string filepath)</td></tr>
<tr class="memdesc:aa82d825f0f2554452df66da03aee4a65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on quadrature points on quadrangle elements.  <br /></td></tr>
<tr class="separator:aa82d825f0f2554452df66da03aee4a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c71a77ba3a1a442ebad77cbb0bc242" id="r_aa7c71a77ba3a1a442ebad77cbb0bc242"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#aa7c71a77ba3a1a442ebad77cbb0bc242">testTetElem</a> (size_t n, std::string filepath)</td></tr>
<tr class="memdesc:aa7c71a77ba3a1a442ebad77cbb0bc242"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform test on quadrature points on tetrahedral elements.  <br /></td></tr>
<tr class="separator:aa7c71a77ba3a1a442ebad77cbb0bc242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a239356235900cd3a9790293c6d49b357" id="r_a239356235900cd3a9790293c6d49b357"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetest.html#a239356235900cd3a9790293c6d49b357">testTriElemTime</a> (size_t n, size_t N)</td></tr>
<tr class="memdesc:a239356235900cd3a9790293c6d49b357"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the time needed when quad data for elements are stored and when they are computed as and when needed.  <br /></td></tr>
<tr class="separator:a239356235900cd3a9790293c6d49b357"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Namespace to group the methods used in testing of the library. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a56b3ad312ab9aaa185b9b1507fbb1a43" name="a56b3ad312ab9aaa185b9b1507fbb1a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56b3ad312ab9aaa185b9b1507fbb1a43">&#9670;&#160;</a></span>getExactIntegrationRefQuad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double test::getExactIntegrationRefQuad </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes integration of polynomial exactly over reference quadrangle. </p>
<p>Given \( f(s,t) = s^\alpha\, t^\beta \), the exact integration is given by </p><p class="formulaDsp">
\[ I_{exact} = \int_0^1 \int_0^{1-s} s^\alpha\, t^\beta \, dt\, ds. \]
</p>
<p>If either \( \alpha\) or \( \beta\) are odd number then \( I_{exact}
= 0\). Otherwise, \( I_{exact} = \frac{4}{(\alpha +1) (\beta+1)} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>Polynomial order in variable s </td></tr>
    <tr><td class="paramname">beta</td><td>Polynomial order in variable t </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>I Exact integration of \( f(s,t) = s^\alpha\, t^\beta \) </dd></dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00163">163</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  163</span>                                                                 {</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// compute exact integration of s^\alpha t^\beta</span></div>
<div class="line"><span class="lineno">  166</span>  <span class="keywordflow">if</span> (alpha % 2 == 0 and beta % 2 == 0)</div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">return</span> 4. / double((alpha + 1) * (beta + 1));</div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  170</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="testFeLib_8cpp_source.html#l00353">testQuadElem()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a56b3ad312ab9aaa185b9b1507fbb1a43_icgraph.svg" width="458" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af43e065c49520ee624134a11bdfe3643" name="af43e065c49520ee624134a11bdfe3643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af43e065c49520ee624134a11bdfe3643">&#9670;&#160;</a></span>getExactIntegrationRefTet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double test::getExactIntegrationRefTet </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes integration of polynomial exactly over reference tetrahedral. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>Polynomial order in variable s </td></tr>
    <tr><td class="paramname">beta</td><td>Polynomial order in variable t </td></tr>
    <tr><td class="paramname">theta</td><td>Polynomial order in variable r </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>I Exact integration of \( f(s,t) = s^\alpha\, t^\beta \, r^\theta
\) </dd></dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00172">172</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  173</span>                                                     {</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <span class="keywordtype">double</span> I = 0.;</div>
<div class="line"><span class="lineno">  176</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= theta + 1; i++) {</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordtype">double</span> factor_i = <a class="code hl_function" href="namespacetest.html#a44d761477bf0e6293198849c53cb8abc">test::getNChooseR</a>(theta + 1, i) /</div>
<div class="line"><span class="lineno">  179</span>                      (double(theta + 1) * double(i + beta + 1));</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> (i % 2 != 0)</div>
<div class="line"><span class="lineno">  181</span>      factor_i = factor_i * (-1.);</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= theta + beta + 2 + 1; j++) {</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>      <span class="keywordtype">double</span> factor_j =</div>
<div class="line"><span class="lineno">  186</span>          <a class="code hl_function" href="namespacetest.html#a44d761477bf0e6293198849c53cb8abc">test::getNChooseR</a>(theta + beta + 2, j) / (double(j + alpha + 1));</div>
<div class="line"><span class="lineno">  187</span>      <span class="keywordflow">if</span> (j % 2 != 0)</div>
<div class="line"><span class="lineno">  188</span>        factor_j = factor_j * (-1.);</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>      I += factor_i * factor_j;</div>
<div class="line"><span class="lineno">  191</span>    }</div>
<div class="line"><span class="lineno">  192</span>  }</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  <span class="keywordflow">return</span> I;</div>
<div class="line"><span class="lineno">  195</span>}</div>
<div class="ttc" id="anamespacetest_html_a44d761477bf0e6293198849c53cb8abc"><div class="ttname"><a href="namespacetest.html#a44d761477bf0e6293198849c53cb8abc">test::getNChooseR</a></div><div class="ttdeci">double getNChooseR(size_t n, size_t r)</div><div class="ttdoc">Computes  &quot;n choose r&quot;.</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00135">testFeLib.cpp:135</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testFeLib_8cpp_source.html#l00135">getNChooseR()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testFeLib_8cpp_source.html#l00577">testTetElem()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_af43e065c49520ee624134a11bdfe3643_cgraph.svg" width="359" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_af43e065c49520ee624134a11bdfe3643_icgraph.svg" width="446" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a437c18b50b59ae2f9cd10e1cb51fba64" name="a437c18b50b59ae2f9cd10e1cb51fba64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a437c18b50b59ae2f9cd10e1cb51fba64">&#9670;&#160;</a></span>getExactIntegrationRefTri()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double test::getExactIntegrationRefTri </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes integration of polynomial exactly over reference triangle. </p>
<p>Given \( f(s,t) = s^\alpha\, t^\beta \), the exact integration is given by  </p><p class="formulaDsp">
\[ I_{exact} = \int_0^1 \int_0^{1-s} s^\alpha\, t^\beta \, dt\, ds =
\sum_{i=0}^{\beta+1} (-1)^i \frac{{{\beta + 1} \choose i}}{(\alpha + i +1)
(\beta + 1)}, \]
</p>
<p> where </p><p class="formulaDsp">
\[ {a \choose b} = \frac{a (a-1) (a-2) ... (a-b+1)}{1*2*3 ... *b}. \]
</p>
<p> We have \( {a \choose 0} = 1 \) so that term for \( i=0\) is not zero. Above formula gives the exact value of integral of \( f(s,t) = s^\alpha\, t^\beta \) over reference triangle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">alpha</td><td>Polynomial order in variable s </td></tr>
    <tr><td class="paramname">beta</td><td>Polynomial order in variable t </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>I Exact integration of \( f(s,t) = s^\alpha\, t^\beta \) </dd></dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00147">147</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  147</span>                                                                {</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <span class="comment">// compute exact integration of s^\alpha t^\beta</span></div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordtype">double</span> I = 0.;</div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt;= beta + 1; k++) {</div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">if</span> (k % 2 == 0)</div>
<div class="line"><span class="lineno">  153</span>      I +=</div>
<div class="line"><span class="lineno">  154</span>          <a class="code hl_function" href="namespacetest.html#a44d761477bf0e6293198849c53cb8abc">test::getNChooseR</a>(beta + 1, k) / double((alpha + 1 + k) * (beta + 1));</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  156</span>      I -=</div>
<div class="line"><span class="lineno">  157</span>          <a class="code hl_function" href="namespacetest.html#a44d761477bf0e6293198849c53cb8abc">test::getNChooseR</a>(beta + 1, k) / double((alpha + 1 + k) * (beta + 1));</div>
<div class="line"><span class="lineno">  158</span>  }</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>  <span class="keywordflow">return</span> I;</div>
<div class="line"><span class="lineno">  161</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testFeLib_8cpp_source.html#l00135">getNChooseR()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testFeLib_8cpp_source.html#l00200">testTriElem()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a437c18b50b59ae2f9cd10e1cb51fba64_cgraph.svg" width="359" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a437c18b50b59ae2f9cd10e1cb51fba64_icgraph.svg" width="442" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a44d761477bf0e6293198849c53cb8abc" name="a44d761477bf0e6293198849c53cb8abc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44d761477bf0e6293198849c53cb8abc">&#9670;&#160;</a></span>getNChooseR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double test::getNChooseR </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes \( {n\choose r}\) "n choose r". </p>
<p>Computes formula </p><p class="formulaDsp">
\[ {a \choose b} = \frac{a (a-1) (a-2) ... (a-b+1)}{1*2*3
... *b}. \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number </td></tr>
    <tr><td class="paramname">r</td><td>Number which is smaller or equal to n </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value Value of "n choose r" </dd></dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00135">135</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  135</span>                                           {</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="keywordflow">if</span> (r == 0)</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">return</span> 1.;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordtype">double</span> a = 1.;</div>
<div class="line"><span class="lineno">  141</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt;= r; i++)</div>
<div class="line"><span class="lineno">  142</span>    a *= <span class="keywordtype">double</span>(n - i + 1) / double(i);</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">return</span> a;</div>
<div class="line"><span class="lineno">  145</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="testFeLib_8cpp_source.html#l00172">getExactIntegrationRefTet()</a>, and <a class="el" href="testFeLib_8cpp_source.html#l00147">getExactIntegrationRefTri()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a44d761477bf0e6293198849c53cb8abc_icgraph.svg" width="628" height="115"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6934db7b63923b70a56ab8e9c7159202" name="a6934db7b63923b70a56ab8e9c7159202"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6934db7b63923b70a56ab8e9c7159202">&#9670;&#160;</a></span>testGraphPartitioning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testGraphPartitioning </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nPart</em> = <code>4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nGrid</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mHorizon</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>testOption</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>meshFilename</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests metis partitioning of graph from a 2-D mesh with nonlocal interaction. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nPart</td><td>Number of partitions </td></tr>
    <tr><td class="paramname">nGrid</td><td>Number of element along a line (total number of elements is N*N) </td></tr>
    <tr><td class="paramname">mHorizon</td><td>Integer factor that is used to compute nonlocal radius, i.e., horizon (epsilon = m * h, h being mesh size) </td></tr>
    <tr><td class="paramname">testOption</td><td>Test otion flag. 0 - use in-built uniform mesh, 1 - use user-specified mesh </td></tr>
    <tr><td class="paramname">meshFilename</td><td>Mesh filename with relative path from the directory where test command is run </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testMeshPartitioningLib_8cpp_source.html#l00137">137</a> of file <a class="el" href="testMeshPartitioningLib_8cpp_source.html">testMeshPartitioningLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\nMETIS_TEST\n&quot;</span>;</div>
<div class="line"><span class="lineno">  140</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\n  Test the METIS library for graph partitioning for realistic mesh with nonlocal interaction.\n&quot;</span> ;</div>
<div class="line"><span class="lineno">  141</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;\n  Arguments: nPart = {}, nGrid = {}, mHorizon = {}\n&quot;</span>, nPart, nGrid, mHorizon);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="comment">// create uniform mesh on domain [0, Lx]x[0, Ly]</span></div>
<div class="line"><span class="lineno">  144</span>  <span class="keyword">auto</span> t1 = steady_clock::now();</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <span class="comment">// empty mesh object</span></div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordtype">size_t</span> dim(2);</div>
<div class="line"><span class="lineno">  148</span>  <span class="keyword">auto</span> mesh = <a class="code hl_class" href="classfe_1_1Mesh.html">fe::Mesh</a>(dim);</div>
<div class="line"><span class="lineno">  149</span>  mesh.d_spatialDiscretization = <span class="stringliteral">&quot;finite_difference&quot;</span>;</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  <span class="comment">// create mesh</span></div>
<div class="line"><span class="lineno">  152</span>  std::string outMeshFilename = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">if</span> (testOption == 1) {</div>
<div class="line"><span class="lineno">  154</span>    <span class="comment">// set geometry details</span></div>
<div class="line"><span class="lineno">  155</span>    std::pair&lt;std::vector&lt;double&gt;, std::vector&lt;double&gt;&gt; box;</div>
<div class="line"><span class="lineno">  156</span>    std::vector&lt;size_t&gt; nGridVec;</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;dim; i++) {</div>
<div class="line"><span class="lineno">  158</span>      box.first.push_back(0.);</div>
<div class="line"><span class="lineno">  159</span>      box.second.push_back(1.);</div>
<div class="line"><span class="lineno">  160</span>      nGridVec.push_back(nGrid);</div>
<div class="line"><span class="lineno">  161</span>    }</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// call utility function to create mesh</span></div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_function" href="namespacefe.html#abe6bbc09314c74619abaa8c13f489335">fe::createUniformMesh</a>(&amp;mesh, dim, box, nGridVec);</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>    <span class="comment">// filename for outputting</span></div>
<div class="line"><span class="lineno">  167</span>    outMeshFilename = fmt::format(<span class="stringliteral">&quot;uniform_mesh_Lx_{}_Ly_{}_Nx_{}_Ny_{}&quot;</span>,</div>
<div class="line"><span class="lineno">  168</span>                                               box.second[0], box.second[1],</div>
<div class="line"><span class="lineno">  169</span>                                               nGridVec[0], nGridVec[1]);</div>
<div class="line"><span class="lineno">  170</span>  }</div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (testOption == 2) {</div>
<div class="line"><span class="lineno">  172</span>    <span class="keywordflow">if</span> (meshFilename.empty()) {</div>
<div class="line"><span class="lineno">  173</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;testGraphPartitioning(): mesh filename is empty.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  174</span>      exit(1);</div>
<div class="line"><span class="lineno">  175</span>    }</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">// call in-built function of mesh to create data from file</span></div>
<div class="line"><span class="lineno">  178</span>    mesh.createData(meshFilename);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="comment">// find the name of mesh file without path and without extension (i.e., remove .vtu/.msh/.csv extension)</span></div>
<div class="line"><span class="lineno">  181</span>    <span class="keyword">auto</span> <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a0dc86d40c3cdcb2716b64409b35fe083">f1</a> = <a class="code hl_function" href="namespaceutil_1_1io.html#af88549ade477a5034a8f720753d9f2f9">util::io::getFilenameFromPath</a>(meshFilename);</div>
<div class="line"><span class="lineno">  182</span>    outMeshFilename = <a class="code hl_function" href="namespaceutil_1_1io.html#ab41cbd366c1550587cc6d0bf1a088c5a">util::io::removeExtensionFromFile</a>(f1);</div>
<div class="line"><span class="lineno">  183</span>  }</div>
<div class="line"><span class="lineno">  184</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  185</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;testGraphPartitioning() accepts either 0 or 1 for testOption. The value &quot;</span></div>
<div class="line"><span class="lineno">  186</span>              &lt;&lt; testOption &lt;&lt; <span class="stringliteral">&quot; is invalid.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  187</span>    exit(1);</div>
<div class="line"><span class="lineno">  188</span>  }</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>  <span class="comment">// set nonlocal lengthscale</span></div>
<div class="line"><span class="lineno">  191</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceparticle__wall.html#aa08c5c90a5cffb178f26216ae2205144">horizon</a> = mHorizon*mesh.d_h;</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  <span class="comment">// print mesh data and write mesh to a file</span></div>
<div class="line"><span class="lineno">  194</span>  std::ostringstream msg;</div>
<div class="line"><span class="lineno">  195</span>  msg &lt;&lt; mesh.printStr();</div>
<div class="line"><span class="lineno">  196</span>  std::cout &lt;&lt; msg.str();</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <span class="keyword">auto</span> t2 = steady_clock::now();</div>
<div class="line"><span class="lineno">  199</span>  <span class="keyword">auto</span> setup_time = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t1, t2, <span class="stringliteral">&quot;microseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  200</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;Setup time (ms) = {}. \n&quot;</span>, setup_time);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  <span class="comment">// create neighborhood of each node (to be used in metis partitioning of the graph)</span></div>
<div class="line"><span class="lineno">  203</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; nodeNeighs(mesh.d_numNodes);</div>
<div class="line"><span class="lineno">  204</span>  <a class="code hl_function" href="namespacegeometry.html#aa6be622d915e92b3547e0dbb35c4b156">geometry::computeNonlocalNeighborhood</a>(mesh.d_nodes, horizon, nodeNeighs);</div>
<div class="line"><span class="lineno">  205</span>  <span class="keyword">auto</span> t3 = steady_clock::now();</div>
<div class="line"><span class="lineno">  206</span>  <span class="keyword">auto</span> neigh_time = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t2, t3, <span class="stringliteral">&quot;microseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  207</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;Neighborhood calculation time (ms) = {}.\n&quot;</span>, neigh_time);</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>  <span class="comment">// at this stage, we have mesh and nonlocal neighborhood</span></div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// we are ready to cast the nonlocal neighborhood into graph and call metis for partitioning of nodes</span></div>
<div class="line"><span class="lineno">  211</span>  std::vector&lt;size_t&gt; nodePartitionRecursive(mesh.d_numNodes, 0);</div>
<div class="line"><span class="lineno">  212</span>  std::vector&lt;size_t&gt; nodePartitionKWay(mesh.d_numNodes, 0);</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="comment">// recursive method</span></div>
<div class="line"><span class="lineno">  215</span>  <span class="keyword">auto</span> t4 = steady_clock::now();</div>
<div class="line"><span class="lineno">  216</span>  <a class="code hl_function" href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">fe::metisGraphPartition</a>(<span class="stringliteral">&quot;metis_recursive&quot;</span>, nodeNeighs, nodePartitionRecursive, nPart);</div>
<div class="line"><span class="lineno">  217</span>  <span class="keyword">auto</span> t5 = steady_clock::now();</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">// K-way method</span></div>
<div class="line"><span class="lineno">  220</span>  <a class="code hl_function" href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">fe::metisGraphPartition</a>(<span class="stringliteral">&quot;metis_kway&quot;</span>, nodeNeighs, nodePartitionKWay, nPart);</div>
<div class="line"><span class="lineno">  221</span>  <span class="keyword">auto</span> t6 = steady_clock::now();</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>  <span class="keyword">auto</span> partition_recursive_time = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t4, t5, <span class="stringliteral">&quot;microseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  224</span>  <span class="keyword">auto</span> partition_kway_time = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t5, t6, <span class="stringliteral">&quot;microseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  225</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;Partition (Recursive) calculation time (ms) = {}.\n&quot;</span>, partition_recursive_time);</div>
<div class="line"><span class="lineno">  226</span>  std::cout &lt;&lt; fmt::format(<span class="stringliteral">&quot;Partition (KWay) calculation time (ms) = {}.\n&quot;</span>, partition_kway_time);</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>  <span class="comment">// write data to file</span></div>
<div class="line"><span class="lineno">  229</span>  outMeshFilename = outMeshFilename + fmt::format(<span class="stringliteral">&quot;_mHorizon_{}_nPart_{}&quot;</span>, mHorizon, nPart);</div>
<div class="line"><span class="lineno">  230</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;out mesh filename = &quot;</span> &lt;&lt; outMeshFilename &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  231</span>  <span class="keyword">auto</span> writer = <a class="code hl_class" href="classrw_1_1writer_1_1Writer.html">rw::writer::Writer</a>(outMeshFilename, <span class="stringliteral">&quot;vtu&quot;</span>);</div>
<div class="line"><span class="lineno">  232</span>  writer.appendMesh(&amp;mesh.d_nodes, mesh.d_eType, &amp;mesh.d_enc);</div>
<div class="line"><span class="lineno">  233</span>  writer.appendPointData(<span class="stringliteral">&quot;Nodal_Volume&quot;</span>, &amp;mesh.d_vol);</div>
<div class="line"><span class="lineno">  234</span>  writer.appendPointData(<span class="stringliteral">&quot;Nodal_Partition_Metis_Recursive_Index&quot;</span>, &amp;nodePartitionRecursive);</div>
<div class="line"><span class="lineno">  235</span>  writer.appendPointData(<span class="stringliteral">&quot;Nodal_Partition_Metis_KWay_Index&quot;</span>, &amp;nodePartitionKWay);</div>
<div class="line"><span class="lineno">  236</span>  writer.close();</div>
<div class="line"><span class="lineno">  237</span>}</div>
<div class="ttc" id="aclassfe_1_1Mesh_html"><div class="ttname"><a href="classfe_1_1Mesh.html">fe::Mesh</a></div><div class="ttdoc">A class for mesh data.</div><div class="ttdef"><b>Definition</b> <a href="mesh_8h_source.html#l00051">mesh.h:51</a></div></div>
<div class="ttc" id="aclassrw_1_1writer_1_1Writer_html"><div class="ttname"><a href="classrw_1_1writer_1_1Writer.html">rw::writer::Writer</a></div><div class="ttdoc">A interface class writing data.</div><div class="ttdef"><b>Definition</b> <a href="writer_8h_source.html#l00044">writer.h:44</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testParallelCompLib_8cpp_03_html_a0dc86d40c3cdcb2716b64409b35fe083"><div class="ttname"><a href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a0dc86d40c3cdcb2716b64409b35fe083">anonymous_namespace{testParallelCompLib.cpp}::f1</a></div><div class="ttdeci">double f1(const double &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="testParallelCompLib_8cpp_source.html#l00045">testParallelCompLib.cpp:45</a></div></div>
<div class="ttc" id="anamespacefe_html_abe6bbc09314c74619abaa8c13f489335"><div class="ttname"><a href="namespacefe.html#abe6bbc09314c74619abaa8c13f489335">fe::createUniformMesh</a></div><div class="ttdeci">void createUniformMesh(fe::Mesh *mesh_p, size_t dim, std::pair&lt; std::vector&lt; double &gt;, std::vector&lt; double &gt; &gt; box, std::vector&lt; size_t &gt; nGrid)</div><div class="ttdoc">Creates uniform mesh for rectangle/cuboid domain.</div><div class="ttdef"><b>Definition</b> <a href="meshUtil_8cpp_source.html#l00023">meshUtil.cpp:23</a></div></div>
<div class="ttc" id="anamespacefe_html_abf9d43e85d09aafbc240f14cd9508ab4"><div class="ttname"><a href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">fe::metisGraphPartition</a></div><div class="ttdeci">void metisGraphPartition(std::string partitionMethod, const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;nodeNeighs, std::vector&lt; size_t &gt; &amp;nodePartition, size_t nPartitions)</div><div class="ttdoc">Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes a...</div><div class="ttdef"><b>Definition</b> <a href="meshPartitioning_8cpp_source.html#l00018">meshPartitioning.cpp:18</a></div></div>
<div class="ttc" id="anamespacegeometry_html_aa6be622d915e92b3547e0dbb35c4b156"><div class="ttname"><a href="namespacegeometry.html#aa6be622d915e92b3547e0dbb35c4b156">geometry::computeNonlocalNeighborhood</a></div><div class="ttdeci">void computeNonlocalNeighborhood(const std::vector&lt; util::Point &gt; &amp;nodes, double horizon, std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;nodeNeighs)</div><div class="ttdoc">Partitions the nodes based on node neighborlist supplied. Function first creates a graph with nodes a...</div><div class="ttdef"><b>Definition</b> <a href="geometryUtil_8cpp_source.html#l00017">geometryUtil.cpp:17</a></div></div>
<div class="ttc" id="anamespaceparticle__wall_html_aa08c5c90a5cffb178f26216ae2205144"><div class="ttname"><a href="namespaceparticle__wall.html#aa08c5c90a5cffb178f26216ae2205144">particle_wall.horizon</a></div><div class="ttdeci">int horizon</div><div class="ttdoc">peridynamics horizon (typically taken as 2 to 4 times the mesh size)</div><div class="ttdef"><b>Definition</b> <a href="particle__wall_8py_source.html#l00066">particle_wall.py:66</a></div></div>
<div class="ttc" id="anamespaceutil_1_1io_html_ab41cbd366c1550587cc6d0bf1a088c5a"><div class="ttname"><a href="namespaceutil_1_1io.html#ab41cbd366c1550587cc6d0bf1a088c5a">util::io::removeExtensionFromFile</a></div><div class="ttdeci">std::string removeExtensionFromFile(std::string const &amp;filename)</div><div class="ttdoc">Remove extension from the filename Source - https://stackoverflow.com/a/24386991.</div><div class="ttdef"><b>Definition</b> <a href="io_8h_source.html#l00416">io.h:416</a></div></div>
<div class="ttc" id="anamespaceutil_1_1io_html_af88549ade477a5034a8f720753d9f2f9"><div class="ttname"><a href="namespaceutil_1_1io.html#af88549ade477a5034a8f720753d9f2f9">util::io::getFilenameFromPath</a></div><div class="ttdeci">std::string getFilenameFromPath(std::string const &amp;path, std::string const &amp;delims=&quot;/\\&quot;)</div><div class="ttdoc">Get filename removing path from the string Source - https://stackoverflow.com/a/24386991.</div><div class="ttdef"><b>Definition</b> <a href="io_8h_source.html#l00404">io.h:404</a></div></div>
<div class="ttc" id="anamespaceutil_1_1methods_html_aaf9cfac99073d034d41e10d4d17e59a2"><div class="ttname"><a href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a></div><div class="ttdeci">float timeDiff(std::chrono::steady_clock::time_point begin, std::chrono::steady_clock::time_point end, std::string unit=&quot;microseconds&quot;)</div><div class="ttdoc">Returns difference between two times.</div><div class="ttdef"><b>Definition</b> <a href="methods_8h_source.html#l00304">methods.h:304</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="geometryUtil_8cpp_source.html#l00017">geometry::computeNonlocalNeighborhood()</a>, <a class="el" href="meshUtil_8cpp_source.html#l00023">fe::createUniformMesh()</a>, <a class="el" href="io_8h_source.html#l00404">util::io::getFilenameFromPath()</a>, <a class="el" href="meshPartitioning_8cpp_source.html#l00018">fe::metisGraphPartition()</a>, <a class="el" href="io_8h_source.html#l00416">util::io::removeExtensionFromFile()</a>, and <a class="el" href="methods_8h_source.html#l00304">util::methods::timeDiff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testMeshPartitioning_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a6934db7b63923b70a56ab8e9c7159202_cgraph.svg" width="626" height="315"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a6934db7b63923b70a56ab8e9c7159202_icgraph.svg" width="284" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a660d2aaf0e814e7872c35d9f24d45420" name="a660d2aaf0e814e7872c35d9f24d45420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a660d2aaf0e814e7872c35d9f24d45420">&#9670;&#160;</a></span>testGraphPartitioningSimple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testGraphPartitioningSimple </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests metis partitioning of graph. </p>

<p class="definition">Definition at line <a class="el" href="testMeshPartitioningLib_8cpp_source.html#l00126">126</a> of file <a class="el" href="testMeshPartitioningLib_8cpp_source.html">testMeshPartitioningLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  126</span>                                       {</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  129</span>  printf(<span class="stringliteral">&quot;METIS_TEST\n&quot;</span>);</div>
<div class="line"><span class="lineno">  130</span>  printf(<span class="stringliteral">&quot;  Test the METIS library for graph partitioning (simple).\n&quot;</span>);</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  <span class="comment">// perform basic test that shows metis is linked correctly with the code</span></div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testMeshPartitioningLib_8cpp_03.html#a2534f947d874b5c34db52830c1c2b1e5">partGraphKwayTestSimple</a>();</div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testMeshPartitioningLib_8cpp_03.html#af1b259bd23e4fa00d3e3dabe7e661207">partGraphRecursiveTestSimple</a>();</div>
<div class="line"><span class="lineno">  135</span>}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02testMeshPartitioningLib_8cpp_03_html_a2534f947d874b5c34db52830c1c2b1e5"><div class="ttname"><a href="namespaceanonymous__namespace_02testMeshPartitioningLib_8cpp_03.html#a2534f947d874b5c34db52830c1c2b1e5">anonymous_namespace{testMeshPartitioningLib.cpp}::partGraphKwayTestSimple</a></div><div class="ttdeci">void partGraphKwayTestSimple()</div><div class="ttdef"><b>Definition</b> <a href="testMeshPartitioningLib_8cpp_source.html#l00078">testMeshPartitioningLib.cpp:78</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testMeshPartitioningLib_8cpp_03_html_af1b259bd23e4fa00d3e3dabe7e661207"><div class="ttname"><a href="namespaceanonymous__namespace_02testMeshPartitioningLib_8cpp_03.html#af1b259bd23e4fa00d3e3dabe7e661207">anonymous_namespace{testMeshPartitioningLib.cpp}::partGraphRecursiveTestSimple</a></div><div class="ttdeci">void partGraphRecursiveTestSimple()</div><div class="ttdef"><b>Definition</b> <a href="testMeshPartitioningLib_8cpp_source.html#l00031">testMeshPartitioningLib.cpp:31</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testMeshPartitioningLib_8cpp_source.html#l00078">anonymous_namespace{testMeshPartitioningLib.cpp}::partGraphKwayTestSimple()</a>, and <a class="el" href="testMeshPartitioningLib_8cpp_source.html#l00031">anonymous_namespace{testMeshPartitioningLib.cpp}::partGraphRecursiveTestSimple()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testMeshPartitioning_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a660d2aaf0e814e7872c35d9f24d45420_cgraph.svg" width="452" height="160"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a660d2aaf0e814e7872c35d9f24d45420_icgraph.svg" width="284" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9c70e062f4058ee8d6403002a8b3b3ea" name="a9c70e062f4058ee8d6403002a8b3b3ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c70e062f4058ee8d6403002a8b3b3ea">&#9670;&#160;</a></span>testLineElem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testLineElem </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filepath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on quadrature points on line elements (NOT IMPLEMENTED) </p>
<p>This function performs accuracy test of the quadrature points for integration over reference line with vertices at {-1, 1}. List of tests are as follows:</p>
<ol type="1">
<li>Computes quadrature points of the given order, writes them to the file, and checks if the sum of quadrature weights is equal to 0.5 (area of reference triangle).</li>
</ol>
<p>Also tests the exactness of the integration of the polynomial upto given order. Suppose \( n\) is the order of quadrature point, then we test if the integration of the function \( f(s,t) = s^\alpha\, t^\beta \) is exact for \( \alpha \) and \( \beta \) such that \( \alpha+\beta \leq n \). The exact integration of function \( f\) over reference triangle is  </p><p class="formulaDsp">
\[ I_{exact} = \int_0^1 \int_0^{1-s} s^\alpha\, t^\beta \, dt\, ds =
\sum_{i=0}^{\beta+1} (-1)^i \frac{{{\beta + 1} \choose i}}{(\alpha + i +1)
(\beta + 1)},
\]
</p>
<p> where </p><p class="formulaDsp">
\[ {a \choose b} = \frac{a (a-1) (a-2) ... (a-b+1)}{1*2*3 ... *b}. \]
</p>
<p> We have \( {a \choose 0} = 1 \) so that term for \( i=0\) is not zero. Above formula gives the exact value of integral of \( f(s,t) = s^\alpha\, t^\beta \) over reference triangle. Approximation by quadrature point is as follows </p><p class="formulaDsp">
\[ I_{approx} = \sum_{q=1}^{Q} w_q f(s_q, t_q) \]
</p>
<p> where \(Q\) is the total number of quad points, \( w_q\) and \((s_q, t_q)\) are the \( q^{th} \) quad weight and point. In this test, we compare \( I_{exact} \) and \( I_{approx} \) and report problem if both do not match.</p>
<ol type="1">
<li>Test the accuracy for simple quadrangle mesh on square domain [0,1]^2. Exact integration of polynomial \( f(x,y) = x^\alpha \, y^\beta \) on \([0,1]^2\) is given by <p class="formulaDsp">
\[ I_{exact} = \frac{1}{(\alpha+1) (\beta+1)}. \]
</p>
 We compare above with the approximation computed from the quadrature points. We consider \(\alpha + \beta \leq n \) where \( n\) is the order of approximation we are testing.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Order of quadrature point approximation </td></tr>
    <tr><td class="paramname">filepath</td><td>Path where mesh data for test can be found (expects files 'triMesh_nodes.csv' and 'triMesh_elements.csv' inside the filepath) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00198">198</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  198</span>{ <span class="keywordflow">return</span>; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="testFe_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a9c70e062f4058ee8d6403002a8b3b3ea_icgraph.svg" width="238" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af0964e1ea010ded3d98df70e7d5326ca" name="af0964e1ea010ded3d98df70e7d5326ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0964e1ea010ded3d98df70e7d5326ca">&#9670;&#160;</a></span>testMPI()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testMPI </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nGrid</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mHorizon</em> = <code>3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>testOption</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>meshFilename</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform parallelization test using MPI on mesh partition based on metis. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nGrid</td><td>Number of element along a line (total number of elements is N*N) </td></tr>
    <tr><td class="paramname">mHorizon</td><td>Integer factor that is used to compute nonlocal radius, i.e., horizon (epsilon = m * h, h being mesh size) </td></tr>
    <tr><td class="paramname">testOption</td><td>Test otion flag. 0 - use in-built uniform mesh, 1 - use user-specified mesh </td></tr>
    <tr><td class="paramname">meshFilename</td><td>Mesh filename with relative path from the directory where test command is run </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testParallelCompLib_8cpp_source.html#l00285">285</a> of file <a class="el" href="testParallelCompLib_8cpp_source.html">testParallelCompLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  286</span>                                                              {</div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordtype">int</span> mpiSize, mpiRank;</div>
<div class="line"><span class="lineno">  288</span>  MPI_Comm_size(MPI_COMM_WORLD, &amp;mpiSize);</div>
<div class="line"><span class="lineno">  289</span>  MPI_Comm_rank(MPI_COMM_WORLD, &amp;mpiRank);</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">// number of partitions</span></div>
<div class="line"><span class="lineno">  292</span>  <span class="keywordtype">size_t</span> nPart(mpiSize);</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>  <span class="comment">// create uniform mesh</span></div>
<div class="line"><span class="lineno">  295</span>  <span class="keywordtype">size_t</span> dim(2);</div>
<div class="line"><span class="lineno">  296</span>  <span class="keyword">auto</span> mesh = <a class="code hl_class" href="classfe_1_1Mesh.html">fe::Mesh</a>(dim);</div>
<div class="line"><span class="lineno">  297</span>  mesh.d_spatialDiscretization = <span class="stringliteral">&quot;finite_difference&quot;</span>;</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>  <span class="comment">// create mesh</span></div>
<div class="line"><span class="lineno">  300</span>  std::string outMeshFilename = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  301</span>  <span class="keywordflow">if</span> (testOption == 1) {</div>
<div class="line"><span class="lineno">  302</span>    <span class="comment">// set geometry details</span></div>
<div class="line"><span class="lineno">  303</span>    std::pair&lt;std::vector&lt;double&gt;, std::vector&lt;double&gt;&gt; box;</div>
<div class="line"><span class="lineno">  304</span>    std::vector&lt;size_t&gt; nGridVec;</div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;dim; i++) {</div>
<div class="line"><span class="lineno">  306</span>      box.first.push_back(0.);</div>
<div class="line"><span class="lineno">  307</span>      box.second.push_back(1.);</div>
<div class="line"><span class="lineno">  308</span>      nGridVec.push_back(nGrid);</div>
<div class="line"><span class="lineno">  309</span>    }</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>    <span class="comment">// call utility function to create mesh</span></div>
<div class="line"><span class="lineno">  312</span>    <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(<span class="stringliteral">&quot;\n\nCreating uniform mesh\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_function" href="namespacefe.html#abe6bbc09314c74619abaa8c13f489335">fe::createUniformMesh</a>(&amp;mesh, dim, box, nGridVec);</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <span class="comment">// filename for outputting</span></div>
<div class="line"><span class="lineno">  316</span>    outMeshFilename = fmt::format(<span class="stringliteral">&quot;uniform_mesh_Lx_{}_Ly_{}_Nx_{}_Ny_{}&quot;</span>,</div>
<div class="line"><span class="lineno">  317</span>                                  box.second[0], box.second[1],</div>
<div class="line"><span class="lineno">  318</span>                                  nGridVec[0], nGridVec[1]);</div>
<div class="line"><span class="lineno">  319</span>  }</div>
<div class="line"><span class="lineno">  320</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (testOption == 2) {</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">if</span> (meshFilename.empty()) {</div>
<div class="line"><span class="lineno">  322</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;testGraphPartitioning(): mesh filename is empty.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  323</span>      exit(1);</div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="comment">// call in-built function of mesh to create data from file</span></div>
<div class="line"><span class="lineno">  327</span>    <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(<span class="stringliteral">&quot;\n\nReading mesh\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  328</span>    mesh.createData(meshFilename);</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <span class="comment">// find the name of mesh file excluding path and extension</span></div>
<div class="line"><span class="lineno">  331</span>    outMeshFilename = <a class="code hl_function" href="namespaceutil_1_1io.html#ab41cbd366c1550587cc6d0bf1a088c5a">util::io::removeExtensionFromFile</a>(<a class="code hl_function" href="namespaceutil_1_1io.html#af88549ade477a5034a8f720753d9f2f9">util::io::getFilenameFromPath</a>(meshFilename));</div>
<div class="line"><span class="lineno">  332</span>  }</div>
<div class="line"><span class="lineno">  333</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  334</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot;testMPI() accepts either 1 or 2 for testOption. The value &quot;</span></div>
<div class="line"><span class="lineno">  335</span>              &lt;&lt; testOption &lt;&lt; <span class="stringliteral">&quot; is invalid.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  336</span>    exit(1);</div>
<div class="line"><span class="lineno">  337</span>  }</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  <span class="comment">// print mesh data and write mesh to a file</span></div>
<div class="line"><span class="lineno">  340</span>  <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(mesh.printStr());</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="comment">// calculate nonlocal neighborhood</span></div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceparticle__wall.html#aa08c5c90a5cffb178f26216ae2205144">horizon</a> = mHorizon*mesh.d_h;</div>
<div class="line"><span class="lineno">  344</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; nodeNeighs(mesh.d_numNodes);</div>
<div class="line"><span class="lineno">  345</span>  <a class="code hl_function" href="namespacegeometry.html#aa6be622d915e92b3547e0dbb35c4b156">geometry::computeNonlocalNeighborhood</a>(mesh.d_nodes, horizon, nodeNeighs);</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>  <span class="comment">// partition the mesh on root processor and broadcast to other processors</span></div>
<div class="line"><span class="lineno">  348</span>  mesh.d_nodePartition.resize(mesh.d_numNodes);</div>
<div class="line"><span class="lineno">  349</span>  <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(<span class="stringliteral">&quot;\n\nCreating partition of mesh\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  350</span>  <span class="keywordflow">if</span> (mpiRank == 0)</div>
<div class="line"><span class="lineno">  351</span>    <a class="code hl_function" href="namespacefe.html#abf9d43e85d09aafbc240f14cd9508ab4">fe::metisGraphPartition</a>(<span class="stringliteral">&quot;metis_kway&quot;</span>, &amp;mesh, nodeNeighs, nPart);</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>  <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(<span class="stringliteral">&quot;\n\nBroadcasting partition to all processors\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  354</span>  MPI_Bcast(mesh.d_nodePartition.data(), mesh.d_numNodes,</div>
<div class="line"><span class="lineno">  355</span>            MPI_UNSIGNED_LONG, 0, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>  <span class="comment">// Tasks:</span></div>
<div class="line"><span class="lineno">  359</span>  <span class="comment">// 1. Create list of ghost nodes associated to neighboring processors</span></div>
<div class="line"><span class="lineno">  360</span>  <span class="comment">// 2. Create a method that updates displacement of ghost nodes via MPI communication</span></div>
<div class="line"><span class="lineno">  361</span>  <span class="comment">// 3. Create two set of nodes owned by this processor; internal set will have nodes</span></div>
<div class="line"><span class="lineno">  362</span>  <span class="comment">// that do not depend on ghost nodes and boundary set that depend on ghost nodes</span></div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>  <span class="comment">// store id of nodes owned by this processor</span></div>
<div class="line"><span class="lineno">  365</span>  std::vector&lt;size_t&gt; ownedNodes, ownedInternalNodes, ownedBdryNodes;</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  <span class="comment">// for each neighboring processor, store id of ghost nodes owned by that processor</span></div>
<div class="line"><span class="lineno">  368</span>  std::vector&lt;std::pair&lt;std::vector&lt;size_t&gt;, std::vector&lt;size_t&gt;&gt;&gt; ghostData;</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>  <span class="comment">// fill the owned and ghost node vectors</span></div>
<div class="line"><span class="lineno">  371</span>  <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(<span class="stringliteral">&quot;\n\nCalling setupOwnerAndGhost()\n\n&quot;</span>);</div>
<div class="line"><span class="lineno">  372</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#aac5392db88c3cc94a19e5eb4ab013d18">setupOwnerAndGhost</a>(mpiSize, mpiRank,</div>
<div class="line"><span class="lineno">  373</span>                     mesh.d_nodePartition, nodeNeighs,</div>
<div class="line"><span class="lineno">  374</span>                     ownedNodes, ownedInternalNodes, ownedBdryNodes,</div>
<div class="line"><span class="lineno">  375</span>                     ghostData);</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  <span class="comment">// create dummy displacement vector with random values</span></div>
<div class="line"><span class="lineno">  378</span>  std::vector&lt;util::Point&gt; dispNodes(mesh.d_numNodes, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., -1., -1.));</div>
<div class="line"><span class="lineno">  379</span>  {</div>
<div class="line"><span class="lineno">  380</span>    <span class="comment">//  int seed = mpiRank;</span></div>
<div class="line"><span class="lineno">  381</span>    <span class="comment">//  RandGenerator gen(util::get_rd_gen(seed));</span></div>
<div class="line"><span class="lineno">  382</span>    <span class="comment">//  auto dist = util::DistributionSample&lt;UniformDistribution&gt;(0., 1., seed);</span></div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">//  for (auto i: ownedNodes)</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="comment">//    dispNodes[i] = util::Point(dist(), dist(), dist());</span></div>
<div class="line"><span class="lineno">  385</span>    <span class="comment">// assign value to owned nodes</span></div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> i: ownedNodes)</div>
<div class="line"><span class="lineno">  387</span>      dispNodes[i] = <a class="code hl_namespace" href="namespaceutil.html">util</a>::Point(<a class="code hl_function" href="namespaceutil_1_1parallel.html#adb80f14125b7556bb478cc3725508fa8">mpiRank</a> + 1, (<a class="code hl_function" href="namespaceutil_1_1parallel.html#adb80f14125b7556bb478cc3725508fa8">mpiRank</a> + 1)*100, (<a class="code hl_function" href="namespaceutil_1_1parallel.html#adb80f14125b7556bb478cc3725508fa8">mpiRank</a> + 1)*10000);</div>
<div class="line"><span class="lineno">  388</span>  }</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>  <span class="comment">// MPI communication to send and receive ghost nodes data</span></div>
<div class="line"><span class="lineno">  391</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a203213df0b872311cc21e15789f7a924">printMsg</a>(<span class="stringliteral">&quot;\n\nCalling exchangeDispData()\n\n&quot;</span>, mpiRank, 0);</div>
<div class="line"><span class="lineno">  392</span>  std::vector&lt;std::pair&lt;std::vector&lt;util::Point&gt;, std::vector&lt;util::Point&gt;&gt;&gt; dispGhostData;</div>
<div class="line"><span class="lineno">  393</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a4d39e968562ef414dc37d135b277b056">exchangeDispData</a>(mpiSize, mpiRank, ghostData, dispGhostData, dispNodes);</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  396</span>  <span class="keywordflow">if</span> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  397</span>    <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a203213df0b872311cc21e15789f7a924">printMsg</a>(<span class="stringliteral">&quot;\n\nDebugging dispGhostData()\n\n&quot;</span>, mpiRank, -1);</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordtype">bool</span> debug_failed = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j_proc = 0; j_proc &lt; <a class="code hl_function" href="namespaceutil_1_1parallel.html#ad67dcfb56bf70d082e443e849c832c00">mpiSize</a>; j_proc++) {</div>
<div class="line"><span class="lineno">  400</span>      <span class="keyword">auto</span> &amp;recvIds = ghostData[j_proc].first;</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>      <span class="keywordflow">if</span> (j_proc != mpiRank and recvIds.size() != 0) {</div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; recvIds.size(); k++) {</div>
<div class="line"><span class="lineno">  404</span>          <span class="keyword">auto</span> &amp;uk = dispNodes[recvIds[k]];</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>          <span class="comment">// verify we received correct value of uk</span></div>
<div class="line"><span class="lineno">  407</span>          <span class="keywordflow">if</span> (uk[0] != j_proc + 1 or uk[1] != 100 * (j_proc + 1)</div>
<div class="line"><span class="lineno">  408</span>              or uk[2] != 10000 * (j_proc + 1)) {</div>
<div class="line"><span class="lineno">  409</span>            debug_failed = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  410</span>            <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(fmt::format(<span class="stringliteral">&quot;    MPI exchange error: j_proc = {}, &quot;</span></div>
<div class="line"><span class="lineno">  411</span>                                     <span class="stringliteral">&quot;uk = ({}, {}, {})\n&quot;</span>, j_proc,</div>
<div class="line"><span class="lineno">  412</span>                                     uk[0], uk[1], uk[2]),</div>
<div class="line"><span class="lineno">  413</span>                     <a class="code hl_variable" href="namespaceutil_1_1io.html#a42df92c2c1577f7daed810257462e982">util::io::print_default_tab</a>, -1);</div>
<div class="line"><span class="lineno">  414</span>          }</div>
<div class="line"><span class="lineno">  415</span>        }</div>
<div class="line"><span class="lineno">  416</span>      }</div>
<div class="line"><span class="lineno">  417</span>    } <span class="comment">// loop over j_proc</span></div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">if</span> (debug_failed)</div>
<div class="line"><span class="lineno">  420</span>      <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(fmt::format(<span class="stringliteral">&quot;\n\nDEBUG failed for processor = {}\n\n&quot;</span>, mpiRank), <a class="code hl_variable" href="namespaceutil_1_1io.html#a42df92c2c1577f7daed810257462e982">util::io::print_default_tab</a>, -1);</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  422</span>      <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(fmt::format(<span class="stringliteral">&quot;\n\nDEBUG passed for processor = {}\n\n&quot;</span>, mpiRank), <a class="code hl_variable" href="namespaceutil_1_1io.html#a42df92c2c1577f7daed810257462e982">util::io::print_default_tab</a>, -1);</div>
<div class="line"><span class="lineno">  423</span>  }</div>
<div class="line"><span class="lineno">  425</span>}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02testParallelCompLib_8cpp_03_html_a203213df0b872311cc21e15789f7a924"><div class="ttname"><a href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a203213df0b872311cc21e15789f7a924">anonymous_namespace{testParallelCompLib.cpp}::printMsg</a></div><div class="ttdeci">void printMsg(std::string msg, int mpiRank, int printMpiRank)</div><div class="ttdef"><b>Definition</b> <a href="testParallelCompLib_8cpp_source.html#l00036">testParallelCompLib.cpp:36</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testParallelCompLib_8cpp_03_html_a4d39e968562ef414dc37d135b277b056"><div class="ttname"><a href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a4d39e968562ef414dc37d135b277b056">anonymous_namespace{testParallelCompLib.cpp}::exchangeDispData</a></div><div class="ttdeci">void exchangeDispData(size_t mpiSize, size_t mpiRank, const std::vector&lt; std::pair&lt; std::vector&lt; size_t &gt;, std::vector&lt; size_t &gt; &gt; &gt; &amp;ghostData, std::vector&lt; std::pair&lt; std::vector&lt; util::Point &gt;, std::vector&lt; util::Point &gt; &gt; &gt; &amp;dispGhostData, std::vector&lt; util::Point &gt; &amp;dispNodes)</div><div class="ttdef"><b>Definition</b> <a href="testParallelCompLib_8cpp_source.html#l00164">testParallelCompLib.cpp:164</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testParallelCompLib_8cpp_03_html_aac5392db88c3cc94a19e5eb4ab013d18"><div class="ttname"><a href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#aac5392db88c3cc94a19e5eb4ab013d18">anonymous_namespace{testParallelCompLib.cpp}::setupOwnerAndGhost</a></div><div class="ttdeci">void setupOwnerAndGhost(size_t mpiSize, size_t mpiRank, const std::vector&lt; size_t &gt; &amp;nodePartition, const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;nodeNeighs, std::vector&lt; size_t &gt; &amp;ownedNodes, std::vector&lt; size_t &gt; &amp;ownedInternalNodes, std::vector&lt; size_t &gt; &amp;ownedBdryNodes, std::vector&lt; std::pair&lt; std::vector&lt; size_t &gt;, std::vector&lt; size_t &gt; &gt; &gt; &amp;ghostData)</div><div class="ttdef"><b>Definition</b> <a href="testParallelCompLib_8cpp_source.html#l00053">testParallelCompLib.cpp:53</a></div></div>
<div class="ttc" id="anamespaceutil_1_1io_html_a42df92c2c1577f7daed810257462e982"><div class="ttname"><a href="namespaceutil_1_1io.html#a42df92c2c1577f7daed810257462e982">util::io::print_default_tab</a></div><div class="ttdeci">const int print_default_tab</div><div class="ttdoc">Default value of tab used in outputting formatted information.</div><div class="ttdef"><b>Definition</b> <a href="io_8h_source.html#l00027">io.h:27</a></div></div>
<div class="ttc" id="anamespaceutil_1_1io_html_a578a578ce41389fb01e56de7316b7054"><div class="ttname"><a href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a></div><div class="ttdeci">void print(const T &amp;msg, int nt=print_default_tab, int printMpiRank=print_default_mpi_rank)</div><div class="ttdoc">Prints formatted information.</div><div class="ttdef"><b>Definition</b> <a href="io_8h_source.html#l00108">io.h:108</a></div></div>
<div class="ttc" id="anamespaceutil_1_1parallel_html_ad67dcfb56bf70d082e443e849c832c00"><div class="ttname"><a href="namespaceutil_1_1parallel.html#ad67dcfb56bf70d082e443e849c832c00">util::parallel::mpiSize</a></div><div class="ttdeci">int mpiSize()</div><div class="ttdoc">Get size (number) of processors.</div><div class="ttdef"><b>Definition</b> <a href="parallelUtil_8cpp_source.html#l00077">parallelUtil.cpp:77</a></div></div>
<div class="ttc" id="anamespaceutil_1_1parallel_html_adb80f14125b7556bb478cc3725508fa8"><div class="ttname"><a href="namespaceutil_1_1parallel.html#adb80f14125b7556bb478cc3725508fa8">util::parallel::mpiRank</a></div><div class="ttdeci">int mpiRank()</div><div class="ttdoc">get rank (id) of this processor</div><div class="ttdef"><b>Definition</b> <a href="parallelUtil_8cpp_source.html#l00085">parallelUtil.cpp:85</a></div></div>
<div class="ttc" id="anamespaceutil_html"><div class="ttname"><a href="namespaceutil.html">util</a></div><div class="ttdoc">Collection of methods useful in simulation.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00014">feElementDefs.h:14</a></div></div>
<div class="ttc" id="astructutil_1_1Point_html"><div class="ttname"><a href="structutil_1_1Point.html">util::Point</a></div><div class="ttdoc">A structure to represent 3d vectors.</div><div class="ttdef"><b>Definition</b> <a href="point_8h_source.html#l00030">point.h:30</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="geometryUtil_8cpp_source.html#l00017">geometry::computeNonlocalNeighborhood()</a>, <a class="el" href="meshUtil_8cpp_source.html#l00023">fe::createUniformMesh()</a>, <a class="el" href="testParallelCompLib_8cpp_source.html#l00164">anonymous_namespace{testParallelCompLib.cpp}::exchangeDispData()</a>, <a class="el" href="io_8h_source.html#l00404">util::io::getFilenameFromPath()</a>, <a class="el" href="meshPartitioning_8cpp_source.html#l00018">fe::metisGraphPartition()</a>, <a class="el" href="io_8h_source.html#l00108">util::io::print()</a>, <a class="el" href="io_8h_source.html#l00027">util::io::print_default_tab</a>, <a class="el" href="testParallelCompLib_8cpp_source.html#l00036">anonymous_namespace{testParallelCompLib.cpp}::printMsg()</a>, <a class="el" href="io_8h_source.html#l00416">util::io::removeExtensionFromFile()</a>, and <a class="el" href="testParallelCompLib_8cpp_source.html#l00053">anonymous_namespace{testParallelCompLib.cpp}::setupOwnerAndGhost()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testParallelComp_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_af0964e1ea010ded3d98df70e7d5326ca_cgraph.svg" width="928" height="554"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_af0964e1ea010ded3d98df70e7d5326ca_icgraph.svg" width="208" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a473c5d8b21be56b653930316d33eb743" name="a473c5d8b21be56b653930316d33eb743"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a473c5d8b21be56b653930316d33eb743">&#9670;&#160;</a></span>testNanoflann()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim = 3&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template std::string test::testNanoflann&lt; 3 &gt; </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on nsearch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>size of particle cloud in each dimension. total size would be N^3 </td></tr>
    <tr><td class="paramname">L</td><td>Size of unit cell to create crystal lattice point cloud </td></tr>
    <tr><td class="paramname">dL</td><td>Perturbation of lattice sites </td></tr>
    <tr><td class="paramname">seed</td><td>Seed </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>str String containing various information </dd></dl>

<p class="definition">Definition at line <a class="el" href="testNSearchLib_8cpp_source.html#l00494">494</a> of file <a class="el" href="testNSearchLib_8cpp_source.html">testNSearchLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  494</span>                                                                     {</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>  <span class="keywordflow">if</span> (dim &lt; 2 or dim &gt; 3) {</div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;testNanoflann: only dim = 2, 3 are accepted.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <span class="comment">// create 3D lattice and perturb each lattice point</span></div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordtype">size_t</span> Nx, Ny, Nz;</div>
<div class="line"><span class="lineno">  502</span>  Nx = Ny = Nz = N;</div>
<div class="line"><span class="lineno">  503</span>  <span class="keywordtype">size_t</span> N_tot = Nx * Ny;</div>
<div class="line"><span class="lineno">  504</span>  <span class="keywordflow">if</span> (dim == 3)</div>
<div class="line"><span class="lineno">  505</span>    N_tot = N_tot * Nz;</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  std::vector&lt;util::Point&gt; x(N_tot, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>());</div>
<div class="line"><span class="lineno">  508</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a842f06817313f305bf05286d9f13b7d1">lattice</a>(L, Nx, Ny, Nz, dL, seed, x, dim);</div>
<div class="line"><span class="lineno">  509</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Total points = &quot;</span> &lt;&lt; x.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>  <span class="keywordflow">if</span> (dim == 2) {</div>
<div class="line"><span class="lineno">  513</span>    std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_nflann(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  514</span>    std::vector&lt;std::vector&lt;float&gt;&gt; neigh_nflann_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  515</span>                                                         std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>    std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_nflann_3d(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  518</span>    std::vector&lt;std::vector&lt;float&gt;&gt; neigh_nflann_3d_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  519</span>                                                         std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_brute(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  522</span>    std::vector&lt;std::vector&lt;float&gt;&gt; neigh_brute_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  523</span>                                                        std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// brute-force search</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordtype">double</span> search_r = 1.5 * L;</div>
<div class="line"><span class="lineno">  527</span>    <span class="keyword">auto</span> brute_force_search_time =</div>
<div class="line"><span class="lineno">  528</span>            <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ad14a66b26ddadc8b05b1aa044d2cf27d">neighSearchBrute</a>(x, search_r, neigh_brute, neigh_brute_sq_dist);</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">// nanoflann tree search</span></div>
<div class="line"><span class="lineno">  531</span>    std::unique_ptr&lt;nsearch::NFlannSearchKd&lt;3&gt;&gt; nflann_nsearch_3d</div>
<div class="line"><span class="lineno">  532</span>            = std::make_unique&lt;nsearch::NFlannSearchKd&lt;3&gt;&gt;(x, 0);</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    std::unique_ptr&lt;nsearch::NFlannSearchKd&lt;dim&gt;&gt; nflann_nsearch</div>
<div class="line"><span class="lineno">  535</span>            = std::make_unique&lt;nsearch::NFlannSearchKd&lt;dim&gt;&gt;(x, 0);</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <span class="keyword">auto</span> nflann_tree_set_time_3d = nflann_nsearch_3d-&gt;setInputCloud();</div>
<div class="line"><span class="lineno">  538</span>    <span class="keyword">auto</span> nflann_tree_search_time_3d =</div>
<div class="line"><span class="lineno">  539</span>            <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a2c5f6131f024be97a0087b26f6f596c3">neighSearchTreeSizet</a>(x, nflann_nsearch_3d, search_r, neigh_nflann_3d, neigh_nflann_3d_sq_dist);</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>    <span class="keyword">auto</span> nflann_tree_set_time = nflann_nsearch-&gt;setInputCloud();</div>
<div class="line"><span class="lineno">  542</span>    <span class="keyword">auto</span> nflann_tree_search_time =</div>
<div class="line"><span class="lineno">  543</span>            <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a2c5f6131f024be97a0087b26f6f596c3">neighSearchTreeSizet</a>(x, nflann_nsearch, search_r, neigh_nflann, neigh_nflann_sq_dist);</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="comment">// Compare search results</span></div>
<div class="line"><span class="lineno">  546</span>    <span class="keyword">auto</span> nflann_brute_compare = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">compare_results</a>(</div>
<div class="line"><span class="lineno">  547</span>            neigh_nflann, neigh_brute, {<span class="stringliteral">&quot;nflann_tree&quot;</span>, <span class="stringliteral">&quot;brute_force&quot;</span>}, -1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    <span class="keyword">auto</span> nflann_brute_compare_3d = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">compare_results</a>(</div>
<div class="line"><span class="lineno">  550</span>            neigh_nflann_3d, neigh_brute, {<span class="stringliteral">&quot;nflann_tree-3d&quot;</span>, <span class="stringliteral">&quot;brute_force&quot;</span>}, -1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>    std::ostringstream msg;</div>
<div class="line"><span class="lineno">  553</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Setup times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  554</span>                       <span class="stringliteral">&quot;    nflann_tree_set_time = {} \n &quot;</span></div>
<div class="line"><span class="lineno">  555</span>                       <span class="stringliteral">&quot;    nflann_tree_set_time_3d = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  556</span>                       nflann_tree_set_time, nflann_tree_set_time_3d);</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Search times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  559</span>                       <span class="stringliteral">&quot;    brute_force_search_time = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  560</span>                       <span class="stringliteral">&quot;    nflann_tree_search_time = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  561</span>                       <span class="stringliteral">&quot;    nflann_tree_search_time_3d = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  562</span>                       brute_force_search_time,</div>
<div class="line"><span class="lineno">  563</span>                       nflann_tree_search_time,</div>
<div class="line"><span class="lineno">  564</span>                       nflann_tree_search_time_3d);</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  567</span>                       <span class="stringliteral">&quot;    nflann_brute_compare: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  568</span>                       nflann_brute_compare);</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  571</span>                       <span class="stringliteral">&quot;    nflann_brute_compare_3d: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  572</span>                       nflann_brute_compare_3d);</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">return</span> msg.str();</div>
<div class="line"><span class="lineno">  575</span>  }</div>
<div class="line"><span class="lineno">  576</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim == 3) {</div>
<div class="line"><span class="lineno">  577</span>    std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_nflann(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  578</span>    std::vector&lt;std::vector&lt;float&gt;&gt; neigh_nflann_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  579</span>                                                         std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_brute(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  582</span>    std::vector&lt;std::vector&lt;float&gt;&gt; neigh_brute_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  583</span>                                                        std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>    <span class="comment">// brute-force search</span></div>
<div class="line"><span class="lineno">  586</span>    <span class="keywordtype">double</span> search_r = 1.5 * L;</div>
<div class="line"><span class="lineno">  587</span>    <span class="keyword">auto</span> brute_force_search_time =</div>
<div class="line"><span class="lineno">  588</span>            <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ad14a66b26ddadc8b05b1aa044d2cf27d">neighSearchBrute</a>(x, search_r, neigh_brute, neigh_brute_sq_dist);</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    <span class="comment">// nanoflann tree search</span></div>
<div class="line"><span class="lineno">  591</span>    std::unique_ptr&lt;nsearch::NFlannSearchKd&lt;dim&gt;&gt; nflann_nsearch</div>
<div class="line"><span class="lineno">  592</span>            = std::make_unique&lt;nsearch::NFlannSearchKd&lt;dim&gt;&gt;(x, 0);</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>    <span class="keyword">auto</span> nflann_tree_set_time = nflann_nsearch-&gt;setInputCloud();</div>
<div class="line"><span class="lineno">  595</span>    <span class="keyword">auto</span> nflann_tree_search_time =</div>
<div class="line"><span class="lineno">  596</span>            <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a2c5f6131f024be97a0087b26f6f596c3">neighSearchTreeSizet</a>(x, nflann_nsearch, search_r, neigh_nflann, neigh_nflann_sq_dist);</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    <span class="comment">// Compare search results</span></div>
<div class="line"><span class="lineno">  599</span>    <span class="keyword">auto</span> nflann_brute_compare = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">compare_results</a>(</div>
<div class="line"><span class="lineno">  600</span>            neigh_nflann, neigh_brute, {<span class="stringliteral">&quot;nflann_tree&quot;</span>, <span class="stringliteral">&quot;brute_force&quot;</span>}, -1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>    std::ostringstream msg;</div>
<div class="line"><span class="lineno">  603</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Setup times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  604</span>                       <span class="stringliteral">&quot;    nflann_tree_set_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  605</span>                       nflann_tree_set_time);</div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Search times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  608</span>                       <span class="stringliteral">&quot;    brute_force_search_time = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  609</span>                       <span class="stringliteral">&quot;    nflann_tree_search_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  610</span>                       brute_force_search_time,</div>
<div class="line"><span class="lineno">  611</span>                       nflann_tree_search_time);</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  614</span>                       <span class="stringliteral">&quot;    nflann_brute_compare: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  615</span>                       nflann_brute_compare);</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">return</span> msg.str();</div>
<div class="line"><span class="lineno">  618</span>  }</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_a2c5f6131f024be97a0087b26f6f596c3"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a2c5f6131f024be97a0087b26f6f596c3">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeSizet</a></div><div class="ttdeci">double neighSearchTreeSizet(const std::vector&lt; util::Point &gt; &amp;x, const std::unique_ptr&lt; NSearch &gt; &amp;nsearch, const double &amp;r, std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;neigh, std::vector&lt; std::vector&lt; float &gt; &gt; &amp;neigh_sq_dist)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00141">testNSearchLib.cpp:141</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_a842f06817313f305bf05286d9f13b7d1"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a842f06817313f305bf05286d9f13b7d1">anonymous_namespace{testNSearchLib.cpp}::lattice</a></div><div class="ttdeci">void lattice(double L, size_t Nx, size_t Ny, size_t Nz, double dL, int seed, std::vector&lt; util::Point &gt; &amp;x, int dim=3)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00054">testNSearchLib.cpp:54</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_ab8f5c0f5d27fa446e8a28e9aaeac9600"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">anonymous_namespace{testNSearchLib.cpp}::compare_results</a></div><div class="ttdeci">std::string compare_results(const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;neigh1, const std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;neigh2, std::vector&lt; std::string &gt; tags, int check_nodes_num=-1, bool only_err_count=false)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00408">testNSearchLib.cpp:408</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_ad14a66b26ddadc8b05b1aa044d2cf27d"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ad14a66b26ddadc8b05b1aa044d2cf27d">anonymous_namespace{testNSearchLib.cpp}::neighSearchBrute</a></div><div class="ttdeci">double neighSearchBrute(const std::vector&lt; util::Point &gt; &amp;x, const double &amp;r, std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;neigh, std::vector&lt; std::vector&lt; float &gt; &gt; &amp;neigh_sq_dist)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00236">testNSearchLib.cpp:236</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testNSearchLib_8cpp_source.html#l00408">anonymous_namespace{testNSearchLib.cpp}::compare_results()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00054">anonymous_namespace{testNSearchLib.cpp}::lattice()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00236">anonymous_namespace{testNSearchLib.cpp}::neighSearchBrute()</a>, and <a class="el" href="testNSearchLib_8cpp_source.html#l00141">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeSizet()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a473c5d8b21be56b653930316d33eb743_cgraph.svg" width="574" height="302"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2abf679a9141e85f146ee0a27d7d4a76" name="a2abf679a9141e85f146ee0a27d7d4a76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2abf679a9141e85f146ee0a27d7d4a76">&#9670;&#160;</a></span>testNanoflannClosestPoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string test::testNanoflannClosestPoint </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on nsearch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>size of particle cloud in each dimension. total size would be N^3 </td></tr>
    <tr><td class="paramname">L</td><td>Size of unit cell to create crystal lattice point cloud </td></tr>
    <tr><td class="paramname">dL</td><td>Perturbation of lattice sites </td></tr>
    <tr><td class="paramname">seed</td><td>Seed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>str String containing various information </dd></dl>

<p class="definition">Definition at line <a class="el" href="testNSearchLib_8cpp_source.html#l00781">781</a> of file <a class="el" href="testNSearchLib_8cpp_source.html">testNSearchLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  781</span>                                                                                 {</div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>  <span class="comment">// create 3D lattice and perturb each lattice point</span></div>
<div class="line"><span class="lineno">  784</span>  <span class="keywordtype">size_t</span> Nx, Ny, Nz;</div>
<div class="line"><span class="lineno">  785</span>  Nx = Ny = Nz = N;</div>
<div class="line"><span class="lineno">  786</span>  <span class="keywordtype">size_t</span> N_tot = Nx * Ny * Nz;</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>  std::vector&lt;util::Point&gt; x(N_tot, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>());</div>
<div class="line"><span class="lineno">  789</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a842f06817313f305bf05286d9f13b7d1">lattice</a>(L, Nx, Ny, Nz, dL, seed, x, 3);</div>
<div class="line"><span class="lineno">  790</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Total points = &quot;</span> &lt;&lt; x.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>  <span class="comment">// nanoflann tree search</span></div>
<div class="line"><span class="lineno">  793</span>  <span class="keyword">auto</span> nflann_nsearch</div>
<div class="line"><span class="lineno">  794</span>          = std::make_unique&lt;nsearch::NFlannSearchKd&lt;3&gt;&gt;(x, 0);</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>  <span class="keyword">auto</span> nflann_tree_set_time = nflann_nsearch-&gt;setInputCloud();</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>  std::vector&lt;size_t&gt; err_points;</div>
<div class="line"><span class="lineno">  799</span>  std::vector&lt;util::Point&gt; search_points;</div>
<div class="line"><span class="lineno">  800</span>  std::vector&lt;double&gt; err_dist;</div>
<div class="line"><span class="lineno">  801</span>  <span class="keyword">auto</span> nsearch_search_time = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a05ca86bc4c50fbb25f0dc79f76c5447d">neighSearchTreeClosestPointSizet</a>(</div>
<div class="line"><span class="lineno">  802</span>          x, nflann_nsearch, seed, L, dL, search_points, err_points, err_dist);</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">// Compare search results</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="keyword">auto</span> nflann_compare = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a4effc78693b353cd19d88b6f6774d022">compare_closest_point_results</a>(x,</div>
<div class="line"><span class="lineno">  806</span>                                                              search_points,</div>
<div class="line"><span class="lineno">  807</span>                                                              err_points,</div>
<div class="line"><span class="lineno">  808</span>                                                              err_dist, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>    std::ostringstream msg;</div>
<div class="line"><span class="lineno">  811</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Setup times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  812</span>                       <span class="stringliteral">&quot;    nflann_tree_set_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  813</span>                       nflann_tree_set_time);</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>    msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  816</span>                       <span class="stringliteral">&quot;    nflann_compare: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  817</span>                       nflann_compare);</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">return</span> msg.str();</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_a05ca86bc4c50fbb25f0dc79f76c5447d"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a05ca86bc4c50fbb25f0dc79f76c5447d">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeClosestPointSizet</a></div><div class="ttdeci">double neighSearchTreeClosestPointSizet(const std::vector&lt; util::Point &gt; &amp;x, const std::unique_ptr&lt; NSearch &gt; &amp;nsearch, const int &amp;seed, const double &amp;L, const double &amp;dL, std::vector&lt; util::Point &gt; &amp;search_points, std::vector&lt; size_t &gt; &amp;err_points, std::vector&lt; double &gt; &amp;err_dist)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00336">testNSearchLib.cpp:336</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_a4effc78693b353cd19d88b6f6774d022"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a4effc78693b353cd19d88b6f6774d022">anonymous_namespace{testNSearchLib.cpp}::compare_closest_point_results</a></div><div class="ttdeci">std::string compare_closest_point_results(const std::vector&lt; util::Point &gt; &amp;x, const std::vector&lt; util::Point &gt; &amp;search_points, const std::vector&lt; size_t &gt; &amp;err_points, const std::vector&lt; double &gt; &amp;err_dist, bool only_err_count=false)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00460">testNSearchLib.cpp:460</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testNSearchLib_8cpp_source.html#l00460">anonymous_namespace{testNSearchLib.cpp}::compare_closest_point_results()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00054">anonymous_namespace{testNSearchLib.cpp}::lattice()</a>, and <a class="el" href="testNSearchLib_8cpp_source.html#l00336">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeClosestPointSizet()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testNSearch_8cpp_source.html#l00019">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a2abf679a9141e85f146ee0a27d7d4a76_cgraph.svg" width="690" height="239"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a2abf679a9141e85f146ee0a27d7d4a76_icgraph.svg" width="288" height="51"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a197262de1745b522497c1d1e58066215" name="a197262de1745b522497c1d1e58066215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a197262de1745b522497c1d1e58066215">&#9670;&#160;</a></span>testNanoflannExcludeInclude()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;int dim = 3&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template std::string test::testNanoflannExcludeInclude&lt; 3 &gt; </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtest_1_1testNSearchData.html">testNSearchData</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on nsearch. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>size of particle cloud in each dimension. total size would be N^3 </td></tr>
    <tr><td class="paramname">L</td><td>Size of unit cell to create crystal lattice point cloud </td></tr>
    <tr><td class="paramname">dL</td><td>Perturbation of lattice sites </td></tr>
    <tr><td class="paramname">seed</td><td>Seed </td></tr>
    <tr><td class="paramname">dim</td><td>Dimension </td></tr>
    <tr><td class="paramname">data</td><td>Search data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>str String containing various information </dd></dl>

<p class="definition">Definition at line <a class="el" href="testNSearchLib_8cpp_source.html#l00625">625</a> of file <a class="el" href="testNSearchLib_8cpp_source.html">testNSearchLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  626</span>                                                     {</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>  <span class="keywordflow">if</span> (dim &lt; 2 or dim &gt; 3) {</div>
<div class="line"><span class="lineno">  629</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;testNanoflannExcludeInclude: only dim = 2, 3 are accepted.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  630</span>  }</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>  <span class="comment">// create 3D lattice and perturb each lattice point</span></div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordtype">size_t</span> Nx, Ny, Nz;</div>
<div class="line"><span class="lineno">  634</span>  Nx = Ny = Nz = N;</div>
<div class="line"><span class="lineno">  635</span>  <span class="keywordtype">size_t</span> N_tot = Nx * Ny;</div>
<div class="line"><span class="lineno">  636</span>  <span class="keywordflow">if</span> (dim == 3)</div>
<div class="line"><span class="lineno">  637</span>    N_tot = N_tot * Nz;</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>  std::vector&lt;util::Point&gt; x(N_tot, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>());</div>
<div class="line"><span class="lineno">  640</span>  std::vector&lt;size_t&gt; xTags(N_tot, 0);</div>
<div class="line"><span class="lineno">  641</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a842f06817313f305bf05286d9f13b7d1">lattice</a>(L, Nx, Ny, Nz, dL, seed, x, dim);</div>
<div class="line"><span class="lineno">  642</span>  <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a4f487e31f282be89df8c00e4d8ac9101">assignRandomTags</a>(x, data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a53bd3dde35470c275dc82152ccab75a1">d_numTags</a>, seed, xTags);</div>
<div class="line"><span class="lineno">  643</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a7be70004d7abae3cd87e0ad60c830d33">d_numPoints</a> = x.size();</div>
<div class="line"><span class="lineno">  644</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Total points = &quot;</span> &lt;&lt; x.size() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_default_nflann(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  647</span>  std::vector&lt;std::vector&lt;float&gt;&gt; neigh_default_nflann_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  648</span>                                                               std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  649</span> </div>
<div class="line"><span class="lineno">  650</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_exclude_nflann(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  651</span>  std::vector&lt;std::vector&lt;float&gt;&gt; neigh_exclude_nflann_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  652</span>                                                       std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  653</span> </div>
<div class="line"><span class="lineno">  654</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_include_nflann(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  655</span>  std::vector&lt;std::vector&lt;float&gt;&gt; neigh_include_nflann_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  656</span>                                                               std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_default_brute(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  660</span>  std::vector&lt;std::vector&lt;float&gt;&gt; neigh_default_brute_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  661</span>                                                              std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_exclude_brute(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  664</span>  std::vector&lt;std::vector&lt;float&gt;&gt; neigh_exclude_brute_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  665</span>                                                      std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; neigh_include_brute(N_tot, std::vector&lt;size_t&gt;());</div>
<div class="line"><span class="lineno">  668</span>  std::vector&lt;std::vector&lt;float&gt;&gt; neigh_include_brute_sq_dist(N_tot,</div>
<div class="line"><span class="lineno">  669</span>                                                              std::vector&lt;float&gt;());</div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>  <span class="comment">// brute-force search</span></div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordtype">double</span> search_r = 3. * L;</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a2269083be3b806c035ac9f8905037229">d_defaultBruteSearchTime</a> =</div>
<div class="line"><span class="lineno">  675</span>          <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ad14a66b26ddadc8b05b1aa044d2cf27d">neighSearchBrute</a>(x,</div>
<div class="line"><span class="lineno">  676</span>                           search_r,</div>
<div class="line"><span class="lineno">  677</span>                           neigh_default_brute,</div>
<div class="line"><span class="lineno">  678</span>                           neigh_default_brute_sq_dist);</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#afad4fdb3a31c97cc480e86bd405e0824">d_excludeBruteSearchTime</a> =</div>
<div class="line"><span class="lineno">  681</span>          <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a9fb754534a8d064e41daf02f4bc68768">neighSearchBruteExcludeInclude</a>(x, xTags, search_r,</div>
<div class="line"><span class="lineno">  682</span>                                  neigh_exclude_brute,</div>
<div class="line"><span class="lineno">  683</span>                                  neigh_exclude_brute_sq_dist,</div>
<div class="line"><span class="lineno">  684</span>                                  1);</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a7b875ddfcc86721b4cc964e0681eff00">d_includeBruteSearchTime</a> =</div>
<div class="line"><span class="lineno">  687</span>          <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a9fb754534a8d064e41daf02f4bc68768">neighSearchBruteExcludeInclude</a>(x, xTags, search_r,</div>
<div class="line"><span class="lineno">  688</span>                                  neigh_include_brute,</div>
<div class="line"><span class="lineno">  689</span>                                  neigh_include_brute_sq_dist,</div>
<div class="line"><span class="lineno">  690</span>                                  2);</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>  <span class="comment">// nanoflann tree search</span></div>
<div class="line"><span class="lineno">  693</span>  std::unique_ptr&lt;nsearch::NFlannSearchKd&lt;dim&gt;&gt; nflann_nsearch</div>
<div class="line"><span class="lineno">  694</span>          = std::make_unique&lt;nsearch::NFlannSearchKd&lt;dim&gt;&gt;(x, 0,</div>
<div class="line"><span class="lineno">  695</span>                  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a28795d175c7092070fa033d214e2ac29">d_leafMaxSize</a>);</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a1be814661212423357733173e30558ff">d_treeBuildTime</a> = nflann_nsearch-&gt;setInputCloud();</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>  <span class="comment">// default</span></div>
<div class="line"><span class="lineno">  700</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#acf68058900bb2eaf08379434d428b699">d_defaultNFlannSearchTime</a> =</div>
<div class="line"><span class="lineno">  701</span>          <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a2c5f6131f024be97a0087b26f6f596c3">neighSearchTreeSizet</a>(x, nflann_nsearch,</div>
<div class="line"><span class="lineno">  702</span>                               search_r, neigh_default_nflann,</div>
<div class="line"><span class="lineno">  703</span>                               neigh_default_nflann_sq_dist);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>  <span class="comment">// exclude</span></div>
<div class="line"><span class="lineno">  706</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a6ead962b7981b88b014ca3d7e2e87763">d_excludeNFlannSearchTime</a> =</div>
<div class="line"><span class="lineno">  707</span>          <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ae482c6acc7871249ddc81c25cb8bf32a">neighSearchTreeSizetExcludeInclude</a>(x, xTags, nflann_nsearch,</div>
<div class="line"><span class="lineno">  708</span>                                      search_r, neigh_exclude_nflann,</div>
<div class="line"><span class="lineno">  709</span>                                      neigh_exclude_nflann_sq_dist,</div>
<div class="line"><span class="lineno">  710</span>                                      1);</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>  <span class="comment">// include</span></div>
<div class="line"><span class="lineno">  713</span>  data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a42c89960f0eabf1c25792805f6df82fe">d_includeNFlannSearchTime</a> =</div>
<div class="line"><span class="lineno">  714</span>          <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ae482c6acc7871249ddc81c25cb8bf32a">neighSearchTreeSizetExcludeInclude</a>(x, xTags, nflann_nsearch,</div>
<div class="line"><span class="lineno">  715</span>                                      search_r, neigh_include_nflann,</div>
<div class="line"><span class="lineno">  716</span>                                      neigh_include_nflann_sq_dist,</div>
<div class="line"><span class="lineno">  717</span>                                      2);</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>  <span class="comment">// Compare search results</span></div>
<div class="line"><span class="lineno">  720</span>  <span class="keyword">auto</span> nflann_brute_compare_default = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">compare_results</a>(</div>
<div class="line"><span class="lineno">  721</span>          neigh_default_nflann, neigh_default_brute,</div>
<div class="line"><span class="lineno">  722</span>          {<span class="stringliteral">&quot;nflann_tree_default&quot;</span>, <span class="stringliteral">&quot;brute_force_default&quot;</span>}, -1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>  <span class="keyword">auto</span> nflann_brute_compare_exclude = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">compare_results</a>(</div>
<div class="line"><span class="lineno">  725</span>          neigh_exclude_nflann, neigh_exclude_brute,</div>
<div class="line"><span class="lineno">  726</span>          {<span class="stringliteral">&quot;nflann_tree_exclude&quot;</span>, <span class="stringliteral">&quot;brute_force_exclude&quot;</span>}, -1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>  <span class="keyword">auto</span> nflann_brute_compare_include = <a class="code hl_function" href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ab8f5c0f5d27fa446e8a28e9aaeac9600">compare_results</a>(</div>
<div class="line"><span class="lineno">  729</span>          neigh_include_nflann, neigh_include_brute,</div>
<div class="line"><span class="lineno">  730</span>          {<span class="stringliteral">&quot;nflann_tree_include&quot;</span>, <span class="stringliteral">&quot;brute_force_include&quot;</span>}, -1, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>  std::ostringstream msg;</div>
<div class="line"><span class="lineno">  733</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Setup times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  734</span>                     <span class="stringliteral">&quot;    nflann_tree_set_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  735</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a1be814661212423357733173e30558ff">d_treeBuildTime</a>);</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Default search times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  738</span>                     <span class="stringliteral">&quot;    brute_force_search_time = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  739</span>                     <span class="stringliteral">&quot;    nflann_tree_search_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  740</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a2269083be3b806c035ac9f8905037229">d_defaultBruteSearchTime</a>,</div>
<div class="line"><span class="lineno">  741</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#acf68058900bb2eaf08379434d428b699">d_defaultNFlannSearchTime</a>);</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Exclude comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  744</span>                     <span class="stringliteral">&quot;    nflann_brute_compare: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  745</span>                     nflann_brute_compare_default);</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Exclude search times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  748</span>                     <span class="stringliteral">&quot;    brute_force_search_time = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  749</span>                     <span class="stringliteral">&quot;    nflann_tree_search_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  750</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#afad4fdb3a31c97cc480e86bd405e0824">d_excludeBruteSearchTime</a>,</div>
<div class="line"><span class="lineno">  751</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a6ead962b7981b88b014ca3d7e2e87763">d_excludeNFlannSearchTime</a>);</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Exclude comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  754</span>                     <span class="stringliteral">&quot;    nflann_brute_compare: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  755</span>                     nflann_brute_compare_exclude);</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Include search times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  758</span>                     <span class="stringliteral">&quot;    brute_force_search_time = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  759</span>                     <span class="stringliteral">&quot;    nflann_tree_search_time = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  760</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a7b875ddfcc86721b4cc964e0681eff00">d_includeBruteSearchTime</a>,</div>
<div class="line"><span class="lineno">  761</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a42c89960f0eabf1c25792805f6df82fe">d_includeNFlannSearchTime</a>);</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Include comparison results: \n&quot;</span></div>
<div class="line"><span class="lineno">  764</span>                     <span class="stringliteral">&quot;    nflann_brute_compare: \n{}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  765</span>                     nflann_brute_compare_include);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Nflann all search times (microseconds): \n&quot;</span></div>
<div class="line"><span class="lineno">  769</span>                     <span class="stringliteral">&quot;    default = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  770</span>                     <span class="stringliteral">&quot;    exclude = {}\n&quot;</span></div>
<div class="line"><span class="lineno">  771</span>                     <span class="stringliteral">&quot;    include = {}\n&quot;</span>,</div>
<div class="line"><span class="lineno">  772</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#acf68058900bb2eaf08379434d428b699">d_defaultNFlannSearchTime</a>,</div>
<div class="line"><span class="lineno">  773</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a6ead962b7981b88b014ca3d7e2e87763">d_excludeNFlannSearchTime</a>,</div>
<div class="line"><span class="lineno">  774</span>                     data.<a class="code hl_variable" href="structtest_1_1testNSearchData.html#a42c89960f0eabf1c25792805f6df82fe">d_includeNFlannSearchTime</a>);</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>  <span class="keywordflow">return</span> msg.str();</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_a4f487e31f282be89df8c00e4d8ac9101"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a4f487e31f282be89df8c00e4d8ac9101">anonymous_namespace{testNSearchLib.cpp}::assignRandomTags</a></div><div class="ttdeci">void assignRandomTags(std::vector&lt; util::Point &gt; &amp;x, int numTags, int seed, std::vector&lt; size_t &gt; &amp;xTags)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00095">testNSearchLib.cpp:95</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_a9fb754534a8d064e41daf02f4bc68768"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#a9fb754534a8d064e41daf02f4bc68768">anonymous_namespace{testNSearchLib.cpp}::neighSearchBruteExcludeInclude</a></div><div class="ttdeci">double neighSearchBruteExcludeInclude(const std::vector&lt; util::Point &gt; &amp;x, const std::vector&lt; size_t &gt; &amp;xTags, const double &amp;r, std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;neigh, std::vector&lt; std::vector&lt; float &gt; &gt; &amp;neigh_sq_dist, int selection_criteria)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00275">testNSearchLib.cpp:275</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testNSearchLib_8cpp_03_html_ae482c6acc7871249ddc81c25cb8bf32a"><div class="ttname"><a href="namespaceanonymous__namespace_02testNSearchLib_8cpp_03.html#ae482c6acc7871249ddc81c25cb8bf32a">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeSizetExcludeInclude</a></div><div class="ttdeci">double neighSearchTreeSizetExcludeInclude(const std::vector&lt; util::Point &gt; &amp;x, const std::vector&lt; size_t &gt; &amp;xTags, const std::unique_ptr&lt; NSearch &gt; &amp;nsearch, const double &amp;r, std::vector&lt; std::vector&lt; size_t &gt; &gt; &amp;neigh, std::vector&lt; std::vector&lt; float &gt; &gt; &amp;neigh_sq_dist, int selection_criteria)</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8cpp_source.html#l00175">testNSearchLib.cpp:175</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a1be814661212423357733173e30558ff"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a1be814661212423357733173e30558ff">test::testNSearchData::d_treeBuildTime</a></div><div class="ttdeci">double d_treeBuildTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00024">testNSearchLib.h:24</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a2269083be3b806c035ac9f8905037229"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a2269083be3b806c035ac9f8905037229">test::testNSearchData::d_defaultBruteSearchTime</a></div><div class="ttdeci">double d_defaultBruteSearchTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00028">testNSearchLib.h:28</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a28795d175c7092070fa033d214e2ac29"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a28795d175c7092070fa033d214e2ac29">test::testNSearchData::d_leafMaxSize</a></div><div class="ttdeci">int d_leafMaxSize</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00021">testNSearchLib.h:21</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a42c89960f0eabf1c25792805f6df82fe"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a42c89960f0eabf1c25792805f6df82fe">test::testNSearchData::d_includeNFlannSearchTime</a></div><div class="ttdeci">double d_includeNFlannSearchTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00027">testNSearchLib.h:27</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a53bd3dde35470c275dc82152ccab75a1"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a53bd3dde35470c275dc82152ccab75a1">test::testNSearchData::d_numTags</a></div><div class="ttdeci">int d_numTags</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00022">testNSearchLib.h:22</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a6ead962b7981b88b014ca3d7e2e87763"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a6ead962b7981b88b014ca3d7e2e87763">test::testNSearchData::d_excludeNFlannSearchTime</a></div><div class="ttdeci">double d_excludeNFlannSearchTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00026">testNSearchLib.h:26</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a7b875ddfcc86721b4cc964e0681eff00"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a7b875ddfcc86721b4cc964e0681eff00">test::testNSearchData::d_includeBruteSearchTime</a></div><div class="ttdeci">double d_includeBruteSearchTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00030">testNSearchLib.h:30</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_a7be70004d7abae3cd87e0ad60c830d33"><div class="ttname"><a href="structtest_1_1testNSearchData.html#a7be70004d7abae3cd87e0ad60c830d33">test::testNSearchData::d_numPoints</a></div><div class="ttdeci">int d_numPoints</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00023">testNSearchLib.h:23</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_acf68058900bb2eaf08379434d428b699"><div class="ttname"><a href="structtest_1_1testNSearchData.html#acf68058900bb2eaf08379434d428b699">test::testNSearchData::d_defaultNFlannSearchTime</a></div><div class="ttdeci">double d_defaultNFlannSearchTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00025">testNSearchLib.h:25</a></div></div>
<div class="ttc" id="astructtest_1_1testNSearchData_html_afad4fdb3a31c97cc480e86bd405e0824"><div class="ttname"><a href="structtest_1_1testNSearchData.html#afad4fdb3a31c97cc480e86bd405e0824">test::testNSearchData::d_excludeBruteSearchTime</a></div><div class="ttdeci">double d_excludeBruteSearchTime</div><div class="ttdef"><b>Definition</b> <a href="testNSearchLib_8h_source.html#l00029">testNSearchLib.h:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testNSearchLib_8cpp_source.html#l00095">anonymous_namespace{testNSearchLib.cpp}::assignRandomTags()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00408">anonymous_namespace{testNSearchLib.cpp}::compare_results()</a>, <a class="el" href="testNSearchLib_8h_source.html#l00028">test::testNSearchData::d_defaultBruteSearchTime</a>, <a class="el" href="testNSearchLib_8h_source.html#l00025">test::testNSearchData::d_defaultNFlannSearchTime</a>, <a class="el" href="testNSearchLib_8h_source.html#l00029">test::testNSearchData::d_excludeBruteSearchTime</a>, <a class="el" href="testNSearchLib_8h_source.html#l00026">test::testNSearchData::d_excludeNFlannSearchTime</a>, <a class="el" href="testNSearchLib_8h_source.html#l00030">test::testNSearchData::d_includeBruteSearchTime</a>, <a class="el" href="testNSearchLib_8h_source.html#l00027">test::testNSearchData::d_includeNFlannSearchTime</a>, <a class="el" href="testNSearchLib_8h_source.html#l00021">test::testNSearchData::d_leafMaxSize</a>, <a class="el" href="testNSearchLib_8h_source.html#l00023">test::testNSearchData::d_numPoints</a>, <a class="el" href="testNSearchLib_8h_source.html#l00022">test::testNSearchData::d_numTags</a>, <a class="el" href="testNSearchLib_8h_source.html#l00024">test::testNSearchData::d_treeBuildTime</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00054">anonymous_namespace{testNSearchLib.cpp}::lattice()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00236">anonymous_namespace{testNSearchLib.cpp}::neighSearchBrute()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00275">anonymous_namespace{testNSearchLib.cpp}::neighSearchBruteExcludeInclude()</a>, <a class="el" href="testNSearchLib_8cpp_source.html#l00141">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeSizet()</a>, and <a class="el" href="testNSearchLib_8cpp_source.html#l00175">anonymous_namespace{testNSearchLib.cpp}::neighSearchTreeSizetExcludeInclude()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a197262de1745b522497c1d1e58066215_cgraph.svg" width="680" height="554"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae165316fc718590c70e7cdc08a093568" name="ae165316fc718590c70e7cdc08a093568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae165316fc718590c70e7cdc08a093568">&#9670;&#160;</a></span>testPeriDEM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string test::testPeriDEM </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filepath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests PeriDEM model class. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filepath</td><td>Path where input file can be found (expects file 'input.yaml' in the filepath) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string 'pass' if test is successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="testPeriDEMLib_8cpp_source.html#l00023">23</a> of file <a class="el" href="testPeriDEMLib_8cpp_source.html">testPeriDEMLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                                              {</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>  <span class="comment">// current time</span></div>
<div class="line"><span class="lineno">   26</span>  <span class="keyword">auto</span> begin = steady_clock::now();</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  <span class="comment">// read input data</span></div>
<div class="line"><span class="lineno">   29</span>  <span class="keyword">auto</span> *deck = <span class="keyword">new</span> <a class="code hl_class" href="classinp_1_1Input.html">inp::Input</a>(filepath + <span class="stringliteral">&quot;/input.yaml&quot;</span>);</div>
<div class="line"><span class="lineno">   30</span>  deck-&gt;getOutputDeck()-&gt;d_path = filepath + <span class="stringliteral">&quot;/out/&quot;</span>;</div>
<div class="line"><span class="lineno">   31</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;filepath = &quot;</span> &lt;&lt; deck-&gt;getOutputDeck()-&gt;d_path &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>  <span class="comment">// check which model to run</span></div>
<div class="line"><span class="lineno">   34</span>  <span class="keywordflow">if</span> (deck-&gt;isPeriDEM()) {</div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_class" href="classmodel_1_1DEMModel.html">model::DEMModel</a> dem(deck);</div>
<div class="line"><span class="lineno">   36</span>    dem.run(deck);</div>
<div class="line"><span class="lineno">   37</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   38</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;PeriDEM model not found in input file.\n&quot;</span>;</div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;PeriDEM not found in input file&quot;</span>;</div>
<div class="line"><span class="lineno">   40</span>  }</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  <span class="comment">// get time elapsed</span></div>
<div class="line"><span class="lineno">   43</span>  <span class="keyword">auto</span> end = steady_clock::now();</div>
<div class="line"><span class="lineno">   44</span>  <span class="keywordtype">double</span> elapsed_secs = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(begin, end, <span class="stringliteral">&quot;seconds&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Total simulation time = &quot;</span> &lt;&lt; elapsed_secs</div>
<div class="line"><span class="lineno">   47</span>            &lt;&lt; <span class="stringliteral">&quot; (seconds)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordflow">return</span> <span class="stringliteral">&quot;pass&quot;</span>;</div>
<div class="line"><span class="lineno">   50</span>}</div>
<div class="ttc" id="aclassinp_1_1Input_html"><div class="ttname"><a href="classinp_1_1Input.html">inp::Input</a></div><div class="ttdoc">A class to read input file.</div><div class="ttdef"><b>Definition</b> <a href="input_8h_source.html#l00061">input.h:61</a></div></div>
<div class="ttc" id="aclassmodel_1_1DEMModel_html"><div class="ttname"><a href="classmodel_1_1DEMModel.html">model::DEMModel</a></div><div class="ttdoc">A class for discrete element particle simulation with peridynamic model</div><div class="ttdef"><b>Definition</b> <a href="demModel_8h_source.html#l00032">demModel.h:32</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="demModel_8cpp_source.html#l00068">model::DEMModel::run()</a>, and <a class="el" href="methods_8h_source.html#l00304">util::methods::timeDiff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testPeriDEM_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ae165316fc718590c70e7cdc08a093568_cgraph.svg" width="342" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ae165316fc718590c70e7cdc08a093568_icgraph.svg" width="236" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa82d825f0f2554452df66da03aee4a65" name="aa82d825f0f2554452df66da03aee4a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa82d825f0f2554452df66da03aee4a65">&#9670;&#160;</a></span>testQuadElem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testQuadElem </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filepath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on quadrature points on quadrangle elements. </p>
<p>This function performs accuracy test of the quadrature points for integration over reference triangle with vertices at {(0,0), (1,0), (0,1)}. List of tests are as follows:</p>
<ol type="1">
<li>Computes quadrature points of the given order, writes them to the file, and checks if the sum of quadrature weights is equal to 2, i.e. area of reference quadrangle element.</li>
</ol>
<p>Also tests the exactness of the integration of the polynomial upto given order. Suppose \( n\) is the order of quadrature point, then we test if the integration of the function \( f(s,t) = s^\alpha\, t^\beta \) is exact for \( \alpha \) and \( \beta \) such that \( \alpha+\beta \leq n \). The exact integration of function \( f\) over reference triangle is  </p><p class="formulaDsp">
\[ I_{exact} = \int_0^1 \int_0^{1-s} s^\alpha\, t^\beta \, dt\, ds =
\sum_{i=0}^{\beta+1} (-1)^i \frac{{{\beta + 1} \choose i}}{(\alpha + i +1)
(\beta + 1)},
\]
</p>
<p> where </p><p class="formulaDsp">
\[ {a \choose b} = \frac{a (a-1) (a-2) ... (a-b+1)}{1*2*3 ... *b}. \]
</p>
<p> We have \( {a \choose 0} = 1 \) so that term for \( i=0\) is not zero. Above formula gives the exact value of integral of \( f(s,t) = s^\alpha\, t^\beta \) over reference triangle. Approximation by quadrature point is as follows </p><p class="formulaDsp">
\[ I_{approx} = \sum_{q=1}^{Q} w_q f(s_q, t_q) \]
</p>
<p> where \(Q\) is the total number of quad points, \( w_q\) and \((s_q, t_q)\) are the \( q^{th} \) quad weight and point. In this test, we compare \( I_{exact} \) and \( I_{approx} \) and report problem if both do not match.</p>
<ol type="1">
<li>Test the accuracy for simple quadrangle mesh on square domain [0,1]^2. Exact integration of polynomial \( f(x,y) = x^\alpha \, y^\beta \) on \([0,1]^2\) is given by <p class="formulaDsp">
\[ I_{exact} = \frac{1}{(\alpha+1) (\beta+1)}. \]
</p>
 We compare above with the approximation computed from the quadrature points. We consider \(\alpha + \beta \leq n \) where \( n\) is the order of approximation we are testing.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Order of quadrature point approximation </td></tr>
    <tr><td class="paramname">filepath</td><td>Path where mesh data for test can be found (expects files 'quadMesh_nodes.csv' and 'quadMesh_elements.csv' inside the filepath) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00353">353</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  353</span>                                                    {</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  356</span>  <span class="comment">// Test1: We test accuracy of integrals of polynomials over reference</span></div>
<div class="line"><span class="lineno">  357</span>  <span class="comment">// quadrangle. Reference triangle {(-1,-1), (1,-1), (1,1), (-1,1)}.</span></div>
<div class="line"><span class="lineno">  358</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  359</span>  <span class="comment">// Test2: We consider simple mesh in meshFeTest.txt over square domain</span></div>
<div class="line"><span class="lineno">  360</span>  <span class="comment">// [0,1]^2 and test the accuracy of polynomials over square domain.</span></div>
<div class="line"><span class="lineno">  361</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  364</span>  <span class="keyword">auto</span> quad = <a class="code hl_class" href="classfe_1_1QuadElem.html">fe::QuadElem</a>(n);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  367</span>  <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  368</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  369</span>  <span class="keywordtype">size_t</span> error_test_1 = 0;</div>
<div class="line"><span class="lineno">  370</span>  {</div>
<div class="line"><span class="lineno">  371</span>    <span class="comment">// T1 (reference quadrangle)</span></div>
<div class="line"><span class="lineno">  372</span>    <span class="comment">// get quad points at reference triangle</span></div>
<div class="line"><span class="lineno">  373</span>    std::vector&lt;util::Point&gt; nodes = {</div>
<div class="line"><span class="lineno">  374</span>        <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., -1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., -1., 0.),</div>
<div class="line"><span class="lineno">  375</span>        <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., 1., 0.)};</div>
<div class="line"><span class="lineno">  376</span>    std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordtype">double</span> sum = 0.;</div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  379</span>      sum += qd.d_w;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordflow">if</span> (std::abs(sum - 4.0) &gt; <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">tol</a>) {</div>
<div class="line"><span class="lineno">  382</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Error in order = &quot;</span> &lt;&lt; n</div>
<div class="line"><span class="lineno">  383</span>                &lt;&lt; <span class="stringliteral">&quot;. Sum of quad weights is not &quot;</span></div>
<div class="line"><span class="lineno">  384</span>                   <span class="stringliteral">&quot;equal to area of reference &quot;</span></div>
<div class="line"><span class="lineno">  385</span>                   <span class="stringliteral">&quot;quadrangle.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  386</span>      error_test_1++;</div>
<div class="line"><span class="lineno">  387</span>    }</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// test the exactness of integration for polynomial</span></div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= 2 * n - 1; i++)</div>
<div class="line"><span class="lineno">  393</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= 2 * n - 1; j++) {</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  396</span>        <span class="comment">// when {(-1,-1), (1,-1), (1,1), (-1,1)}</span></div>
<div class="line"><span class="lineno">  397</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  398</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., -1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., -1., 0.),</div>
<div class="line"><span class="lineno">  399</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., 1., 0.)};</div>
<div class="line"><span class="lineno">  400</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  401</span>        <span class="comment">// test integration of polynomial f(s,t) = s^i t^j</span></div>
<div class="line"><span class="lineno">  402</span>        <span class="comment">// get the exact integration</span></div>
<div class="line"><span class="lineno">  403</span>        <span class="keywordtype">double</span> I_exact = <a class="code hl_function" href="namespacetest.html#a56b3ad312ab9aaa185b9b1507fbb1a43">test::getExactIntegrationRefQuad</a>(i, j);</div>
<div class="line"><span class="lineno">  404</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  405</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  408</span>        <span class="comment">// when {(-1,1), (-1,-1), (1,-1), (1,1)}</span></div>
<div class="line"><span class="lineno">  409</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  410</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., -1., 0.),</div>
<div class="line"><span class="lineno">  411</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., -1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.)};</div>
<div class="line"><span class="lineno">  412</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  413</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  414</span>        <span class="comment">// After changing the order of vertices, we have got a new</span></div>
<div class="line"><span class="lineno">  415</span>        <span class="comment">// triangle which is in coordinate system (x,y) and we are</span></div>
<div class="line"><span class="lineno">  416</span>        <span class="comment">// integrating function f(x,y) = x^i y^j</span></div>
<div class="line"><span class="lineno">  417</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  418</span>        <span class="comment">// The quad data we have got is such that quad point is in (x,y)</span></div>
<div class="line"><span class="lineno">  419</span>        <span class="comment">// coordinate, weight is such that determinant of the Jacobian is</span></div>
<div class="line"><span class="lineno">  420</span>        <span class="comment">// included in the weight.</span></div>
<div class="line"><span class="lineno">  421</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  422</span>        <span class="comment">// Thus the following method for I_approx is correct.</span></div>
<div class="line"><span class="lineno">  423</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  424</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  427</span>        <span class="comment">// when {(1,1), (-1,1), (-1,-1), (1,-1)}</span></div>
<div class="line"><span class="lineno">  428</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  429</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., 1., 0.),</div>
<div class="line"><span class="lineno">  430</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., -1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., -1., 0.)};</div>
<div class="line"><span class="lineno">  431</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  433</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  436</span>        <span class="comment">// when {(1,-1), (1,1), (-1,1), (-1,-1)}</span></div>
<div class="line"><span class="lineno">  437</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  438</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., -1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.),</div>
<div class="line"><span class="lineno">  439</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., -1., 0.)};</div>
<div class="line"><span class="lineno">  440</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  441</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  442</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  443</span>      }</div>
<div class="line"><span class="lineno">  444</span>  } <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  447</span>  <span class="comment">// Test 2</span></div>
<div class="line"><span class="lineno">  448</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordtype">size_t</span> error_test_2 = 0;</div>
<div class="line"><span class="lineno">  450</span>  {</div>
<div class="line"><span class="lineno">  451</span>    <span class="keyword">static</span> std::vector&lt;util::Point&gt; nodes;</div>
<div class="line"><span class="lineno">  452</span>    <span class="keyword">static</span> std::vector&lt;size_t&gt; elements;</div>
<div class="line"><span class="lineno">  453</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num_vertex = 4;</div>
<div class="line"><span class="lineno">  454</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> elem_type = <a class="code hl_variable" href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a>;</div>
<div class="line"><span class="lineno">  455</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num_elems = 0;</div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordflow">if</span> (num_elems == 0) {</div>
<div class="line"><span class="lineno">  457</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a7d6fdb37153e1d548efc6e79d9c61138">readNodes</a>(filepath + <span class="stringliteral">&quot;/quadMesh_nodes.csv&quot;</span>, nodes);</div>
<div class="line"><span class="lineno">  458</span>      num_elems = <a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a5a1fb22090fa2e6dceff4f43acc7a015">readElements</a>(filepath + <span class="stringliteral">&quot;/quadMesh_elements.csv&quot;</span>, elem_type,</div>
<div class="line"><span class="lineno">  459</span>                               elements);</div>
<div class="line"><span class="lineno">  460</span>    }</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    <span class="comment">// loop over polynomials</span></div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= 2 * n - 1; i++)</div>
<div class="line"><span class="lineno">  464</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= 2 * n - 1; j++) {</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordtype">double</span> I_exact = 1. / (double(i + 1) * double(j + 1));</div>
<div class="line"><span class="lineno">  467</span>        <span class="keywordtype">double</span> I_approx = 0.;</div>
<div class="line"><span class="lineno">  468</span>        <span class="comment">// loop over elements and compute I_approx</span></div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; num_elems; e++) {</div>
<div class="line"><span class="lineno">  470</span>          std::vector&lt;util::Point&gt; enodes = {</div>
<div class="line"><span class="lineno">  471</span>              nodes[elements[num_vertex * e + 0]],</div>
<div class="line"><span class="lineno">  472</span>              nodes[elements[num_vertex * e + 1]],</div>
<div class="line"><span class="lineno">  473</span>              nodes[elements[num_vertex * e + 2]],</div>
<div class="line"><span class="lineno">  474</span>              nodes[elements[num_vertex * e + 3]]};</div>
<div class="line"><span class="lineno">  475</span>          std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(enodes);</div>
<div class="line"><span class="lineno">  476</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  477</span>            I_approx +=</div>
<div class="line"><span class="lineno">  478</span>                qd.d_w * std::pow(qd.d_p.d_x, i) * std::pow(qd.d_p.d_y, j);</div>
<div class="line"><span class="lineno">  479</span>        }</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>        <span class="keywordflow">if</span> (std::abs(I_exact - I_approx) &gt; <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">tol</a>) {</div>
<div class="line"><span class="lineno">  482</span>          std::cout &lt;&lt; <span class="stringliteral">&quot;Error in order = &quot;</span> &lt;&lt; n</div>
<div class="line"><span class="lineno">  483</span>                    &lt;&lt; <span class="stringliteral">&quot;. Exact integration = &quot;</span> &lt;&lt; I_exact</div>
<div class="line"><span class="lineno">  484</span>                    &lt;&lt; <span class="stringliteral">&quot; and approximate integration = &quot;</span> &lt;&lt; I_approx</div>
<div class="line"><span class="lineno">  485</span>                    &lt;&lt; <span class="stringliteral">&quot; of polynomial of order (i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; + j = &quot;</span> &lt;&lt; j</div>
<div class="line"><span class="lineno">  486</span>                    &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span> &lt;&lt; i + j &lt;&lt; <span class="stringliteral">&quot; over square domain [0,1]x[0,1] &quot;</span></div>
<div class="line"><span class="lineno">  487</span>                    &lt;&lt; <span class="stringliteral">&quot;is not matching using quadrature points.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>          error_test_2++;</div>
<div class="line"><span class="lineno">  490</span>        }</div>
<div class="line"><span class="lineno">  491</span>      }</div>
<div class="line"><span class="lineno">  492</span>  }</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">  495</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  496</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Quadrangle Quadrature Test\n&quot;</span>;</div>
<div class="line"><span class="lineno">  497</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Quad order = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><span class="lineno">  500</span>  std::cout &lt;&lt; (error_test_1 == 0 ? <span class="stringliteral">&quot;TEST 1 : PASS. &quot;</span> : <span class="stringliteral">&quot;TEST 1 : FAIL. &quot;</span>);</div>
<div class="line"><span class="lineno">  501</span>  std::cout &lt;&lt; (error_test_2 == 0 ? <span class="stringliteral">&quot;TEST 2 : PASS. \n&quot;</span> : <span class="stringliteral">&quot;TEST 2 : FAIL. \n&quot;</span>);</div>
<div class="line"><span class="lineno">  502</span>}</div>
<div class="ttc" id="aclassfe_1_1QuadElem_html"><div class="ttname"><a href="classfe_1_1QuadElem.html">fe::QuadElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for bi-linear quadrangle element.</div><div class="ttdef"><b>Definition</b> <a href="quadElem_8h_source.html#l00064">quadElem.h:64</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga1ac9d70a30c6e341904dfa5fbb13f15c"><div class="ttname"><a href="group__GlobalVars.html#ga1ac9d70a30c6e341904dfa5fbb13f15c">util::vtk_type_quad</a></div><div class="ttdeci">static const int vtk_type_quad</div><div class="ttdoc">Integer flag for quad element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00067">feElementDefs.h:67</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testFeLib_8cpp_03_html_a220e1309400af680c76638df4d928e1d"><div class="ttname"><a href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">anonymous_namespace{testFeLib.cpp}::tol</a></div><div class="ttdeci">const double tol</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00027">testFeLib.cpp:27</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testFeLib_8cpp_03_html_a5a1fb22090fa2e6dceff4f43acc7a015"><div class="ttname"><a href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a5a1fb22090fa2e6dceff4f43acc7a015">anonymous_namespace{testFeLib.cpp}::readElements</a></div><div class="ttdeci">size_t readElements(const std::string &amp;filename, const size_t &amp;elem_type, std::vector&lt; size_t &gt; &amp;elements)</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00039">testFeLib.cpp:39</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testFeLib_8cpp_03_html_a7d6fdb37153e1d548efc6e79d9c61138"><div class="ttname"><a href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a7d6fdb37153e1d548efc6e79d9c61138">anonymous_namespace{testFeLib.cpp}::readNodes</a></div><div class="ttdeci">void readNodes(const std::string &amp;filename, std::vector&lt; util::Point &gt; &amp;nodes)</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00029">testFeLib.cpp:29</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testFeLib_8cpp_03_html_aa42cb29ac02063d90ab0ecc9acc9cfb0"><div class="ttname"><a href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">anonymous_namespace{testFeLib.cpp}::checkRefIntegration</a></div><div class="ttdeci">bool checkRefIntegration(const size_t &amp;n, const size_t &amp;i, const size_t &amp;j, const std::vector&lt; fe::QuadData &gt; &amp;qds, double &amp;I_exact)</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00078">testFeLib.cpp:78</a></div></div>
<div class="ttc" id="anamespacetest_html_a56b3ad312ab9aaa185b9b1507fbb1a43"><div class="ttname"><a href="namespacetest.html#a56b3ad312ab9aaa185b9b1507fbb1a43">test::getExactIntegrationRefQuad</a></div><div class="ttdeci">double getExactIntegrationRefQuad(size_t alpha, size_t beta)</div><div class="ttdoc">Computes integration of polynomial exactly over reference quadrangle.</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00163">testFeLib.cpp:163</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testFeLib_8cpp_source.html#l00078">anonymous_namespace{testFeLib.cpp}::checkRefIntegration()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00163">getExactIntegrationRefQuad()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00039">anonymous_namespace{testFeLib.cpp}::readElements()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00029">anonymous_namespace{testFeLib.cpp}::readNodes()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00027">anonymous_namespace{testFeLib.cpp}::tol</a>, and <a class="el" href="feElementDefs_8h_source.html#l00067">util::vtk_type_quad</a>.</p>

<p class="reference">Referenced by <a class="el" href="testFe_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_aa82d825f0f2554452df66da03aee4a65_cgraph.svg" width="395" height="259"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_aa82d825f0f2554452df66da03aee4a65_icgraph.svg" width="244" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad42bc7bd3da5dce5ed3624b8fca7585f" name="ad42bc7bd3da5dce5ed3624b8fca7585f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42bc7bd3da5dce5ed3624b8fca7585f">&#9670;&#160;</a></span>testTaskflow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string test::testTaskflow </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on taskflow. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">N</td><td>size of vector to profile taskflow </td></tr>
    <tr><td class="paramname">seed</td><td>Seed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>str String containing various information </dd></dl>

<p class="definition">Definition at line <a class="el" href="testParallelCompLib_8cpp_source.html#l00222">222</a> of file <a class="el" href="testParallelCompLib_8cpp_source.html">testParallelCompLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  222</span>                                               {</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <span class="keyword">auto</span> nThreads = <a class="code hl_function" href="namespaceutil_1_1parallel.html#a4ad550a438091fb9cd924783e690764d">util::parallel::getNThreads</a>();</div>
<div class="line"><span class="lineno">  225</span>  <a class="code hl_function" href="namespaceutil_1_1io.html#a578a578ce41389fb01e56de7316b7054">util::io::print</a>(fmt::format(<span class="stringliteral">&quot;\n\ntestTaskflow(): Number of threads = {}\n\n&quot;</span>, nThreads));</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>  <span class="comment">// task: perform N computations in serial and using taskflow for_each</span></div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>  <span class="comment">// generate vector of random numbers</span></div>
<div class="line"><span class="lineno">  230</span>  <a class="code hl_typedef" href="randomDist_8h.html#ad2921d82dbe38f8ffcb877890e1cdc17">RandGenerator</a> gen(<a class="code hl_function" href="namespaceutil.html#afcff5a3416f12b7e3c727dae52c5523a">util::get_rd_gen</a>(seed));</div>
<div class="line"><span class="lineno">  231</span>  <span class="keyword">auto</span> dist = <a class="code hl_class" href="classutil_1_1DistributionSample.html">util::DistributionSample&lt;UniformDistribution&gt;</a>(0., 1., seed);</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>  std::vector&lt;double&gt; x(N);</div>
<div class="line"><span class="lineno">  234</span>  std::vector&lt;double&gt; y1(N);</div>
<div class="line"><span class="lineno">  235</span>  std::vector&lt;double&gt; y2(N);</div>
<div class="line"><span class="lineno">  236</span>  std::generate(std::begin(x), std::end(x), [&amp;] { <span class="keywordflow">return</span> dist(); });</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>  <span class="comment">// now do serial calculation</span></div>
<div class="line"><span class="lineno">  239</span>  <span class="keyword">auto</span> t1 = steady_clock::now();</div>
<div class="line"><span class="lineno">  240</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; i++) {</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">if</span> (x[i] &lt; 0.5)</div>
<div class="line"><span class="lineno">  242</span>      y1[i] = <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a0dc86d40c3cdcb2716b64409b35fe083">f1</a>(x[i]);</div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  244</span>      y1[i] = <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a6aed51239122cccafd88a211ddca782f">f2</a>(x[i]);</div>
<div class="line"><span class="lineno">  245</span>  }</div>
<div class="line"><span class="lineno">  246</span>  <span class="keyword">auto</span> t2 = steady_clock::now();</div>
<div class="line"><span class="lineno">  247</span>  <span class="keyword">auto</span> dt12 = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t1, t2, <span class="stringliteral">&quot;microseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>  <span class="comment">// now do parallel calculation using taskflow</span></div>
<div class="line"><span class="lineno">  250</span>  tf::Executor executor(nThreads);</div>
<div class="line"><span class="lineno">  251</span>  tf::Taskflow taskflow;</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>  taskflow.for_each_index((std::size_t) 0, N, (std::size_t) 1, [&amp;x, &amp;y2](std::size_t i) {</div>
<div class="line"><span class="lineno">  254</span>      <span class="keywordflow">if</span> (x[i] &lt; 0.5)</div>
<div class="line"><span class="lineno">  255</span>        y2[i] = <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a0dc86d40c3cdcb2716b64409b35fe083">f1</a>(x[i]);</div>
<div class="line"><span class="lineno">  256</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  257</span>        y2[i] = <a class="code hl_function" href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a6aed51239122cccafd88a211ddca782f">f2</a>(x[i]);</div>
<div class="line"><span class="lineno">  258</span>                          }</div>
<div class="line"><span class="lineno">  259</span>  ); <span class="comment">// for_each</span></div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>  executor.run(taskflow).get();</div>
<div class="line"><span class="lineno">  262</span>  <span class="keyword">auto</span> t3 = steady_clock::now();</div>
<div class="line"><span class="lineno">  263</span>  <span class="keyword">auto</span> dt23 = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t2, t3, <span class="stringliteral">&quot;microseconds&quot;</span>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>  <span class="comment">// compare results</span></div>
<div class="line"><span class="lineno">  266</span>  <span class="keywordtype">double</span> y_err = 0.;</div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;N; i++)</div>
<div class="line"><span class="lineno">  268</span>    y_err += std::pow(y1[i] - y2[i], 2);</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  <span class="keywordflow">if</span> (y_err &gt; 1.e-10) {</div>
<div class="line"><span class="lineno">  271</span>    std::cerr &lt;&lt; fmt::format(<span class="stringliteral">&quot;Error: Serial and taskflow computation results do not match (squared error = {})\n&quot;</span>,</div>
<div class="line"><span class="lineno">  272</span>                            y_err);</div>
<div class="line"><span class="lineno">  273</span>    exit(1);</div>
<div class="line"><span class="lineno">  274</span>  }</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>  <span class="comment">// get time</span></div>
<div class="line"><span class="lineno">  277</span>  std::ostringstream msg;</div>
<div class="line"><span class="lineno">  278</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Serial computation took = {}ms\n&quot;</span>, dt12);</div>
<div class="line"><span class="lineno">  279</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Taskflow computation took = {}ms\n&quot;</span>, dt23);</div>
<div class="line"><span class="lineno">  280</span>  msg &lt;&lt; fmt::format(<span class="stringliteral">&quot;  Speed-up factor = {}\n\n\n&quot;</span>, dt12/dt23);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>  <span class="keywordflow">return</span> msg.str();</div>
<div class="line"><span class="lineno">  283</span>}</div>
<div class="ttc" id="aclassutil_1_1DistributionSample_html"><div class="ttname"><a href="classutil_1_1DistributionSample.html">util::DistributionSample</a></div><div class="ttdoc">Templated probability distribution.</div><div class="ttdef"><b>Definition</b> <a href="randomDist_8h_source.html#l00090">randomDist.h:90</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testParallelCompLib_8cpp_03_html_a6aed51239122cccafd88a211ddca782f"><div class="ttname"><a href="namespaceanonymous__namespace_02testParallelCompLib_8cpp_03.html#a6aed51239122cccafd88a211ddca782f">anonymous_namespace{testParallelCompLib.cpp}::f2</a></div><div class="ttdeci">double f2(const double &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="testParallelCompLib_8cpp_source.html#l00049">testParallelCompLib.cpp:49</a></div></div>
<div class="ttc" id="anamespaceutil_1_1parallel_html_a4ad550a438091fb9cd924783e690764d"><div class="ttname"><a href="namespaceutil_1_1parallel.html#a4ad550a438091fb9cd924783e690764d">util::parallel::getNThreads</a></div><div class="ttdeci">unsigned int getNThreads()</div><div class="ttdoc">Get number of threads to be used by taskflow.</div><div class="ttdef"><b>Definition</b> <a href="parallelUtil_8cpp_source.html#l00116">parallelUtil.cpp:116</a></div></div>
<div class="ttc" id="anamespaceutil_html_afcff5a3416f12b7e3c727dae52c5523a"><div class="ttname"><a href="namespaceutil.html#afcff5a3416f12b7e3c727dae52c5523a">util::get_rd_gen</a></div><div class="ttdeci">RandGenerator get_rd_gen(int seed=-1)</div><div class="ttdoc">Return random number generator.</div><div class="ttdef"><b>Definition</b> <a href="randomDist_8h_source.html#l00030">randomDist.h:30</a></div></div>
<div class="ttc" id="arandomDist_8h_html_ad2921d82dbe38f8ffcb877890e1cdc17"><div class="ttname"><a href="randomDist_8h.html#ad2921d82dbe38f8ffcb877890e1cdc17">RandGenerator</a></div><div class="ttdeci">std::mt19937 RandGenerator</div><div class="ttdef"><b>Definition</b> <a href="randomDist_8h_source.html#l00016">randomDist.h:16</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testParallelCompLib_8cpp_source.html#l00045">anonymous_namespace{testParallelCompLib.cpp}::f1()</a>, <a class="el" href="testParallelCompLib_8cpp_source.html#l00049">anonymous_namespace{testParallelCompLib.cpp}::f2()</a>, <a class="el" href="randomDist_8h_source.html#l00030">util::get_rd_gen()</a>, <a class="el" href="parallelUtil_8cpp_source.html#l00116">util::parallel::getNThreads()</a>, <a class="el" href="io_8h_source.html#l00108">util::io::print()</a>, and <a class="el" href="methods_8h_source.html#l00304">util::methods::timeDiff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testParallelComp_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ad42bc7bd3da5dce5ed3624b8fca7585f_cgraph.svg" width="955" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ad42bc7bd3da5dce5ed3624b8fca7585f_icgraph.svg" width="236" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa7c71a77ba3a1a442ebad77cbb0bc242" name="aa7c71a77ba3a1a442ebad77cbb0bc242"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7c71a77ba3a1a442ebad77cbb0bc242">&#9670;&#160;</a></span>testTetElem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testTetElem </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filepath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on quadrature points on tetrahedral elements. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Order of quadrature point approximation </td></tr>
    <tr><td class="paramname">filepath</td><td>Path where mesh data for test can be found (expects files 'tetMesh_nodes.csv' and 'tetMesh_elements.csv' inside the filepath) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00577">577</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  577</span>                                                   {</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  580</span>  <span class="comment">// Test1: We test accuracy of integrals of polynomials over reference</span></div>
<div class="line"><span class="lineno">  581</span>  <span class="comment">// tetrahedron. Reference element {(0,0,0), (1,0,0), (0,1,0), (0,0,1)}.</span></div>
<div class="line"><span class="lineno">  582</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  583</span>  <span class="comment">// Test2: We consider simple mesh in meshFeTest.txt over cubic domain</span></div>
<div class="line"><span class="lineno">  584</span>  <span class="comment">// [0,1]^3 and test the accuracy of polynomials over cubic domain.</span></div>
<div class="line"><span class="lineno">  585</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  588</span>  <span class="keyword">auto</span> quad = <a class="code hl_class" href="classfe_1_1TetElem.html">fe::TetElem</a>(n);</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  591</span>  <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  592</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordtype">size_t</span> error_test_1 = 0;</div>
<div class="line"><span class="lineno">  594</span>  {</div>
<div class="line"><span class="lineno">  595</span>    <span class="comment">// T1 (reference triangle)</span></div>
<div class="line"><span class="lineno">  596</span>    <span class="comment">// get quad points at reference triangle</span></div>
<div class="line"><span class="lineno">  597</span>    std::vector&lt;util::Point&gt; nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.),</div>
<div class="line"><span class="lineno">  598</span>                                       <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.),</div>
<div class="line"><span class="lineno">  599</span>                                       <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.)};</div>
<div class="line"><span class="lineno">  600</span>    std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordtype">double</span> sum = 0.;</div>
<div class="line"><span class="lineno">  603</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  604</span>      sum += qd.d_w;</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">if</span> (std::abs(sum - 1. / 6.) &gt; <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">tol</a>) {</div>
<div class="line"><span class="lineno">  607</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Error in order = &quot;</span> &lt;&lt; n</div>
<div class="line"><span class="lineno">  608</span>                &lt;&lt; <span class="stringliteral">&quot;. Sum of quad weights is not &quot;</span></div>
<div class="line"><span class="lineno">  609</span>                   <span class="stringliteral">&quot;equal to volume of reference &quot;</span></div>
<div class="line"><span class="lineno">  610</span>                   <span class="stringliteral">&quot;tetrahedron.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  611</span>      error_test_1++;</div>
<div class="line"><span class="lineno">  612</span>    }</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  615</span>    <span class="comment">// test the exactness of integration for polynomial</span></div>
<div class="line"><span class="lineno">  616</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= n; i++)</div>
<div class="line"><span class="lineno">  618</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= n; j++)</div>
<div class="line"><span class="lineno">  619</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt;= n; k++) {</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>          <span class="keywordflow">if</span> (i + j + k &gt; n)</div>
<div class="line"><span class="lineno">  622</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  625</span>          <span class="comment">// +ve order of indices are:</span></div>
<div class="line"><span class="lineno">  626</span>          <span class="comment">// {0,1,2,3}; {1,2,0,3}; {2,3,0,1}; {0,3,1,2}</span></div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  629</span>          <span class="comment">// when {(0,0,0), (1,0,0), (0,1,0), (0,0,1)}</span></div>
<div class="line"><span class="lineno">  630</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  631</span>          nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.),</div>
<div class="line"><span class="lineno">  632</span>                   <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.)};</div>
<div class="line"><span class="lineno">  633</span>          qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  634</span>          <span class="comment">// test integration of polynomial f(s,t) = s^i t^j</span></div>
<div class="line"><span class="lineno">  635</span>          <span class="comment">// get the exact integration</span></div>
<div class="line"><span class="lineno">  636</span>          <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#afd6fd93513908247402cbf5f5eb17c79">debug_id</a> = 0;</div>
<div class="line"><span class="lineno">  637</span>          <span class="keywordtype">double</span> I_exact = <a class="code hl_function" href="namespacetest.html#af43e065c49520ee624134a11bdfe3643">test::getExactIntegrationRefTet</a>(i, j, k);</div>
<div class="line"><span class="lineno">  638</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, k, qds, I_exact)) {</div>
<div class="line"><span class="lineno">  639</span>            error_test_1++;</div>
<div class="line"><span class="lineno">  640</span>          }</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  643</span>          <span class="comment">// when vertices are {(1,0,0), (0,1,0), (0,0,1), (0,0,0)}</span></div>
<div class="line"><span class="lineno">  644</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  645</span>          nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.),</div>
<div class="line"><span class="lineno">  646</span>                   <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.)};</div>
<div class="line"><span class="lineno">  647</span>          qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  648</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  649</span>          <span class="comment">// After changing the order of vertices, we have got a new</span></div>
<div class="line"><span class="lineno">  650</span>          <span class="comment">// triangle which is in coordinate system (x,y) and we are</span></div>
<div class="line"><span class="lineno">  651</span>          <span class="comment">// integrating function f(x,y) = x^i y^j</span></div>
<div class="line"><span class="lineno">  652</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  653</span>          <span class="comment">// The quad data we have got is such that quad point is in (x,y)</span></div>
<div class="line"><span class="lineno">  654</span>          <span class="comment">// coordinate, weight is such that determinant of the Jacobian is</span></div>
<div class="line"><span class="lineno">  655</span>          <span class="comment">// included in the weight.</span></div>
<div class="line"><span class="lineno">  656</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  657</span>          <span class="comment">// Thus the following method for I_approx is correct.</span></div>
<div class="line"><span class="lineno">  658</span>          <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#afd6fd93513908247402cbf5f5eb17c79">debug_id</a> = 1;</div>
<div class="line"><span class="lineno">  659</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, k, qds, I_exact))</div>
<div class="line"><span class="lineno">  660</span>            error_test_1++;</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  663</span>          <span class="comment">// when vertices are {(0,1,0), (0,0,1), (0,0,0), (1,0,0)}</span></div>
<div class="line"><span class="lineno">  664</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  665</span>          nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.),</div>
<div class="line"><span class="lineno">  666</span>                   <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.)};</div>
<div class="line"><span class="lineno">  667</span>          qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  668</span>          <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#afd6fd93513908247402cbf5f5eb17c79">debug_id</a> = 2;</div>
<div class="line"><span class="lineno">  669</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, k, qds, I_exact))</div>
<div class="line"><span class="lineno">  670</span>            error_test_1++;</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  673</span>          <span class="comment">// when vertices are {(0,0,1), (0,0,0), (1,0,0), (0,1,0)}</span></div>
<div class="line"><span class="lineno">  674</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno">  675</span>          nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.),</div>
<div class="line"><span class="lineno">  676</span>                   <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.)};</div>
<div class="line"><span class="lineno">  677</span>          qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  678</span>          <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#afd6fd93513908247402cbf5f5eb17c79">debug_id</a> = 3;</div>
<div class="line"><span class="lineno">  679</span>          <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, k, qds, I_exact))</div>
<div class="line"><span class="lineno">  680</span>            error_test_1++;</div>
<div class="line"><span class="lineno">  681</span>        }</div>
<div class="line"><span class="lineno">  682</span>  } <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  685</span>  <span class="comment">// Test 2</span></div>
<div class="line"><span class="lineno">  686</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  687</span>  <span class="keywordtype">size_t</span> error_test_2 = 0;</div>
<div class="line"><span class="lineno">  688</span>  <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  689</span>    <span class="keyword">static</span> std::vector&lt;util::Point&gt; nodes;</div>
<div class="line"><span class="lineno">  690</span>    <span class="keyword">static</span> std::vector&lt;size_t&gt; elements;</div>
<div class="line"><span class="lineno">  691</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num_vertex = 4;</div>
<div class="line"><span class="lineno">  692</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> elem_type = <a class="code hl_variable" href="group__GlobalVars.html#ga59139fde535d8d4b7b8ff2ed36b4f17b">util::vtk_type_tetra</a>;</div>
<div class="line"><span class="lineno">  693</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num_elems = 0;</div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordflow">if</span> (num_elems == 0) {</div>
<div class="line"><span class="lineno">  695</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a7d6fdb37153e1d548efc6e79d9c61138">readNodes</a>(filepath + <span class="stringliteral">&quot;tetMesh_nodes.csv&quot;</span>, nodes);</div>
<div class="line"><span class="lineno">  696</span>      num_elems = <a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a5a1fb22090fa2e6dceff4f43acc7a015">readElements</a>(filepath + <span class="stringliteral">&quot;tetMesh_elements.csv&quot;</span>, elem_type,</div>
<div class="line"><span class="lineno">  697</span>                               elements);</div>
<div class="line"><span class="lineno">  698</span>    }</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>    <span class="comment">// loop over polynomials</span></div>
<div class="line"><span class="lineno">  701</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= n; i++)</div>
<div class="line"><span class="lineno">  702</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= n; j++)</div>
<div class="line"><span class="lineno">  703</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt;= n; k++) {</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>          <span class="keywordflow">if</span> (i + j + k &gt; n)</div>
<div class="line"><span class="lineno">  706</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>          <span class="keywordtype">double</span> I_exact = 1. / (double(i + 1) * double(j + 1) * double(k + 1));</div>
<div class="line"><span class="lineno">  709</span>          <span class="keywordtype">double</span> I_approx = 0.;</div>
<div class="line"><span class="lineno">  710</span>          <span class="comment">// loop over elements and compute I_approx</span></div>
<div class="line"><span class="lineno">  711</span>          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; num_elems; e++) {</div>
<div class="line"><span class="lineno">  712</span>            std::vector&lt;util::Point&gt; enodes = {</div>
<div class="line"><span class="lineno">  713</span>                nodes[elements[num_vertex * e + 0]],</div>
<div class="line"><span class="lineno">  714</span>                nodes[elements[num_vertex * e + 1]],</div>
<div class="line"><span class="lineno">  715</span>                nodes[elements[num_vertex * e + 2]],</div>
<div class="line"><span class="lineno">  716</span>                nodes[elements[num_vertex * e + 3]]};</div>
<div class="line"><span class="lineno">  717</span>            std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(enodes);</div>
<div class="line"><span class="lineno">  718</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds) {</div>
<div class="line"><span class="lineno">  719</span>              I_approx += qd.d_w * std::pow(qd.d_p.d_x, i) *</div>
<div class="line"><span class="lineno">  720</span>                          std::pow(qd.d_p.d_y, j) * std::pow(qd.d_p.d_z, k);</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>              <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Print &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  725</span>                std::cout &lt;&lt; <a class="code hl_function" href="namespaceutil_1_1io.html#a3e537e3bd778616255015cde6e60a30a">util::io::printStr</a>(enodes) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  726</span>                std::vector&lt;size_t&gt; enode_ids = {</div>
<div class="line"><span class="lineno">  727</span>                      elements[num_vertex * e + 0],</div>
<div class="line"><span class="lineno">  728</span>                      elements[num_vertex * e + 1],</div>
<div class="line"><span class="lineno">  729</span>                      elements[num_vertex * e + 2],</div>
<div class="line"><span class="lineno">  730</span>                      elements[num_vertex * e + 3]};</div>
<div class="line"><span class="lineno">  731</span>                std::cout &lt;&lt; <a class="code hl_function" href="namespaceutil_1_1io.html#a3e537e3bd778616255015cde6e60a30a">util::io::printStr</a>(enode_ids) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  732</span>                std::cout &lt;&lt; qd.printStr() &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  733</span>              }</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>            }</div>
<div class="line"><span class="lineno">  736</span>          }</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>          <span class="keywordflow">if</span> (std::abs(I_exact - I_approx) &gt; <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">tol</a>) {</div>
<div class="line"><span class="lineno">  739</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Error in order = &quot;</span> &lt;&lt; n</div>
<div class="line"><span class="lineno">  740</span>                      &lt;&lt; <span class="stringliteral">&quot;. Exact integration = &quot;</span> &lt;&lt; I_exact</div>
<div class="line"><span class="lineno">  741</span>                      &lt;&lt; <span class="stringliteral">&quot; and approximate integration = &quot;</span> &lt;&lt; I_approx</div>
<div class="line"><span class="lineno">  742</span>                      &lt;&lt; <span class="stringliteral">&quot; of polynomial of order (i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; + j = &quot;</span> &lt;&lt; j</div>
<div class="line"><span class="lineno">  743</span>                      &lt;&lt; <span class="stringliteral">&quot; + k = &quot;</span> &lt;&lt; k &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span> &lt;&lt; i + j + k</div>
<div class="line"><span class="lineno">  744</span>                      &lt;&lt; <span class="stringliteral">&quot; over cubic domain [0,1]x[0,1]x[0,1] &quot;</span></div>
<div class="line"><span class="lineno">  745</span>                      &lt;&lt; <span class="stringliteral">&quot;is not matching using quadrature points.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>            error_test_2++;</div>
<div class="line"><span class="lineno">  748</span>          }</div>
<div class="line"><span class="lineno">  749</span>        }</div>
<div class="line"><span class="lineno">  750</span>  }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>  <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">  753</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  754</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Tetrahedron Quadrature Test\n&quot;</span>;</div>
<div class="line"><span class="lineno">  755</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  756</span>  }</div>
<div class="line"><span class="lineno">  757</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Quad order = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><span class="lineno">  758</span>  <span class="keywordflow">if</span> (error_test_1 == 0)</div>
<div class="line"><span class="lineno">  759</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;TEST 1 : PASS. &quot;</span>;</div>
<div class="line"><span class="lineno">  760</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  761</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;TEST 1 : FAIL. &quot;</span>;</div>
<div class="line"><span class="lineno">  762</span>  <span class="comment">//  if (error_test_2 == 0)</span></div>
<div class="line"><span class="lineno">  763</span>  <span class="comment">//    std::cout &lt;&lt; &quot;TEST 2 : PASS. &quot;;</span></div>
<div class="line"><span class="lineno">  764</span>  <span class="comment">//  else</span></div>
<div class="line"><span class="lineno">  765</span>  <span class="comment">//    std::cout &lt;&lt; &quot;TEST 2 : FAIL. &quot;;</span></div>
<div class="line"><span class="lineno">  766</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  767</span>}</div>
<div class="ttc" id="aclassfe_1_1TetElem_html"><div class="ttname"><a href="classfe_1_1TetElem.html">fe::TetElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for linear tetrahedron element.</div><div class="ttdef"><b>Definition</b> <a href="tetElem_8h_source.html#l00141">tetElem.h:141</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga59139fde535d8d4b7b8ff2ed36b4f17b"><div class="ttname"><a href="group__GlobalVars.html#ga59139fde535d8d4b7b8ff2ed36b4f17b">util::vtk_type_tetra</a></div><div class="ttdeci">static const int vtk_type_tetra</div><div class="ttdoc">Integer flag for tetrahedron element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00070">feElementDefs.h:70</a></div></div>
<div class="ttc" id="anamespaceanonymous__namespace_02testFeLib_8cpp_03_html_afd6fd93513908247402cbf5f5eb17c79"><div class="ttname"><a href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#afd6fd93513908247402cbf5f5eb17c79">anonymous_namespace{testFeLib.cpp}::debug_id</a></div><div class="ttdeci">int debug_id</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00026">testFeLib.cpp:26</a></div></div>
<div class="ttc" id="anamespacetest_html_af43e065c49520ee624134a11bdfe3643"><div class="ttname"><a href="namespacetest.html#af43e065c49520ee624134a11bdfe3643">test::getExactIntegrationRefTet</a></div><div class="ttdeci">double getExactIntegrationRefTet(size_t alpha, size_t beta, size_t theta)</div><div class="ttdoc">Computes integration of polynomial exactly over reference tetrahedral.</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00172">testFeLib.cpp:172</a></div></div>
<div class="ttc" id="anamespaceutil_1_1io_html_a3e537e3bd778616255015cde6e60a30a"><div class="ttname"><a href="namespaceutil_1_1io.html#a3e537e3bd778616255015cde6e60a30a">util::io::printStr</a></div><div class="ttdeci">std::string printStr(const T &amp;msg, int nt=print_default_tab)</div><div class="ttdoc">Returns formatted string for output.</div><div class="ttdef"><b>Definition</b> <a href="io_8h_source.html#l00054">io.h:54</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testFeLib_8cpp_source.html#l00078">anonymous_namespace{testFeLib.cpp}::checkRefIntegration()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00026">anonymous_namespace{testFeLib.cpp}::debug_id</a>, <a class="el" href="testFeLib_8cpp_source.html#l00172">getExactIntegrationRefTet()</a>, <a class="el" href="io_8h_source.html#l00054">util::io::printStr()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00039">anonymous_namespace{testFeLib.cpp}::readElements()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00029">anonymous_namespace{testFeLib.cpp}::readNodes()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00027">anonymous_namespace{testFeLib.cpp}::tol</a>, and <a class="el" href="feElementDefs_8h_source.html#l00070">util::vtk_type_tetra</a>.</p>

<p class="reference">Referenced by <a class="el" href="testFe_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_aa7c71a77ba3a1a442ebad77cbb0bc242_cgraph.svg" width="566" height="310"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_aa7c71a77ba3a1a442ebad77cbb0bc242_icgraph.svg" width="232" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad46ca3f06841d1eebe364386b4bf889d" name="ad46ca3f06841d1eebe364386b4bf889d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad46ca3f06841d1eebe364386b4bf889d">&#9670;&#160;</a></span>testTransform()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testTransform </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on Fracture class and check if bitwise functions are working correctly. </p>

<p class="definition">Definition at line <a class="el" href="testParticleLib_8cpp_source.html#l00019">19</a> of file <a class="el" href="testParticleLib_8cpp_source.html">testParticleLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   19</span>                         {</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span>  <span class="keywordtype">bool</span> test_result = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   22</span> </div>
<div class="line"><span class="lineno">   23</span>  <span class="comment">// test translation</span></div>
<div class="line"><span class="lineno">   24</span>  <span class="keywordtype">double</span> scale = 1.0;</div>
<div class="line"><span class="lineno">   25</span>  <span class="keywordtype">double</span> theta = 0.;</div>
<div class="line"><span class="lineno">   26</span>  <span class="keyword">auto</span> xt = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.);</div>
<div class="line"><span class="lineno">   27</span>  <span class="keyword">auto</span> t1 = <a class="code hl_struct" href="structparticle_1_1ParticleTransform.html">particle::ParticleTransform</a>(xt, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.), theta, scale);</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>  <span class="keyword">auto</span> xold = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.);</div>
<div class="line"><span class="lineno">   30</span>  <span class="keyword">auto</span> xnew = t1.apply(xold);</div>
<div class="line"><span class="lineno">   31</span>  <span class="keyword">auto</span> xnew_check = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>( xold.d_x + 1., xold.d_y + 1., xold.d_z);</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;xold = (&quot;</span> &lt;&lt; xold.d_x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xold.d_y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xold.d_z</div>
<div class="line"><span class="lineno">   34</span>            &lt;&lt; <span class="stringliteral">&quot;), xnew = (&quot;</span> &lt;&lt; xnew.d_x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xnew.d_y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xnew.d_z</div>
<div class="line"><span class="lineno">   35</span>            &lt;&lt; <span class="stringliteral">&quot;), distance = &quot;</span> &lt;&lt; xnew_check.dist(xnew) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordflow">if</span> (xnew_check.dist(xnew) &gt; 1.0E-8) {</div>
<div class="line"><span class="lineno">   37</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Error\n&quot;</span>;</div>
<div class="line"><span class="lineno">   38</span>    test_result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   39</span>  }</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="comment">// test rotation</span></div>
<div class="line"><span class="lineno">   42</span>  scale = 1.0;</div>
<div class="line"><span class="lineno">   43</span>  theta = M_PI / 6;</div>
<div class="line"><span class="lineno">   44</span>  xt = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.);</div>
<div class="line"><span class="lineno">   45</span>  <span class="keyword">auto</span> t2 =</div>
<div class="line"><span class="lineno">   46</span>      <a class="code hl_struct" href="structparticle_1_1ParticleTransform.html">particle::ParticleTransform</a>(xt, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.), theta, scale);</div>
<div class="line"><span class="lineno">   47</span>  xold = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0.5, 0.2, 0.);</div>
<div class="line"><span class="lineno">   48</span>  xnew = t2.apply(xold);</div>
<div class="line"><span class="lineno">   49</span>  xnew_check = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(</div>
<div class="line"><span class="lineno">   50</span>      xold.d_x * std::cos(theta) - xold.d_y * std::sin(theta),</div>
<div class="line"><span class="lineno">   51</span>      xold.d_x * std::sin(theta) + xold.d_y * std::cos(theta), 0.);</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;xold = (&quot;</span> &lt;&lt; xold.d_x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xold.d_y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xold.d_z</div>
<div class="line"><span class="lineno">   54</span>            &lt;&lt; <span class="stringliteral">&quot;), xnew = (&quot;</span> &lt;&lt; xnew.d_x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xnew.d_y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xnew.d_z</div>
<div class="line"><span class="lineno">   55</span>            &lt;&lt; <span class="stringliteral">&quot;), distance = &quot;</span> &lt;&lt; xnew_check.dist(xnew) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   56</span>  <span class="keywordflow">if</span> (xnew_check.dist(xnew) &gt; 1.0E-8) {</div>
<div class="line"><span class="lineno">   57</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Error\n&quot;</span>;</div>
<div class="line"><span class="lineno">   58</span>    test_result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   59</span>  }</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  <span class="comment">// test scale and rotation</span></div>
<div class="line"><span class="lineno">   62</span>  scale = 0.5;</div>
<div class="line"><span class="lineno">   63</span>  theta = M_PI / 3;</div>
<div class="line"><span class="lineno">   64</span>  xt = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.);</div>
<div class="line"><span class="lineno">   65</span>  <span class="keyword">auto</span> t3 =</div>
<div class="line"><span class="lineno">   66</span>      <a class="code hl_struct" href="structparticle_1_1ParticleTransform.html">particle::ParticleTransform</a>(xt, <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.), theta,</div>
<div class="line"><span class="lineno">   67</span>          scale);</div>
<div class="line"><span class="lineno">   68</span>  xold = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0.2, 0.4, 0.);</div>
<div class="line"><span class="lineno">   69</span>  xnew = t3.apply(xold);</div>
<div class="line"><span class="lineno">   70</span>  xnew_check = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(</div>
<div class="line"><span class="lineno">   71</span>      scale * xold.d_x * std::cos(theta) - scale * xold.d_y * std::sin(theta),</div>
<div class="line"><span class="lineno">   72</span>      scale * xold.d_x * std::sin(theta) + scale * xold.d_y * std::cos(theta), 0.);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;xold = (&quot;</span> &lt;&lt; xold.d_x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xold.d_y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xold.d_z</div>
<div class="line"><span class="lineno">   75</span>            &lt;&lt; <span class="stringliteral">&quot;), xnew = (&quot;</span> &lt;&lt; xnew.d_x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xnew.d_y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xnew.d_z</div>
<div class="line"><span class="lineno">   76</span>            &lt;&lt; <span class="stringliteral">&quot;), distance = &quot;</span> &lt;&lt; xnew_check.dist(xnew) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">if</span> (xnew_check.dist(xnew) &gt; 1.0E-8) {</div>
<div class="line"><span class="lineno">   78</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Error\n&quot;</span>;</div>
<div class="line"><span class="lineno">   79</span>    test_result = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   80</span>  }</div>
<div class="line"><span class="lineno">   81</span>}</div>
<div class="ttc" id="astructparticle_1_1ParticleTransform_html"><div class="ttname"><a href="structparticle_1_1ParticleTransform.html">particle::ParticleTransform</a></div><div class="ttdoc">A struct that stores transformation parameters and provides method to transform the particle....</div><div class="ttdef"><b>Definition</b> <a href="particleTransform_8h_source.html#l00025">particleTransform.h:25</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="testParticle_8cpp_source.html#l00016">main()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ad46ca3f06841d1eebe364386b4bf889d_icgraph.svg" width="243" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="af81978a4250caac290f7d52c1e571f04" name="af81978a4250caac290f7d52c1e571f04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af81978a4250caac290f7d52c1e571f04">&#9670;&#160;</a></span>testTriElem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testTriElem </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filepath</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform test on quadrature points on triangle elements. </p>
<p>This function performs accuracy test of the quadrature points for integration over reference triangle with vertices at {(0,0), (1,0), (0,1)}. List of tests are as follows:</p>
<ol type="1">
<li>Computes quadrature points of the given order, writes them to the file, and checks if the sum of quadrature weights is equal to 0.5, i.e. area of reference triangle.</li>
</ol>
<p>Also tests the exactness of the integration of the polynomial upto given order. Suppose \( n\) is the order of quadrature point, then we test if the integration of the function \( f(s,t) = s^\alpha\, t^\beta \) is exact for \( \alpha \) and \( \beta \) such that \( \alpha+\beta \leq n \). The exact integration of function \( f\) over reference triangle is  </p><p class="formulaDsp">
\[ I_{exact} = \int_0^1 \int_0^{1-s} s^\alpha\, t^\beta \, dt\, ds =
\sum_{i=0}^{\beta+1} (-1)^i \frac{{{\beta + 1} \choose i}}{(\alpha + i +1)
(\beta + 1)},
\]
</p>
<p> where </p><p class="formulaDsp">
\[ {a \choose b} = \frac{a (a-1) (a-2) ... (a-b+1)}{1*2*3 ... *b}. \]
</p>
<p> We have \( {a \choose 0} = 1 \) so that term for \( i=0\) is not zero. Above formula gives the exact value of integral of \( f(s,t) = s^\alpha\, t^\beta \) over reference triangle. Approximation by quadrature point is as follows </p><p class="formulaDsp">
\[ I_{approx} = \sum_{q=1}^{Q} w_q f(s_q, t_q) \]
</p>
<p> where \(Q\) is the total number of quad points, \( w_q\) and \((s_q, t_q)\) are the \( q^{th} \) quad weight and point. In this test, we compare \( I_{exact} \) and \( I_{approx} \) and report problem if both do not match.</p>
<ol type="1">
<li>Test the accuracy for simple triangular mesh on square domain [0,1]^2. Exact integration of polynomial \( f(x,y) = x^\alpha \, y^\beta \) on \([0,1]^2\) is given by <p class="formulaDsp">
\[ I_{exact} = \frac{1}{(\alpha+1) (\beta+1)}. \]
</p>
 We compare above with the approximation computed from the quadrature points. We consider \(\alpha + \beta \leq n \) where \( n\) is the order of approximation we are testing.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Order of quadrature point approximation </td></tr>
    <tr><td class="paramname">filepath</td><td>Path where mesh data for test can be found (expects files 'triMesh_nodes.csv' and 'triMesh_elements.csv' inside the filepath) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00200">200</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span>                                                   {</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  203</span>  <span class="comment">// Test1: We test accuracy of integrals of polynomials over reference</span></div>
<div class="line"><span class="lineno">  204</span>  <span class="comment">// triangle. Reference triangle {(0,0), (1,0), (0,1)}.</span></div>
<div class="line"><span class="lineno">  205</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  206</span>  <span class="comment">// Test2: We consider simple mesh in meshFeTest.txt over square domain</span></div>
<div class="line"><span class="lineno">  207</span>  <span class="comment">// [0,1]^2 and test the accuracy of polynomials over square domain.</span></div>
<div class="line"><span class="lineno">  208</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  211</span>  <span class="keyword">auto</span> quad = <a class="code hl_class" href="classfe_1_1TriElem.html">fe::TriElem</a>(n);</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  214</span>  <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordtype">size_t</span> error_test_1 = 0;</div>
<div class="line"><span class="lineno">  217</span>  {</div>
<div class="line"><span class="lineno">  218</span>    <span class="comment">// T1 (reference triangle)</span></div>
<div class="line"><span class="lineno">  219</span>    <span class="comment">// get quad points at reference triangle</span></div>
<div class="line"><span class="lineno">  220</span>    std::vector&lt;util::Point&gt; nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.),</div>
<div class="line"><span class="lineno">  221</span>                                       <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.)};</div>
<div class="line"><span class="lineno">  222</span>    std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordtype">double</span> sum = 0.;</div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  225</span>      sum += qd.d_w;</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">if</span> (std::abs(sum - 0.5) &gt; <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">tol</a>) {</div>
<div class="line"><span class="lineno">  228</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Error in order = &quot;</span> &lt;&lt; n</div>
<div class="line"><span class="lineno">  229</span>                &lt;&lt; <span class="stringliteral">&quot;. Sum of quad weights is not &quot;</span></div>
<div class="line"><span class="lineno">  230</span>                   <span class="stringliteral">&quot;equal to area of reference &quot;</span></div>
<div class="line"><span class="lineno">  231</span>                   <span class="stringliteral">&quot;triangle.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  232</span>      error_test_1++;</div>
<div class="line"><span class="lineno">  233</span>    }</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  236</span>    <span class="comment">// test the exactness of integration for polynomial</span></div>
<div class="line"><span class="lineno">  237</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= n; i++)</div>
<div class="line"><span class="lineno">  239</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= n; j++) {</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> (i + j &gt; n)</div>
<div class="line"><span class="lineno">  242</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  245</span>        <span class="comment">// when {(0,0), (1,0), (0,1)}</span></div>
<div class="line"><span class="lineno">  246</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  247</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.),</div>
<div class="line"><span class="lineno">  248</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.)};</div>
<div class="line"><span class="lineno">  249</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  250</span>        <span class="comment">// test integration of polynomial f(s,t) = s^i t^j</span></div>
<div class="line"><span class="lineno">  251</span>        <span class="comment">// get the exact integration</span></div>
<div class="line"><span class="lineno">  252</span>        <span class="keywordtype">double</span> I_exact = <a class="code hl_function" href="namespacetest.html#a437c18b50b59ae2f9cd10e1cb51fba64">test::getExactIntegrationRefTri</a>(i, j);</div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  254</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  257</span>        <span class="comment">// when vertices are {(1,0), (0,1), (0,0)}</span></div>
<div class="line"><span class="lineno">  258</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  259</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.),</div>
<div class="line"><span class="lineno">  260</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>()};</div>
<div class="line"><span class="lineno">  261</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  262</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  263</span>        <span class="comment">// After changing the order of vertices, we have got a new</span></div>
<div class="line"><span class="lineno">  264</span>        <span class="comment">// triangle which is in coordinate system (x,y) and we are</span></div>
<div class="line"><span class="lineno">  265</span>        <span class="comment">// integrating function f(x,y) = x^i y^j</span></div>
<div class="line"><span class="lineno">  266</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  267</span>        <span class="comment">// The quad data we have got is such that quad point is in (x,y)</span></div>
<div class="line"><span class="lineno">  268</span>        <span class="comment">// coordinate, weight is such that determinant of the Jacobian is</span></div>
<div class="line"><span class="lineno">  269</span>        <span class="comment">// included in the weight.</span></div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="comment">// Thus the following method for I_approx is correct.</span></div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  273</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  276</span>        <span class="comment">// when vertices are {(0,1), (0,0), (1,0)}</span></div>
<div class="line"><span class="lineno">  277</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno">  278</span>        nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(),</div>
<div class="line"><span class="lineno">  279</span>                 <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.)};</div>
<div class="line"><span class="lineno">  280</span>        qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">if</span> (!<a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#aa42cb29ac02063d90ab0ecc9acc9cfb0">checkRefIntegration</a>(n, i, j, qds, I_exact))</div>
<div class="line"><span class="lineno">  282</span>          error_test_1++;</div>
<div class="line"><span class="lineno">  283</span>      }</div>
<div class="line"><span class="lineno">  284</span>  } <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  287</span>  <span class="comment">// Test 2</span></div>
<div class="line"><span class="lineno">  288</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  289</span>  <span class="keywordtype">size_t</span> error_test_2 = 0;</div>
<div class="line"><span class="lineno">  290</span>  {</div>
<div class="line"><span class="lineno">  291</span>    <span class="keyword">static</span> std::vector&lt;util::Point&gt; nodes;</div>
<div class="line"><span class="lineno">  292</span>    <span class="keyword">static</span> std::vector&lt;size_t&gt; elements;</div>
<div class="line"><span class="lineno">  293</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num_vertex = 3;</div>
<div class="line"><span class="lineno">  294</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> elem_type = <a class="code hl_variable" href="group__GlobalVars.html#ga1a164a7b8ac23ab4ab769db408eea56f">util::vtk_type_triangle</a>;</div>
<div class="line"><span class="lineno">  295</span>    <span class="keyword">static</span> <span class="keywordtype">size_t</span> num_elems = 0;</div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span> (num_elems == 0) {</div>
<div class="line"><span class="lineno">  297</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a7d6fdb37153e1d548efc6e79d9c61138">readNodes</a>(filepath + <span class="stringliteral">&quot;/triMesh_nodes.csv&quot;</span>, nodes);</div>
<div class="line"><span class="lineno">  298</span>      num_elems = <a class="code hl_function" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a5a1fb22090fa2e6dceff4f43acc7a015">readElements</a>(filepath + <span class="stringliteral">&quot;/triMesh_elements.csv&quot;</span>, elem_type,</div>
<div class="line"><span class="lineno">  299</span>                               elements);</div>
<div class="line"><span class="lineno">  300</span>    }</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <span class="comment">// loop over polynomials</span></div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt;= n; i++)</div>
<div class="line"><span class="lineno">  304</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt;= n; j++) {</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        <span class="keywordflow">if</span> (i + j &gt; n)</div>
<div class="line"><span class="lineno">  307</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordtype">double</span> I_exact = 1. / (double(i + 1) * double(j + 1));</div>
<div class="line"><span class="lineno">  310</span>        <span class="keywordtype">double</span> I_approx = 0.;</div>
<div class="line"><span class="lineno">  311</span>        <span class="comment">// loop over elements and compute I_approx</span></div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; num_elems; e++) {</div>
<div class="line"><span class="lineno">  313</span>          std::vector&lt;util::Point&gt; enodes = {</div>
<div class="line"><span class="lineno">  314</span>              nodes[elements[num_vertex * e + 0]],</div>
<div class="line"><span class="lineno">  315</span>              nodes[elements[num_vertex * e + 1]],</div>
<div class="line"><span class="lineno">  316</span>              nodes[elements[num_vertex * e + 2]]};</div>
<div class="line"><span class="lineno">  317</span>          std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(enodes);</div>
<div class="line"><span class="lineno">  318</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  319</span>            I_approx +=</div>
<div class="line"><span class="lineno">  320</span>                qd.d_w * std::pow(qd.d_p.d_x, i) * std::pow(qd.d_p.d_y, j);</div>
<div class="line"><span class="lineno">  321</span>        }</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> (std::abs(I_exact - I_approx) &gt; <a class="code hl_variable" href="namespaceanonymous__namespace_02testFeLib_8cpp_03.html#a220e1309400af680c76638df4d928e1d">tol</a>) {</div>
<div class="line"><span class="lineno">  324</span>          std::cout &lt;&lt; <span class="stringliteral">&quot;Error in order = &quot;</span> &lt;&lt; n</div>
<div class="line"><span class="lineno">  325</span>                    &lt;&lt; <span class="stringliteral">&quot;. Exact integration = &quot;</span> &lt;&lt; I_exact</div>
<div class="line"><span class="lineno">  326</span>                    &lt;&lt; <span class="stringliteral">&quot; and approximate integration = &quot;</span> &lt;&lt; I_approx</div>
<div class="line"><span class="lineno">  327</span>                    &lt;&lt; <span class="stringliteral">&quot; of polynomial of order (i = &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; + j = &quot;</span> &lt;&lt; j</div>
<div class="line"><span class="lineno">  328</span>                    &lt;&lt; <span class="stringliteral">&quot;) = &quot;</span> &lt;&lt; i + j &lt;&lt; <span class="stringliteral">&quot; over square domain [0,1]x[0,1] &quot;</span></div>
<div class="line"><span class="lineno">  329</span>                    &lt;&lt; <span class="stringliteral">&quot;is not matching using quadrature points.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>          error_test_2++;</div>
<div class="line"><span class="lineno">  332</span>        }</div>
<div class="line"><span class="lineno">  333</span>      }</div>
<div class="line"><span class="lineno">  334</span>  }</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>  <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno">  337</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  338</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Triangle Quadrature Test\n&quot;</span>;</div>
<div class="line"><span class="lineno">  339</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  340</span>  }</div>
<div class="line"><span class="lineno">  341</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Quad order = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;. &quot;</span>;</div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordflow">if</span> (error_test_1 == 0)</div>
<div class="line"><span class="lineno">  343</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;TEST 1 : PASS. &quot;</span>;</div>
<div class="line"><span class="lineno">  344</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  345</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;TEST 1 : FAIL. &quot;</span>;</div>
<div class="line"><span class="lineno">  346</span>  <span class="keywordflow">if</span> (error_test_2 == 0)</div>
<div class="line"><span class="lineno">  347</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;TEST 2 : PASS. &quot;</span>;</div>
<div class="line"><span class="lineno">  348</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  349</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;TEST 2 : FAIL. &quot;</span>;</div>
<div class="line"><span class="lineno">  350</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  351</span>}</div>
<div class="ttc" id="aclassfe_1_1TriElem_html"><div class="ttname"><a href="classfe_1_1TriElem.html">fe::TriElem</a></div><div class="ttdoc">A class for mapping and quadrature related operations for linear triangle element.</div><div class="ttdef"><b>Definition</b> <a href="triElem_8h_source.html#l00091">triElem.h:91</a></div></div>
<div class="ttc" id="agroup__GlobalVars_html_ga1a164a7b8ac23ab4ab769db408eea56f"><div class="ttname"><a href="group__GlobalVars.html#ga1a164a7b8ac23ab4ab769db408eea56f">util::vtk_type_triangle</a></div><div class="ttdeci">static const int vtk_type_triangle</div><div class="ttdoc">Integer flag for triangle element.</div><div class="ttdef"><b>Definition</b> <a href="feElementDefs_8h_source.html#l00055">feElementDefs.h:55</a></div></div>
<div class="ttc" id="anamespacetest_html_a437c18b50b59ae2f9cd10e1cb51fba64"><div class="ttname"><a href="namespacetest.html#a437c18b50b59ae2f9cd10e1cb51fba64">test::getExactIntegrationRefTri</a></div><div class="ttdeci">double getExactIntegrationRefTri(size_t alpha, size_t beta)</div><div class="ttdoc">Computes integration of polynomial exactly over reference triangle.</div><div class="ttdef"><b>Definition</b> <a href="testFeLib_8cpp_source.html#l00147">testFeLib.cpp:147</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="testFeLib_8cpp_source.html#l00078">anonymous_namespace{testFeLib.cpp}::checkRefIntegration()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00147">getExactIntegrationRefTri()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00039">anonymous_namespace{testFeLib.cpp}::readElements()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00029">anonymous_namespace{testFeLib.cpp}::readNodes()</a>, <a class="el" href="testFeLib_8cpp_source.html#l00027">anonymous_namespace{testFeLib.cpp}::tol</a>, and <a class="el" href="feElementDefs_8h_source.html#l00055">util::vtk_type_triangle</a>.</p>

<p class="reference">Referenced by <a class="el" href="testFe_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_af81978a4250caac290f7d52c1e571f04_cgraph.svg" width="562" height="259"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_af81978a4250caac290f7d52c1e571f04_icgraph.svg" width="228" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a239356235900cd3a9790293c6d49b357" name="a239356235900cd3a9790293c6d49b357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a239356235900cd3a9790293c6d49b357">&#9670;&#160;</a></span>testTriElemTime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testTriElemTime </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the time needed when quad data for elements are stored and when they are computed as and when needed. </p>
<p>This function allocates dummy elements and test how much time it is required to do computation when the quad data are stored for each element and when the quad data are computed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Order of quadrature point approximation </td></tr>
    <tr><td class="paramname">N</td><td>Number of elements on which this test is performed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="testFeLib_8cpp_source.html#l00504">504</a> of file <a class="el" href="testFeLib_8cpp_source.html">testFeLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  504</span>                                             {</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>  <span class="comment">// get Quadrature</span></div>
<div class="line"><span class="lineno">  507</span>  <span class="keyword">auto</span> quad = <a class="code hl_class" href="classfe_1_1TriElem.html">fe::TriElem</a>(n);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  510</span>  <span class="comment">// Test 1</span></div>
<div class="line"><span class="lineno">  511</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  512</span>  std::vector&lt;util::Point&gt; nodes = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(2., 2., 0.),</div>
<div class="line"><span class="lineno">  513</span>                                     <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(4., 2., 0.),</div>
<div class="line"><span class="lineno">  514</span>                                     <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(2., 4., 0.)};</div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordtype">size_t</span> num_vertex = 3;</div>
<div class="line"><span class="lineno">  516</span>  <span class="comment">//  std::vector&lt;size_t&gt; elements;</span></div>
<div class="line"><span class="lineno">  517</span>  <span class="comment">//  for (size_t i = 0; i &lt; 3 * N; i++)</span></div>
<div class="line"><span class="lineno">  518</span>  <span class="comment">//    elements.emplace_back(i % 2);</span></div>
<div class="line"><span class="lineno">  519</span>  std::vector&lt;std::vector&lt;size_t&gt;&gt; elements;</div>
<div class="line"><span class="lineno">  520</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; i++)</div>
<div class="line"><span class="lineno">  521</span>    elements.emplace_back(std::vector&lt;size_t&gt;{0, 1, 2});</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>  <span class="keyword">auto</span> t11 = steady_clock::now();</div>
<div class="line"><span class="lineno">  524</span>  <span class="comment">// method 1: Compute quad points on the fly</span></div>
<div class="line"><span class="lineno">  525</span>  <span class="comment">// loop over elements and compute I_approx</span></div>
<div class="line"><span class="lineno">  526</span>  <span class="keywordtype">double</span> sum = 0.;</div>
<div class="line"><span class="lineno">  527</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; N; e++) {</div>
<div class="line"><span class="lineno">  528</span>    <span class="comment">//    std::vector&lt;util::Point&gt; enodes = {nodes[elements[num_vertex * e +</span></div>
<div class="line"><span class="lineno">  529</span>    <span class="comment">//    0]],</span></div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">//                                        nodes[elements[num_vertex * e +</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment">//                                        1]], nodes[elements[num_vertex * e</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="comment">//                                        + 2]]};</span></div>
<div class="line"><span class="lineno">  533</span>    std::vector&lt;util::Point&gt; enodes = {</div>
<div class="line"><span class="lineno">  534</span>        nodes[elements[e][0]], nodes[elements[e][1]], nodes[elements[e][2]]};</div>
<div class="line"><span class="lineno">  535</span>    std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(enodes);</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  537</span>      sum += qd.d_w * (qd.d_shapes[0] + qd.d_shapes[1] + qd.d_shapes[2]);</div>
<div class="line"><span class="lineno">  538</span>  }</div>
<div class="line"><span class="lineno">  539</span>  <span class="keyword">auto</span> t12 = steady_clock::now();</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>  <span class="comment">// method 2: Compute quad points in the beginning and use it when needed</span></div>
<div class="line"><span class="lineno">  542</span>  <span class="keywordtype">size_t</span> num_quad_pts = 0;</div>
<div class="line"><span class="lineno">  543</span>  std::vector&lt;fe::QuadData&gt; quad_data;</div>
<div class="line"><span class="lineno">  544</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; N; e++) {</div>
<div class="line"><span class="lineno">  545</span>    std::vector&lt;fe::QuadData&gt; qds = quad.getQuadPoints(nodes);</div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">if</span> (e == 0)</div>
<div class="line"><span class="lineno">  547</span>      num_quad_pts = qds.size();</div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> qd : qds)</div>
<div class="line"><span class="lineno">  549</span>      quad_data.emplace_back(qd);</div>
<div class="line"><span class="lineno">  550</span>  }</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>  <span class="keyword">auto</span> t21 = steady_clock::now();</div>
<div class="line"><span class="lineno">  553</span>  sum = 0.;</div>
<div class="line"><span class="lineno">  554</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> e = 0; e &lt; N; e++) {</div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> q = 0; q &lt; num_quad_pts; q++) {</div>
<div class="line"><span class="lineno">  556</span>      <a class="code hl_struct" href="structfe_1_1QuadData.html">fe::QuadData</a> qd = quad_data[e * num_quad_pts + q];</div>
<div class="line"><span class="lineno">  557</span>      sum += qd.<a class="code hl_variable" href="structfe_1_1QuadData.html#a55af605a55d8cdb9ded351dc70ba9435">d_w</a> * (qd.<a class="code hl_variable" href="structfe_1_1QuadData.html#a03f0a01b0fb8423dfa1fa09474ff8911">d_shapes</a>[0] + qd.<a class="code hl_variable" href="structfe_1_1QuadData.html#a03f0a01b0fb8423dfa1fa09474ff8911">d_shapes</a>[1] + qd.<a class="code hl_variable" href="structfe_1_1QuadData.html#a03f0a01b0fb8423dfa1fa09474ff8911">d_shapes</a>[2]);</div>
<div class="line"><span class="lineno">  558</span>    }</div>
<div class="line"><span class="lineno">  559</span>  }</div>
<div class="line"><span class="lineno">  560</span>  <span class="keyword">auto</span> t22 = steady_clock::now();</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>  <span class="keywordflow">if</span> (n == 1 and N == 1000) {</div>
<div class="line"><span class="lineno">  563</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  564</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Quadrature Time Efficiency Test\n&quot;</span>;</div>
<div class="line"><span class="lineno">  565</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;**********************************\n&quot;</span>;</div>
<div class="line"><span class="lineno">  566</span>  }</div>
<div class="line"><span class="lineno">  567</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Quad order = &quot;</span> &lt;&lt; n &lt;&lt; <span class="stringliteral">&quot;. Num Elements =  &quot;</span> &lt;&lt; N &lt;&lt; <span class="stringliteral">&quot;.\n &quot;</span>;</div>
<div class="line"><span class="lineno">  568</span>  <span class="keywordtype">double</span> dt_1 = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t12, t11, <span class="stringliteral">&quot;seconds&quot;</span>);</div>
<div class="line"><span class="lineno">  569</span>  <span class="keywordtype">double</span> dt_2 = <a class="code hl_function" href="namespaceutil_1_1methods.html#aaf9cfac99073d034d41e10d4d17e59a2">util::methods::timeDiff</a>(t21, t22, <span class="stringliteral">&quot;seconds&quot;</span>);</div>
<div class="line"><span class="lineno">  570</span>  <span class="keywordtype">double</span> perc = (dt_1 - dt_2) * 100. / dt_2;</div>
<div class="line"><span class="lineno">  571</span>  <span class="keywordtype">double</span> qpt_mem = 13 * <span class="keyword">sizeof</span>(double);</div>
<div class="line"><span class="lineno">  572</span>  <span class="keywordtype">double</span> mem2 = double(quad_data.capacity() * qpt_mem) / double(1000000);</div>
<div class="line"><span class="lineno">  573</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  dt1 = &quot;</span> &lt;&lt; dt_1 &lt;&lt; <span class="stringliteral">&quot;, dt2 = &quot;</span> &lt;&lt; dt_2 &lt;&lt; <span class="stringliteral">&quot;, perc = &quot;</span> &lt;&lt; perc</div>
<div class="line"><span class="lineno">  574</span>            &lt;&lt; <span class="stringliteral">&quot;. Mem saved = &quot;</span> &lt;&lt; mem2 &lt;&lt; <span class="stringliteral">&quot; MB.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  575</span>}</div>
<div class="ttc" id="astructfe_1_1QuadData_html"><div class="ttname"><a href="structfe_1_1QuadData.html">fe::QuadData</a></div><div class="ttdoc">A struct to store the quadrature data. List of data are.</div><div class="ttdef"><b>Definition</b> <a href="quadData_8h_source.html#l00023">quadData.h:23</a></div></div>
<div class="ttc" id="astructfe_1_1QuadData_html_a03f0a01b0fb8423dfa1fa09474ff8911"><div class="ttname"><a href="structfe_1_1QuadData.html#a03f0a01b0fb8423dfa1fa09474ff8911">fe::QuadData::d_shapes</a></div><div class="ttdeci">std::vector&lt; double &gt; d_shapes</div><div class="ttdoc">Value of shape functions at quad point p.</div><div class="ttdef"><b>Definition</b> <a href="quadData_8h_source.html#l00037">quadData.h:37</a></div></div>
<div class="ttc" id="astructfe_1_1QuadData_html_a55af605a55d8cdb9ded351dc70ba9435"><div class="ttname"><a href="structfe_1_1QuadData.html#a55af605a55d8cdb9ded351dc70ba9435">fe::QuadData::d_w</a></div><div class="ttdeci">double d_w</div><div class="ttdoc">Quadrature weight.</div><div class="ttdef"><b>Definition</b> <a href="quadData_8h_source.html#l00026">quadData.h:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="quadData_8h_source.html#l00037">fe::QuadData::d_shapes</a>, <a class="el" href="quadData_8h_source.html#l00026">fe::QuadData::d_w</a>, and <a class="el" href="methods_8h_source.html#l00304">util::methods::timeDiff()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testFe_8cpp_source.html#l00018">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a239356235900cd3a9790293c6d49b357_cgraph.svg" width="358" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_a239356235900cd3a9790293c6d49b357_icgraph.svg" width="258" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad3c8cad23ca76bc12534c5487df9a25f" name="ad3c8cad23ca76bc12534c5487df9a25f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c8cad23ca76bc12534c5487df9a25f">&#9670;&#160;</a></span>testUtilMethods()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test::testUtilMethods </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Test methods <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="testUtilLib_8cpp_source.html#l00026">26</a> of file <a class="el" href="testUtilLib_8cpp_source.html">testUtilLib.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>                           {</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> tol = 1.e-10;</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   31</span>  {</div>
<div class="line"><span class="lineno">   32</span>    std::pair&lt;util::Point, util::Point&gt; box = {<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(),</div>
<div class="line"><span class="lineno">   33</span>                                               <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 1.)};</div>
<div class="line"><span class="lineno">   34</span>    <span class="keyword">auto</span> corner_pts = <a class="code hl_function" href="namespaceutil.html#a5a54fd6f6720dd75956e3ce06b814ad6">util::getCornerPoints</a>(3, box);</div>
<div class="line"><span class="lineno">   35</span>    <span class="keyword">auto</span> edges = <a class="code hl_function" href="namespaceutil.html#a46e3d78e899424dbb8144526b92fecf5">util::getEdges</a>(3, box);</div>
<div class="line"><span class="lineno">   36</span>    <span class="keyword">auto</span> xc = <a class="code hl_function" href="namespaceutil.html#a9a73e26a05894da76d4d0a922272b7cc">util::getCenter</a>(3, box);</div>
<div class="line"><span class="lineno">   37</span> </div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;2; i++)</div>
<div class="line"><span class="lineno">   39</span>      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j&lt;2; j++)</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k=0; k&lt;2; k++) {</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>          <span class="keyword">auto</span> p = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(<span class="keywordtype">double</span>(i), <span class="keywordtype">double</span>(j), <span class="keywordtype">double</span>(k));</div>
<div class="line"><span class="lineno">   43</span>          <span class="keywordtype">bool</span> found_p = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   44</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : corner_pts) {</div>
<div class="line"><span class="lineno">   45</span>            <span class="keywordflow">if</span> (q.dist(p) &lt; tol)</div>
<div class="line"><span class="lineno">   46</span>              found_p = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   47</span>          }</div>
<div class="line"><span class="lineno">   48</span>          <span class="keywordflow">if</span> (!found_p)</div>
<div class="line"><span class="lineno">   49</span>            <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(fmt::format(<span class="stringliteral">&quot;Error: Can not find corner point {}\n&quot;</span>, p.printStr()));</div>
<div class="line"><span class="lineno">   50</span>        }</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> (xc.dist(<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0.5, 0.5, 0.5)) &gt; tol)</div>
<div class="line"><span class="lineno">   53</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: getCenter()\n&quot;</span>);</div>
<div class="line"><span class="lineno">   54</span>  }</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   57</span>  {</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">if</span> (std::abs(<a class="code hl_function" href="namespaceutil.html#adaeb9a04adeab62ad0a5ae609d12750c">util::triangleArea</a>(<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(2., 0., 0.), <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.)) - 1.) &gt; tol)</div>
<div class="line"><span class="lineno">   59</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: triangleArea()\n&quot;</span>);</div>
<div class="line"><span class="lineno">   60</span>  }</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   63</span>  {</div>
<div class="line"><span class="lineno">   64</span>    std::vector&lt;double&gt; x = {1., 0., 0.};</div>
<div class="line"><span class="lineno">   65</span>    std::vector&lt;double&gt; y_check = {1./std::sqrt(2.), -1./std::sqrt(2.), 0.};</div>
<div class="line"><span class="lineno">   66</span>    <span class="keyword">auto</span> y = <a class="code hl_function" href="namespaceutil.html#ac37c77bce2370e83008c6436dcec26c0">util::rotateCW2D</a>(x, M_PI * 0.25);</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceutil.html#a025d239d0891842e9f9f3f25fa11e528">util::l2Dist</a>(y_check, y) &gt; tol)</div>
<div class="line"><span class="lineno">   68</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: rotateCW2D()\n&quot;</span>);</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keywordflow">if</span> (<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(y_check).dist(<a class="code hl_function" href="namespaceutil.html#ac37c77bce2370e83008c6436dcec26c0">util::rotateCW2D</a>(<a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(x), M_PI * 0.25)) &gt; tol)</div>
<div class="line"><span class="lineno">   71</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: rotateCW2D()\n&quot;</span>);</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    y_check = {1./std::sqrt(2.), 1./std::sqrt(2.), 0.};</div>
<div class="line"><span class="lineno">   74</span>    y = <a class="code hl_function" href="namespaceutil.html#ab949e9f056cf2566e19c8214a6282c64">util::rotateACW2D</a>(x, M_PI * 0.25);</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceutil.html#a025d239d0891842e9f9f3f25fa11e528">util::l2Dist</a>(y_check, y) &gt; tol)</div>
<div class="line"><span class="lineno">   76</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: rotateACW2D()\n&quot;</span>);</div>
<div class="line"><span class="lineno">   77</span>  }</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   80</span>  {</div>
<div class="line"><span class="lineno">   81</span>    <span class="keyword">auto</span> x = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.);</div>
<div class="line"><span class="lineno">   82</span>    <span class="keyword">auto</span> a = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.);</div>
<div class="line"><span class="lineno">   83</span>    <span class="keyword">auto</span> y_check = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 0.);</div>
<div class="line"><span class="lineno">   84</span>    <span class="keyword">auto</span> y = <a class="code hl_function" href="namespaceutil.html#afc570d133c5159571a48456e2440753a">util::rotate</a>(x, M_PI * 0.5, a);</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (y_check.dist(y) &gt; tol)</div>
<div class="line"><span class="lineno">   86</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(fmt::format(<span class="stringliteral">&quot;Error: rotate(). y_check = {}, y = {}\n&quot;</span>, y_check.printStr(), y.printStr()));</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    x = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 1.);</div>
<div class="line"><span class="lineno">   89</span>    y_check = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(-1., 1., 1.);</div>
<div class="line"><span class="lineno">   90</span>    y = <a class="code hl_function" href="namespaceutil.html#afc570d133c5159571a48456e2440753a">util::rotate</a>(x, M_PI * 0.5, a);</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">if</span> (y_check.dist(y) &gt; tol)</div>
<div class="line"><span class="lineno">   92</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(fmt::format(<span class="stringliteral">&quot;Error: rotate(). y_check = {}, y = {}\n&quot;</span>, y_check.printStr(), y.printStr()));</div>
<div class="line"><span class="lineno">   93</span>  }</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   96</span>  {</div>
<div class="line"><span class="lineno">   97</span>    <span class="keyword">auto</span> x1 = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 1., 0.);</div>
<div class="line"><span class="lineno">   98</span>    <span class="keyword">auto</span> x2 = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(1., 0., 0.);</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> (std::abs(M_PI*0.25 - <a class="code hl_function" href="namespaceutil.html#a4989349bbfea16310a439c896e8222bf">util::angle</a>(x1, x2)) &gt; tol)</div>
<div class="line"><span class="lineno">  100</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: angle()\n&quot;</span>);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>    x2 = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 0., 1.);</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">if</span> (std::abs(M_PI*0.5 - <a class="code hl_function" href="namespaceutil.html#a4989349bbfea16310a439c896e8222bf">util::angle</a>(x1, x2)) &gt; tol)</div>
<div class="line"><span class="lineno">  104</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: angle()\n&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    x2 = <a class="code hl_struct" href="structutil_1_1Point.html">util::Point</a>(0., 1., 1.);</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> (std::abs(M_PI/3. - <a class="code hl_function" href="namespaceutil.html#a4989349bbfea16310a439c896e8222bf">util::angle</a>(x1, x2)) &gt; tol)</div>
<div class="line"><span class="lineno">  108</span>      <a class="code hl_function" href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">errExit</a>(<span class="stringliteral">&quot;Error: angle()\n&quot;</span>);</div>
<div class="line"><span class="lineno">  109</span>  }</div>
<div class="line"><span class="lineno">  110</span>}</div>
<div class="ttc" id="anamespaceanonymous__namespace_02testUtilLib_8cpp_03_html_a4ad943bfa8dfdf2a8981b62076d5efc8"><div class="ttname"><a href="namespaceanonymous__namespace_02testUtilLib_8cpp_03.html#a4ad943bfa8dfdf2a8981b62076d5efc8">anonymous_namespace{testUtilLib.cpp}::errExit</a></div><div class="ttdeci">void errExit(std::string msg)</div><div class="ttdef"><b>Definition</b> <a href="testUtilLib_8cpp_source.html#l00020">testUtilLib.cpp:20</a></div></div>
<div class="ttc" id="anamespaceutil_html_a025d239d0891842e9f9f3f25fa11e528"><div class="ttname"><a href="namespaceutil.html#a025d239d0891842e9f9f3f25fa11e528">util::l2Dist</a></div><div class="ttdeci">T l2Dist(const std::vector&lt; T &gt; &amp;x1, const std::vector&lt; T &gt; &amp;x2)</div><div class="ttdoc">Computes l2 distance between two vectors.</div><div class="ttdef"><b>Definition</b> <a href="geom_8h_source.html#l00357">geom.h:357</a></div></div>
<div class="ttc" id="anamespaceutil_html_a46e3d78e899424dbb8144526b92fecf5"><div class="ttname"><a href="namespaceutil.html#a46e3d78e899424dbb8144526b92fecf5">util::getEdges</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; util::Point, util::Point &gt; &gt; getEdges(size_t dim, const std::pair&lt; util::Point, util::Point &gt; &amp;box)</div><div class="ttdoc">Returns all corner points in the box.</div><div class="ttdef"><b>Definition</b> <a href="geom_8cpp_source.html#l00043">geom.cpp:43</a></div></div>
<div class="ttc" id="anamespaceutil_html_a4989349bbfea16310a439c896e8222bf"><div class="ttname"><a href="namespaceutil.html#a4989349bbfea16310a439c896e8222bf">util::angle</a></div><div class="ttdeci">double angle(util::Point a, util::Point b)</div><div class="ttdoc">Computes angle between two vectors.</div><div class="ttdef"><b>Definition</b> <a href="transformation_8cpp_source.html#l00081">transformation.cpp:81</a></div></div>
<div class="ttc" id="anamespaceutil_html_a5a54fd6f6720dd75956e3ce06b814ad6"><div class="ttname"><a href="namespaceutil.html#a5a54fd6f6720dd75956e3ce06b814ad6">util::getCornerPoints</a></div><div class="ttdeci">std::vector&lt; util::Point &gt; getCornerPoints(size_t dim, const std::pair&lt; util::Point, util::Point &gt; &amp;box)</div><div class="ttdoc">Returns all corner points in the box.</div><div class="ttdef"><b>Definition</b> <a href="geom_8cpp_source.html#l00014">geom.cpp:14</a></div></div>
<div class="ttc" id="anamespaceutil_html_a9a73e26a05894da76d4d0a922272b7cc"><div class="ttname"><a href="namespaceutil.html#a9a73e26a05894da76d4d0a922272b7cc">util::getCenter</a></div><div class="ttdeci">util::Point getCenter(size_t dim, const std::pair&lt; util::Point, util::Point &gt; &amp;box)</div><div class="ttdoc">Returns center point.</div><div class="ttdef"><b>Definition</b> <a href="geom_8cpp_source.html#l00091">geom.cpp:91</a></div></div>
<div class="ttc" id="anamespaceutil_html_ab949e9f056cf2566e19c8214a6282c64"><div class="ttname"><a href="namespaceutil.html#ab949e9f056cf2566e19c8214a6282c64">util::rotateACW2D</a></div><div class="ttdeci">std::vector&lt; double &gt; rotateACW2D(const std::vector&lt; double &gt; &amp;x, const double &amp;theta)</div><div class="ttdoc">Rotates a vector in xy-plane in anti-clockwise direction.</div><div class="ttdef"><b>Definition</b> <a href="transformation_8cpp_source.html#l00031">transformation.cpp:31</a></div></div>
<div class="ttc" id="anamespaceutil_html_ac37c77bce2370e83008c6436dcec26c0"><div class="ttname"><a href="namespaceutil.html#ac37c77bce2370e83008c6436dcec26c0">util::rotateCW2D</a></div><div class="ttdeci">std::vector&lt; double &gt; rotateCW2D(const std::vector&lt; double &gt; &amp;x, const double &amp;theta)</div><div class="ttdoc">Rotates a vector in xy-plane in clockwise direction.</div><div class="ttdef"><b>Definition</b> <a href="transformation_8cpp_source.html#l00015">transformation.cpp:15</a></div></div>
<div class="ttc" id="anamespaceutil_html_adaeb9a04adeab62ad0a5ae609d12750c"><div class="ttname"><a href="namespaceutil.html#adaeb9a04adeab62ad0a5ae609d12750c">util::triangleArea</a></div><div class="ttdeci">double triangleArea(const util::Point &amp;x1, const util::Point &amp;x2, const util::Point &amp;x3)</div><div class="ttdoc">Compute area of triangle.</div><div class="ttdef"><b>Definition</b> <a href="geom_8cpp_source.html#l00642">geom.cpp:642</a></div></div>
<div class="ttc" id="anamespaceutil_html_afc570d133c5159571a48456e2440753a"><div class="ttname"><a href="namespaceutil.html#afc570d133c5159571a48456e2440753a">util::rotate</a></div><div class="ttdeci">util::Point rotate(const util::Point &amp;p, const double &amp;theta, const util::Point &amp;axis)</div><div class="ttdoc">Returns the vector after rotating by desired angle.</div><div class="ttdef"><b>Definition</b> <a href="transformation_8cpp_source.html#l00067">transformation.cpp:67</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="transformation_8cpp_source.html#l00081">util::angle()</a>, <a class="el" href="testUtilLib_8cpp_source.html#l00020">anonymous_namespace{testUtilLib.cpp}::errExit()</a>, <a class="el" href="geom_8cpp_source.html#l00091">util::getCenter()</a>, <a class="el" href="geom_8cpp_source.html#l00014">util::getCornerPoints()</a>, <a class="el" href="geom_8cpp_source.html#l00043">util::getEdges()</a>, <a class="el" href="geom_8h_source.html#l00357">util::l2Dist()</a>, <a class="el" href="transformation_8cpp_source.html#l00067">util::rotate()</a>, <a class="el" href="transformation_8cpp_source.html#l00031">util::rotateACW2D()</a>, <a class="el" href="transformation_8cpp_source.html#l00015">util::rotateCW2D()</a>, and <a class="el" href="geom_8cpp_source.html#l00642">util::triangleArea()</a>.</p>

<p class="reference">Referenced by <a class="el" href="testUtil_8cpp_source.html#l00017">main()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ad3c8cad23ca76bc12534c5487df9a25f_cgraph.svg" width="555" height="515"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="namespacetest_ad3c8cad23ca76bc12534c5487df9a25f_icgraph.svg" width="254" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacetest.html">test</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
